[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Modelling",
    "section": "",
    "text": "Preface",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "sir-det.html",
    "href": "sir-det.html",
    "title": "1  SIR",
    "section": "",
    "text": "1.1 Assumptions",
    "crumbs": [
      "Deterministic models",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>SIR</span>"
    ]
  },
  {
    "objectID": "sir-det.html#assumptions",
    "href": "sir-det.html#assumptions",
    "title": "1  SIR",
    "section": "",
    "text": "Well-mixed population (a single contact rate \\(\\beta\\)).\nThe most basic form balances demographic processes (births B and deaths \\(\\mu\\)).\nInfectious disease properties is for a single pathogen.",
    "crumbs": [
      "Deterministic models",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>SIR</span>"
    ]
  },
  {
    "objectID": "sir-det.html#structure",
    "href": "sir-det.html#structure",
    "title": "1  SIR",
    "section": "1.2 Structure",
    "text": "1.2 Structure\nForce of infection \\(\\lambda = \\frac{\\beta I}{N}\\)\n\\[\\frac{dS}{dt} = B - \\lambda S - \\mu S\\]\n\\[\\frac{dI}{dt} = \\lambda S - \\gamma I - \\mu I\\]\n\\[\\frac{dR}{dt} = \\gamma I - \\mu R\\]\n\n# sir_1() returns a data frame consists S, I, R, In values by time\nsir_1 &lt;- function(beta, gamma, S0, I0, R0, times) {\n  \n  sir_equations &lt;- function(time, variables, parameters) {\n    with(as.list(c(variables, parameters)), {\n      dS &lt;- -beta * I * S\n      # In to store the number of new cases, we fit the data with In not I\n      # I is the number of people remaining infectious, the number we get from public health surveillance is new cases (In)\n      dIn &lt;- beta * I * S\n      dI &lt;-  dIn - gamma * I\n      dR &lt;-  gamma * I\n      return(list(c(dS, dI, dR, dIn)))\n    })\n  }\n  \n  parameters_values &lt;- c(beta = beta, gamma = gamma)\n  initial_values &lt;- c(S = S0, I = I0, R = R0, In = 0)\n  \n  out &lt;- ode(initial_values, times, sir_equations, parameters_values)\n\n  as.data.frame(out)\n}",
    "crumbs": [
      "Deterministic models",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>SIR</span>"
    ]
  },
  {
    "objectID": "sir-det.html#poisson-distribution",
    "href": "sir-det.html#poisson-distribution",
    "title": "1  SIR",
    "section": "1.3 Poisson distribution",
    "text": "1.3 Poisson distribution\nPoisson distribution is a discrete probability distribution that expresses probability of a given number of events occurring in a fixed interval of time1.\nSuitable to use because here we are fitting a number of cases occurring in this period.\n\n\n\n\n\n\nWhy use log-likelihood?\n\n\n\nThe likelihood is the probability of observing data \\(x\\) given that our model is true2, \\(\\mathbb{P}(x|M)\\).\nWe have a lot of data points, and they are independent. The probability of observing all these data points at the same time is the production of these likelihood \\(\\mathbb{P}(x_1|M) \\times \\mathbb{P}(x_2|M) \\times \\mathbb{P}(x_3|M)... = \\prod\\mathbb{P}(x|M)\\).\nMultiplying things together, you will end up losing precision if the numbers are too low. Here you are dealing with probability (a value &lt; 1), multiplying 100 probabilities you will end up with 1e-100.\nBut remember that \\(log(a \\times b) = log(a) + log(b)\\), and very convenient that \\(log(1^{-100} = -230.2585)\\).\nSo \\(log(\\mathbb{P}(x_1|M) \\times \\mathbb{P}(x_2|M) \\times \\mathbb{P}(x_3|M)...)\\) \\(=\\) \\(log(\\mathbb{P}(x_1|M)) + log(\\mathbb{P}(x_2|M)) + log(\\mathbb{P}(x_3|M))...\\) and it is so much easier to handle.\n\n\n\n\n\n\n\n\nWhy use negative log-likelihood?\n\n\n\nBecause statistical packages optimizers work by minimizing a function. Minimizing means decrease the distance of two distributions to its lowest, this is fairly easy because we get this when the distance close to 0 (just like the trick we do in hypothesis testing).\nMinimizing negative log-likelihood (meaning that \\(-1 \\times \\text{log-likelihood}\\)) is equivalent to maximizing the log-likelihood, which is what we want to do (MLE: maximum likelihood estimation).",
    "crumbs": [
      "Deterministic models",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>SIR</span>"
    ]
  },
  {
    "objectID": "sir-det.html#footnotes",
    "href": "sir-det.html#footnotes",
    "title": "1  SIR",
    "section": "",
    "text": "Wikipedia https://en.wikipedia.org/wiki/Poisson_distribution↩︎\nhttps://en.wikipedia.org/wiki/Bayesian_inference↩︎",
    "crumbs": [
      "Deterministic models",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>SIR</span>"
    ]
  },
  {
    "objectID": "tsir.html",
    "href": "tsir.html",
    "title": "2  tsiR",
    "section": "",
    "text": "2.1 Assumptions\nThe TSIR model relies on two main assumptions1:",
    "crumbs": [
      "Deterministic models",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>tsiR</span>"
    ]
  },
  {
    "objectID": "tsir.html#methods",
    "href": "tsir.html#methods",
    "title": "2  tsiR",
    "section": "2.2 Methods",
    "text": "2.2 Methods\n\\[\\mathbb{E}(I_{t + 1}) = \\beta_{t + 1} S_t I_t^{\\alpha}\\]\n\n\n\n\n\n\nExplain\n\n\n\n\n\nThis equation describes the transmission through the multiplicative interaction between susceptible and infected individuals2.\n\\[I_{t + 1} = \\beta_{t + 1} S_t^{\\alpha_1} I_t^{\\alpha_2} \\epsilon_t\\]\n\nSusceptible (\\(S_t\\)) meet infectious individuals (\\(I_t\\)) with contact rate \\(\\beta_{t + 1}\\).\n\\(\\alpha_1\\) and \\(\\alpha_2\\) are mixing parameters of the contact process, such that \\(\\alpha_1 = \\alpha_2 = 1\\) is the homogeneous mixing.\n\\(\\epsilon_t\\) is the noise, \\(\\mathbb{E}\\{ log(\\epsilon_t) \\} = 0\\) and \\(\\mathbb{V}\\{ log(\\epsilon_t) \\} = 0\\).\n\n\n\n\n\\[S_{t + 1} = B_{t + 1} + S_t - I_{t + 1}\\]\n\n\n\n\n\n\nExplain\n\n\n\n\n\nSusceptible class in the next time step recruited by births (\\(B_{t + 1}\\)) and depleted by the infected individuals leaving the class (\\(I_{t + 1}\\))2.",
    "crumbs": [
      "Deterministic models",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>tsiR</span>"
    ]
  },
  {
    "objectID": "tsir.html#tsir-framework",
    "href": "tsir.html#tsir-framework",
    "title": "2  tsiR",
    "section": "2.3 tsiR framework",
    "text": "2.3 tsiR framework\n\n2.3.1 Reconstruct susceptible dynamics\nFit a regression between cumulative cases and cumulative births. The slope is assumed to be the report rate \\(\\rho_t\\) (rho)3, the residuals is assumed to be the shape of the susceptible dynamics (\\(Z_t\\)).\n\n\n\n\n\n\nExplain\n\n\n\n\n\nLet \\(\\rho_t\\) be the reporting rate and assume \\(\\rho_t\\) has a probability function with expected value \\(\\mathbb{E}(\\rho_t) = \\rho\\).\n\\[I_t = \\rho_t C_t\\]\n\n\\(I_t\\): the number of true cases.\n\\(C_t\\): the number of reported cases.\n\nThe number of true cases is under-reported if \\(\\rho_t &gt; 1\\) and is fully reported if \\(\\rho_t = 1\\).\nReplace \\(I_t\\) here:\n\\[S_t = B_t + S_{t - 1} - I_t\\]\n\\[S_t = B_t + S_{t - 1} - \\rho_t C_t\\]\nLet \\(\\mathbb{E}(S_t) = \\bar{S}\\) so that \\(S_t = \\bar{S} + Z_t\\), with \\(\\mathbb{E}(Z_t) = 0\\). The deviations \\(Z_t\\) from their mean follow the same recursive relationship as \\(S_t\\).\n\\[Z_t = B_t + Z_{t - 1} - \\rho_t C_t\\]\nA successive iteration to compute \\(Z_t\\) from \\(Z_0\\) gives:\n\\[Z_t = \\sum_{i = 1}^{t} B_i + Z_0 - \\sum_{i = 1}^{t} \\rho_i C_i\\]\n\n\\(\\sum_{i = 1}^{t} B_i\\): cumulative births.\n\\(\\sum_{i = 1}^{t} C_i\\): cumulative reported cases.\n\nFor ease of notation, let \\(Y_\\text{cumBirths} = \\sum_{i = 1}^{t} B_i\\), \\(X_\\text{cumCases} = \\sum_{i = 1}^{t} C_i\\), rearrange that equation so that we have:\n\\[Y_\\text{cumBirths} = \\rho X_\\text{cumCases} + Z_t - Z_0\\]\nIf we assume a constant reporting rate, this equation is a simple linear regression relationship between cumulative births \\(Y\\) and cumulative cases \\(X\\).\n\n\n\n\n\n2.3.2 Estimate parameters\nSet the expectation to the mean, then take log of both sides:\n\\[\\mathbb{E}(I_{t + 1}) = \\beta_{t + 1} S_t I_t^{\\alpha}\\]\n\\[log I_{t + 1} = log \\beta_{t + 1} + log(Z_t + \\bar{S}) + \\alpha log I_t\\]\n\n\\(\\bar{S}\\): mean susceptible individuals across the time-series. \\(Z_t\\) is the residuals or the shape of the susceptible dynamics, so \\(Z_t + \\bar{S} = S_t\\)\n\\(\\beta_t\\): contact rate at time t.\n\\(\\alpha\\): describes the epidemic saturation, a correction factor for switching from continuous to discrete time.",
    "crumbs": [
      "Deterministic models",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>tsiR</span>"
    ]
  },
  {
    "objectID": "tsir.html#basic-reproduction-number",
    "href": "tsir.html#basic-reproduction-number",
    "title": "2  tsiR",
    "section": "2.4 Basic reproduction number",
    "text": "2.4 Basic reproduction number\n\\[R_0 = \\beta \\times \\bar{S}\\]",
    "crumbs": [
      "Deterministic models",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>tsiR</span>"
    ]
  },
  {
    "objectID": "tsir.html#examples",
    "href": "tsir.html#examples",
    "title": "2  tsiR",
    "section": "2.5 Examples",
    "text": "2.5 Examples\n\nlibrary(tsiR)\n\nThe London measles data is available in the tsiR package.\n\nLondonMeas &lt;- twentymeas[[\"London\"]]\nhead(LondonMeas)\n\n      time cases   births     pop\n1 1944.016   180 1725.038 2462500\n2 1944.055   271 1726.429 2467578\n3 1944.093   423 1727.820 2472655\n4 1944.131   465 1729.211 2477733\n5 1944.170   523 1730.602 2482810\n6 1944.208   649 1731.992 2487888\n\n\n\nplotdata(LondonMeas)\n\n\n\n\n\n\n\n\n\nLondonRes &lt;- runtsir(data = LondonMeas, IP = 2, xreg = \"cumcases\", regtype = \"gaussian\", alpha = NULL, sbar = NULL, method = \"negbin\", nsim = 100, family = \"gaussian\", link = \"identity\")\n\n           alpha        mean beta         mean rho         mean sus \n        9.60e-01         1.19e-05         4.57e-01         1.14e+05 \nprop. init. sus. prop. init. inf. \n        3.01e-02         6.12e-05 \n\n\n\\[log I_{t + 1} = log \\beta_{t + 1} + log(Z_t + \\bar{S}) + \\alpha log I_t\\]\n\nalpha: describes the epidemic saturation, a correction factor for switching from continuous to discrete time.\nmean beta: mean of the contact rate across the time-series.\nmean rho: mean of the report rate across the time-series.\nmean sus: mean of the number of susceptible across the time-series.\nprop. init. sus.: proportion of the initial susceptible individuals.\nprop. init. inf.: proportion of the initial infectious individuals.\n\n\n\n\n\n1. Becker, A. D. & Grenfell, B. T. tsiR: An R package for time-series Susceptible-Infected-Recovered models of epidemics. PLOS ONE 12, e0185528 (2017).\n\n\n2. Finkenstädt, B. F. & Grenfell, B. T. Time series modelling of childhood diseases: A dynamical systems approach. Journal of the Royal Statistical Society Series C: Applied Statistics 49, 187–205 (2000).\n\n\n3. Du, Z., Zhang, W., Zhang, D., Yu, S. & Hao, Y. Estimating the basic reproduction rate of HFMD using the time series SIR model in Guangdong, China. PLOS ONE 12, e0179623 (2017).",
    "crumbs": [
      "Deterministic models",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>tsiR</span>"
    ]
  },
  {
    "objectID": "references.html",
    "href": "references.html",
    "title": "References",
    "section": "",
    "text": "1. Becker, A. D. & Grenfell, B. T. tsiR: An R package\nfor time-series Susceptible-Infected-Recovered models of epidemics.\nPLOS ONE 12, e0185528 (2017).\n\n\n2. Du,\nZ., Zhang, W., Zhang, D., Yu, S. & Hao, Y. Estimating the basic\nreproduction rate of HFMD using the time series SIR model in Guangdong,\nChina. PLOS ONE 12, e0179623 (2017).\n\n\n3. Finkenstädt, B. F. & Grenfell, B. T. Time series modelling of\nchildhood diseases: A dynamical systems approach. Journal of the\nRoyal Statistical Society Series C: Applied Statistics\n49, 187–205 (2000).",
    "crumbs": [
      "References"
    ]
  },
  {
    "objectID": "tsir.html#assumptions",
    "href": "tsir.html#assumptions",
    "title": "2  tsiR",
    "section": "",
    "text": "Infectious period is fixed at the sampling interval of the data (e.g., bi-weekly for measles). The time step of the model is equal to the infectious period.\nOver a long enough time (e.g., 10-20 years), the sum of births and cases should be approximately equal due to the high infectivity of pathogens such as measles and other childhood infections, in the pre-vaccine era.",
    "crumbs": [
      "Deterministic models",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>tsiR</span>"
    ]
  }
]