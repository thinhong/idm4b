[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Infectious disease modelling for babies",
    "section": "",
    "text": "Preface\nThis book brings together everything I have learned about infectious disease modelling during my PhD journey. Special thanks to my idol, Dr. James Hay, who once gave these genius advice:\n\n“Read and learn now - it will be harder later on.”\n“Spent a lot of time writing well-documented, generalisable code that didn’t necessarily turn into publications at the time. I now use that code all of the time.”\nDr. James Hay’s inspiring talk at the MIDSEA ECR April 2024 Meeting.\n\nThese words encouraged me to read and learn more, and to ensure every detail was carefully documented. In this book, you (and my future self) will find:\n\nA dictionary of jargon with cited definitions.\nMethodologies for mathematical models of infectious diseases.\nStep-by-step guides for writing infectious disease reports, following the Center for Disease Control and Prevention report format: data, workflow, analyses, and inference.\n\nThe content of this book has been shaped by the materials I have read and the courses I have attended, with specific articles and readings cited throughout the text. I would like to acknowledge the following educational experiences:\n\n\n\n\n\n\n\n\nCourse\nLecturers\nInstitutions\n\n\n\n\nMathematical Modelling for Vaccine-preventable Diseases (2022)\nProf. Caroline Trotter; Prof. Julia Gog; Prof. Nik Cunniffe; Prof. Thumbi Mwanga; A/Prof. Andrew Conlan; Dr. Cerian Webb; Dr. Katy Gaythorpe; Dr. Matt Castle\nVaccine Impact Modelling Consortium; University of Cambridge\n\n\nIntroduction to mathematical models of the Epidemiology & Control of Infectious Diseases (2022)\nProf. Azra Ghani; Prof. Alex Cook; Dr. Lilith Whittles; Dr. Clare McCormack; Dr. Tara Mangal; Dr. Juliette Unwin\nImperial College London; Nanyang Technological University\n\n\nSummer Institute in Statistics and Modeling in Infectious Diseases (SISMID) (2023)\nStochastic Epidemic Models with Inference: Prof. Tom Britton; Prof. Ira M Longini\nMCMC I: Prof. M. Elizabeth Halloran; Prof. Volodymyr Minin; Prof. Kari Auranen\nMCMC II: Prof. Philip O’Neill; Prof. Theodore Kypraios\nSimulation-Based Inference for Epidemiological Dynamics: Prof. Aaron King; Prof. Edward Ionides\nUniversity of Washington\n\n\nModelling Infectious Diseases in South East Asia (MIDSEA) Summer School (2024)\nModelling Master Class: Prof. Alex Cook; Prof. Jomar Fajardo Rabajante; Prof. Wirichada Pan Ngum\nModelling interventions and Health economic evaluation: Asst/Prof. Kiesha Prem; Asst/Prof. Hannah Clapham; Asst/Prof. Swapnil Mishra; Asst/Prof. Thitiya Theparod\nNational University of Singapore; Mahidol Oxford Research Unit; Oxford University Clinical Research Unit; University of the Philippines; De La Salle Manila; Mahasarakham University\n\n\n\nI would also like to acknowledge the following materials, which the authors kindly provided in response to my inquiries about these subjects:\n\nWorkshop: Modeling Rabies Outbreak and Control, by Dr. Phrutsamon Wongnak.\n\nIf you enjoyed this book or found any mistakes, please leave a comment below. Your feedback means a lot!",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "mod.html",
    "href": "mod.html",
    "title": "Modelling",
    "section": "",
    "text": "What is a model?\nA model is a simplified representation of a complex phenomenon (Vynnycky & White, 2010).\nWe all use models in our daily lives, often without realizing it. Imagine a colleague asks, “How long will it take to get to the restaurant?”. There are different ways you might answer this question, each reflecting a different “model” in your head:\nModels help us navigate and make decisions about complex situations by focusing on the most relevant factors and ignoring the less critical details.",
    "crumbs": [
      "Modelling"
    ]
  },
  {
    "objectID": "mod.html#what-is-a-model",
    "href": "mod.html#what-is-a-model",
    "title": "Modelling",
    "section": "",
    "text": "The Bull, by Pablo Picasso (source).\n\n\n\n\nExperience-based model: You might think, “Last week it took me 20 minutes to get to this restaurant”. This model simplifies by assuming past experiences are a reliable predictor of future outcomes, ignoring daily variations like traffic or weather.\nDistance and speed model: You might think, “The restaurant is 15 kilometers away, and I drive at 45 km/h, so it should take about 20 minutes”. This model uses the formula \\(\\text{time} = \\frac{\\text{distance}}{\\text{speed}}\\). It simplifies by assuming a constant speed, and not accounting for real-world complexities like traffic lights or congestion.",
    "crumbs": [
      "Modelling"
    ]
  },
  {
    "objectID": "mod.html#there-is-no-perfect-model",
    "href": "mod.html#there-is-no-perfect-model",
    "title": "Modelling",
    "section": "There is no perfect model",
    "text": "There is no perfect model\n\nDespite the advances in modelling that will arise in the coming decades, models will never be able to accurately predict if, or when, a particular person, farm or community will become infected. This is for two reasons:\n\nThe transmission of infection is a stochastic process, such that no two epidemics are identical.\nModels will always be an approximation, and rare or unforeseen behavioural events can have a significant impact on the disease dynamics\n\nKeeling M (2006) State-of-science review: predictive and real-time epidemiological modelling. London: Office of Science and Innovation (Christley et al., 2013; Keeling, 2006).",
    "crumbs": [
      "Modelling"
    ]
  },
  {
    "objectID": "mod.html#solving-a-model",
    "href": "mod.html#solving-a-model",
    "title": "Modelling",
    "section": "Solving a model",
    "text": "Solving a model\nSolving a model means finding a function that satisfies the given conditions. Consider the Malthusian growth model as an example:\n\\[\\frac{dP}{dt} = rP\\]\n\n\\(r\\): the growth rate.\n\\(P\\): the population size.\n\nSolving this model means to write a function of \\(P\\) that satisfies the derivative. This model can be solved analytically by:\n\\[\\begin{align} \\frac{dP}{dt} & = rP \\\\\n\\Leftrightarrow \\frac{dP}{P} & = rdt \\\\\n\\Leftrightarrow \\int \\frac{dP}{P} & = \\int rdt \\\\\n\\Leftrightarrow \\log P & = rt + C \\\\\n\\Leftrightarrow P & = e^{rt + C} \\end{align}\\]\nwhere \\(C\\) is the constant of integration.\n\n\n\n\nChristley, R. M., Mort, M., Wynne, B., Wastling, J. M., Heathwaite, A. L., Pickup, R., Austin, Z., & Latham, S. M. (2013). “Wrong, but Useful”: Negotiating Uncertainty in Infectious Disease Modelling. PLOS ONE, 8(10), e76277. https://doi.org/10.1371/journal.pone.0076277\n\n\nKeeling, M. J. (2006). State-of-science review: Predictive and real-time epidemiological modelling. S9. DTI.\n\n\nVynnycky, E., & White, R. (2010). An Introduction to Infectious Disease Modelling. OUP Oxford.",
    "crumbs": [
      "Modelling"
    ]
  },
  {
    "objectID": "sir-det.html",
    "href": "sir-det.html",
    "title": "1  SIR",
    "section": "",
    "text": "1.1 Model\n\\[\\frac{dS}{dt} = -\\beta SI = -\\lambda S \\tag{1.1}\\]\n\\[\\frac{dI}{dt} = \\beta SI - \\gamma I = \\lambda S - \\gamma I \\tag{1.2}\\]\n\\[\\frac{dR}{dt} = \\gamma I \\tag{1.3}\\]",
    "crumbs": [
      "Deterministic models",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>SIR</span>"
    ]
  },
  {
    "objectID": "sir-det.html#model",
    "href": "sir-det.html#model",
    "title": "1  SIR",
    "section": "",
    "text": "\\(\\beta\\): effective contact rate.\n\\(\\gamma\\): removal rate.\n\\(\\beta I = \\lambda\\): the rate from S to I is called force of infection.",
    "crumbs": [
      "Deterministic models",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>SIR</span>"
    ]
  },
  {
    "objectID": "sir-det.html#assumptions",
    "href": "sir-det.html#assumptions",
    "title": "1  SIR",
    "section": "1.2 Assumptions",
    "text": "1.2 Assumptions\n\nEach member of a population is either susceptible, infectious, or recovered (Driessche, 2017).\nThe disease spreads through direct contact between susceptible and infected individuals.\nWell-mixed population, or homogeneous mixing (represented by a single effective contact rate \\(\\beta\\)) (Becker & Grenfell, 2017).\nIn the most basic form it considers a “closed population” without demographics (no births, deaths, or migration) (Keeling & Rohani, 2011), make sense when the disease is short lived compared with the population lifetime (Driessche, 2017).\nThere is no latent period, individuals become infectious immediately upon contracting the disease.\nThe effective contact rate \\(\\beta\\) and recovery rate \\(\\gamma\\) are constant over time.\nInfectious disease properties are for a single pathogen (Becker & Grenfell, 2017).\nRecovered individuals gain lifelong immunity.",
    "crumbs": [
      "Deterministic models",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>SIR</span>"
    ]
  },
  {
    "objectID": "sir-det.html#density-or-frequency-dependent",
    "href": "sir-det.html#density-or-frequency-dependent",
    "title": "1  SIR",
    "section": "1.3 Density or frequency-dependent",
    "text": "1.3 Density or frequency-dependent\n\n\nSource: Density-dependent vs. Frequency-dependent Disease Transmission - Parasite Ecology.\n\n\n\nDensity-dependent\n\\[\\frac{dS}{dt} = -\\beta SI\\]\n\nThe unit of \\(\\beta\\) is \\(\\frac{1}{\\text{time} \\times \\text{people}}\\).\nTransmission increases as density increases.\nAerosol contacts (COVID-19).\n\n\nFrequency-dependent\n\\[\\frac{dS}{dt} = -\\beta S \\frac{I}{N}\\]\n\nThe unit of \\(\\beta\\) is \\(\\frac{1}{\\text{time}}\\).\nTransmission does not increase as density increases.\nSexually-transmitted diseases.",
    "crumbs": [
      "Deterministic models",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>SIR</span>"
    ]
  },
  {
    "objectID": "sir-det.html#code",
    "href": "sir-det.html#code",
    "title": "1  SIR",
    "section": "1.4 Code",
    "text": "1.4 Code\n\nlibrary(odin)\nlibrary(tidyr)\nlibrary(ggplot2)\nlibrary(RColorBrewer)\nlibrary(patchwork)\n\nBelow is how we numerically solve the differential equations Equation 1.1, Equation 1.2, Equation 1.3 in R with the odin package.\n\n\n\nListing 1.1: Deterministic SIR model\n\n\n\nodin_sir &lt;- odin::odin({\n  # Derivatives\n  deriv(S) &lt;- -beta * S * I\n  deriv(I) &lt;- beta * S * I - gamma * I\n  deriv(R) &lt;- gamma * I\n  deriv(CInc) &lt;- beta * S * I\n  \n  # Initial conditions\n  initial(S) &lt;- S_init\n  initial(I) &lt;- I_init\n  initial(R) &lt;- R_init\n  initial(CInc) &lt;- CInc_init\n  \n  # Parameters and initial values\n  beta &lt;- user(0.004)\n  gamma &lt;- user(0.5)\n  S_init &lt;- user(999)\n  I_init &lt;- user(1)\n  R_init &lt;- user(0)\n  CInc_init &lt;- user(0)\n})\n\nsir_mod &lt;- function(beta, gamma, S0, I0, R0, times) {\n  # Set values for a new run\n  odin_run &lt;- odin_sir$new(beta = beta, gamma = gamma, S_init = S0, I_init = I0, R_init = R0)\n  \n  # Run the model\n  out &lt;- data.frame(odin_run$run(times))\n\n  # Compute incidence from cumulative incidence\n  out$Inc &lt;- c(I0, diff(out$CInc))\n  out$CInc &lt;- NULL\n  out\n}",
    "crumbs": [
      "Deterministic models",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>SIR</span>"
    ]
  },
  {
    "objectID": "sir-det.html#incidence-or-prevalence",
    "href": "sir-det.html#incidence-or-prevalence",
    "title": "1  SIR",
    "section": "1.5 Incidence or prevalence",
    "text": "1.5 Incidence or prevalence\n\n\n\n\n\n\nImportant\n\n\n\nBe careful of what kind of data we are using to fit the model:\n\nIncidence: use the \\(\\beta SI\\) part.\n\n\\[\\text{Incidence} = \\frac{\\text{Number of new cases during a period}}{\\text{Population at risk during the same period}}\\]\n\nPrevalence: use the I compartment.\n\n\\[\\text{Prevalence} = \\frac{\\text{Number of existing cases at time t}}{\\text{Total population at time t}}\\]\n\n\nThere are two ways to compute incidence.\n\nWhile writing the differential equations, we tell odin to compute the cumulative incidence, then compute the incidence by using diff() on the cumulative incidence.\n\n\n# Cumulative incidence\nderiv(CInc) &lt;- beta * S * I\n# Compute incidence from cumulative incidence\nout$Inc &lt;- c(I0, diff(out$CInc))\n\n\nIn this “closed population”, the incidence is the number of individuals moving out of \\(S\\) in each time step. So we can compute it from the \\(S\\) column. Let compare it with the previous method.\n\n\npred &lt;- sir_mod(beta = 0.004, gamma = 0.5, S0 = 999, I0 = 1, R0 = 0, times = 0:13)\n\ntmp &lt;- pred\ntmp$Inc2 &lt;- c(tmp$I[1], -diff(tmp$S))\ntmp[,\"Inc-Inc2\"] &lt;- round(tmp$Inc - tmp$Inc2)\ntmp[,c(\"Inc\", \"Inc2\", \"Inc-Inc2\")]\n\n\n  \n\n\n\nNow let have a look at the output.\n\nhead(pred)\n\n\n  \n\n\n\n\n\nCode\ndf_plot &lt;- pivot_longer(pred, cols = S:Inc, names_to = \"comp\", values_to = \"n\")\n\nggplot(df_plot, aes(x = t, y = n, color = comp)) +\n  geom_line(linewidth = 1.2) +\n  scale_color_brewer(palette = \"PuOr\", breaks = c(\"S\", \"Inc\", \"I\", \"R\")) +\n  labs(color = NULL, y = NULL, x = \"Time\") +\n  theme_minimal() +\n  theme(legend.position = \"bottom\")\n\n\n\n\n\n\n\n\n\nThe time to peak of incidence is earlier than prevalence:\n\nIncidence reflects the immediate rate of new infections, the peak of incidence is reached when the transmission rate begins to decline.\nPrevalence accumulates both new and existing cases. Even after the incidence starts to decline, the active cases who were infected before the incidence peak are still there waiting for recovering. Prevalence only starts to decline when the recovery rate surpasses the rate of new infections significantly.\n\n\n\n\n\n\n\nImportant\n\n\n\nNormally, public health officials are interested in the incidence in the general population (to track disease spread) and the prevalence in intensive care units (to ensure it does not exceed ICU bed capacity).",
    "crumbs": [
      "Deterministic models",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>SIR</span>"
    ]
  },
  {
    "objectID": "sir-det.html#sensitivity-analysis",
    "href": "sir-det.html#sensitivity-analysis",
    "title": "1  SIR",
    "section": "1.6 Sensitivity analysis",
    "text": "1.6 Sensitivity analysis\nThe effective contact rate \\(\\beta\\) and the recovery rate \\(\\gamma\\) both affect whether or not there is an epidemic. The total number of people in the population and the initial number of infected people have no effect on whether there is an epidemic.\nBelow is a function that take a range of values of parameters and compare the model outputs.\n\n\nCode\nsir_sa &lt;- function(vals, parm, outcome, times, init_beta = 0.004, init_gamma = 0.5) {\n  pick_comp &lt;- ifelse(outcome == \"prev\", \"I\", \"Inc\")\n  plot_lab &lt;- ifelse(outcome == \"prev\", \"Prevalence\", \"Incidence\")\n  symb &lt;- ifelse(parm == \"beta\", \"\\u03b2\", \"\\u03b3\")\n  l &lt;- list()\n  for(i in 1:length(vals)) {\n    if (parm == \"beta\") {\n      pred &lt;- sir_mod(beta = vals[i], gamma = init_gamma, S0 = 999, I0 = 1, R0 = 0, times = times)[, c(\"t\", pick_comp)]\n    } else {\n      pred &lt;- sir_mod(beta = init_beta, gamma = vals[i], S0 = 999, I0 = 1, R0 = 0, times = times)[, c(\"t\", pick_comp)]\n    }\n    pred$comp &lt;- paste0(pick_comp, i)\n    colnames(pred) &lt;- c(\"t\", \"n\", \"comp\")\n    l[[i]] &lt;- pred\n  }\n  # Bind this list into a data frame\n  df_plot &lt;- Reduce(rbind, l)\n  # Set level I1 &lt; I2 &lt; I3... according to the increase of beta values\n  df_plot$comp &lt;- factor(df_plot$comp, levels = c(paste0(pick_comp, 1:length(vals))))\n  \n  # Plot results\n  my_palette &lt;- brewer.pal(9, \"Blues\")[(9-length(vals)+1):9]\n  \n  ggplot(df_plot, aes(x = t, y = n, color = comp)) + \n    geom_line(linewidth = 1.2) +\n    scale_color_manual(values = my_palette, labels = c(paste0(symb, \" = \", vals))) +\n    labs(color = NULL, y = plot_lab, x = \"Time\") +\n    theme_minimal()\n}\n\n\n\n1.6.1 Effective contact rate \\(\\beta\\)\n\n\nCode\nvals &lt;- seq(0.001, 0.006, 0.001)\n\np1 &lt;- sir_sa(vals = vals, parm = \"beta\", outcome = \"prev\", times = 0:13) + labs(x = NULL)\np2 &lt;- sir_sa(vals = vals, parm = \"beta\", outcome = \"inc\", times = 0:13)\n\np1 / p2 + plot_layout(guides = \"collect\") & theme(legend.position = \"bottom\")\n\n\n\n\n\n\n\n\n\nWhen \\(\\beta\\) decreases, less susceptible individuals become infected per unit time:\n\nTime until peak increases: because the speed of susceptible individuals become infected is slower.\nEpidemic duration increases: the rate of new infections slows down so it can lead to a longer epidemic period, but depends on the balance between the infection rate and the recovery rate.\nOutbreak size decreases: \\(R_0 = \\frac{\\beta}{\\gamma}\\), so if \\(\\beta\\) decreases, \\(R_0\\) decreases, each infected individual infect less people on average.\nLower epidemic peak: because fewer infections occurring simultaneously.\n\nInterventions that decrease \\(\\beta\\) cause a lower outbreak size and a lower epidemic peak. This effect is often referred to as “flattening the curve”.\n\n\n1.6.2 Recovery rate \\(\\gamma\\)\n\n\nCode\nvals &lt;- seq(0.3, 0.8, 0.1)\n\np1 &lt;- sir_sa(vals = vals, parm = \"gamma\", outcome = \"prev\", times = 0:13) + labs(x = NULL)\np2 &lt;- sir_sa(vals = vals, parm = \"gamma\", outcome = \"inc\", times = 0:13)\n\np1 / p2 + plot_layout(guides = \"collect\") & theme(legend.position = \"bottom\")\n\n\n\n\n\n\n\n\n\nWhen \\(\\gamma\\) decreases, patients recover more slowly:\n\nOutbreak size increases: patients remain infectious for a longer period; since \\(R_0 = \\frac{\\beta}{\\gamma}\\), a decrease in \\(\\gamma\\) leads to an increase in \\(R_0\\), meaning each infected individual infects less people on average.\nHigher epidemic peak: with a higher \\(R_0\\) more individuals are infected after each generation.\nTime until peak may increases: the infected population takes longer to clear out due to slower recovery, but the exact timing of the peak also depends on the balance between infection and recovery rates.\nEpidemic duration slightly increases: for same reason as the peak time, the overall duration of the epidemic is prolonged due to slower recovery rates.",
    "crumbs": [
      "Deterministic models",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>SIR</span>"
    ]
  },
  {
    "objectID": "sir-det.html#corollaries",
    "href": "sir-det.html#corollaries",
    "title": "1  SIR",
    "section": "1.7 Corollaries",
    "text": "1.7 Corollaries\n\n1.7.1 The threshold phenomenon\nFrom Equation 1.2:\n\\[\\frac{dI}{dt} = \\beta SI - \\gamma I = I(\\beta S - \\gamma)\\]\nThe infection “dies out” when:\n\\[\\frac{dI}{dt} &lt; 0 \\Leftrightarrow \\beta S - \\gamma &lt; 0 \\Leftrightarrow S &lt; \\frac{\\gamma}{\\beta}\\]\n\nThe proportion of susceptibles in the population must exceed this critical threshold \\(\\frac{\\gamma}{\\beta}\\) for an infection to invade (Keeling & Rohani, 2011).\n\nThe inverse of the relative removal rate is called the basic reproductive ratio \\(R_0 = \\frac{\\beta}{\\gamma}\\) (Keeling & Rohani, 2011). See Definition 1 for more details.\n\n\n1.7.2 Epidemic burnout\nDivide Equation 1.1 by Equation 1.3:\n\\[\\frac{dS}{dR} = \\frac{-\\beta S I}{\\gamma I} = -\\frac{\\beta}{\\gamma} S\\]\nUpon integrating with respect to R, we obtain:\n\\[S(t) = S(0)e^{-\\frac{\\beta}{\\gamma} R(t)}\\]\nGiven that \\(e^x &gt; 0 \\quad \\forall x\\), therefore \\(S(t) &gt; 0\\) there will always be some susceptibles in the population who escape infection, leading to an important counter-intuitive conclusion from this model:\n\nThe chain of transmission eventually breaks due to the decline in infectives, not due to a complete lack of susceptibles (Keeling & Rohani, 2011).\n\n\n\n\n\nBecker, A. D., & Grenfell, B. T. (2017). tsiR: An R package for time-series Susceptible-Infected-Recovered models of epidemics. PLOS ONE, 12(9), e0185528. https://doi.org/10.1371/journal.pone.0185528\n\n\nDriessche, P. van den. (2017). Reproduction numbers of infectious disease models. Infectious Disease Modelling, 2(3), 288–303. https://doi.org/10.1016/j.idm.2017.06.002\n\n\nKeeling, M. J., & Rohani, P. (2011). Modeling Infectious Diseases in Humans and Animals. Princeton University Press. https://doi.org/10.1515/9781400841035",
    "crumbs": [
      "Deterministic models",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>SIR</span>"
    ]
  },
  {
    "objectID": "seir-det.html",
    "href": "seir-det.html",
    "title": "2  SEIR",
    "section": "",
    "text": "2.1 Code\nlibrary(odin)\nlibrary(tidyr)\nlibrary(ggplot2)\nlibrary(RColorBrewer)\nlibrary(patchwork)\nLet reuse the deterministic SIR model code from Listing 1.1 and write code for the deterministic SEIR model.\nCode\npred1 &lt;- sir_mod(beta = 0.004, gamma = 0.5, S0 = 999, I0 = 1, R0 = 0, times = 1:20)\npred2 &lt;- seir_mod(beta = 0.004, sigma = 0.5, gamma = 0.5, S0 = 999, E0 = 0, I0 = 1, R0 = 0, times = 1:20)\n\ndf_plot &lt;- pivot_longer(pred1, cols = S:Inc, names_to = \"comp\", values_to = \"n\")\n\nmy_palette &lt;- brewer.pal(11, \"PuOr\")[c(10, 4, 3, 8)]\n\np1 &lt;- ggplot(df_plot, aes(x = t, y = n, color = comp)) +\n  geom_line(linewidth = 1.2) +\n  scale_color_manual(values = my_palette, breaks = c(\"S\", \"Inc\", \"I\", \"R\")) +\n  labs(color = NULL, y = NULL, x = NULL) +\n  theme_minimal() +\n  theme(legend.position = \"none\")\n\ndf_plot &lt;- pivot_longer(pred2, cols = S:Inc, names_to = \"comp\", values_to = \"n\")\n\nmy_palette &lt;- brewer.pal(11, \"PuOr\")[c(10, 1, 4, 3, 8)]\n\np2 &lt;- ggplot(df_plot, aes(x = t, y = n, color = comp)) +\n  geom_line(linewidth = 1.2) +\n  scale_color_manual(values = my_palette, breaks = c(\"S\", \"E\", \"Inc\", \"I\", \"R\")) +\n  labs(color = NULL, y = NULL, x = \"Time\") +\n  theme_minimal() +\n  theme(legend.position = \"bottom\")\n\np1 / p2",
    "crumbs": [
      "Deterministic models",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>SEIR</span>"
    ]
  },
  {
    "objectID": "seir-det.html#code",
    "href": "seir-det.html#code",
    "title": "2  SEIR",
    "section": "",
    "text": "Listing 2.1: Deterministic SEIR model\n\n\n\nodin_seir &lt;- odin::odin({\n  # Derivatives\n  deriv(S) &lt;- -beta * S * I\n  deriv(E) &lt;- beta * S * I - sigma * E\n  deriv(I) &lt;- sigma * E - gamma * I\n  deriv(R) &lt;- gamma * I\n  deriv(CInc) &lt;- sigma * E\n  \n  # Initial conditions\n  initial(S) &lt;- S_init\n  initial(E) &lt;- E_init\n  initial(I) &lt;- I_init\n  initial(R) &lt;- R_init\n  initial(CInc) &lt;- CInc_init\n  \n  # Parameters and initial values\n  beta &lt;- user(0.004)\n  sigma &lt;- user(0.5)\n  gamma &lt;- user(0.5)\n  S_init &lt;- user(369)\n  E_init &lt;- user(0)\n  I_init &lt;- user(1)\n  R_init &lt;- user(0)\n  CInc_init &lt;- user(0)\n})\n\nseir_mod &lt;- function(beta, sigma, gamma, S0, E0, I0, R0, times) {\n  # Set values for a new run\n  odin_run &lt;- odin_seir$new(beta = beta, sigma = sigma, gamma = gamma, S_init = S0, E_init = E0, I_init = I0, R_init = R0)\n  \n  # Run the model\n  out &lt;- data.frame(odin_run$run(times))\n\n  # Compute incidence from cumulative incidence\n  out$Inc &lt;- c(I0, diff(out$CInc))\n  out$CInc &lt;- NULL\n  out\n}",
    "crumbs": [
      "Deterministic models",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>SEIR</span>"
    ]
  },
  {
    "objectID": "tsir.html",
    "href": "tsir.html",
    "title": "3  tsiR",
    "section": "",
    "text": "3.1 Assumptions\nThe TSIR model relies on two main assumptions (Becker & Grenfell, 2017):",
    "crumbs": [
      "Deterministic models",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>tsiR</span>"
    ]
  },
  {
    "objectID": "tsir.html#assumptions",
    "href": "tsir.html#assumptions",
    "title": "3  tsiR",
    "section": "",
    "text": "Infectious period is fixed at the sampling interval of the data (e.g., bi-weekly for measles). The time step of the model is equal to the infectious period.\nOver a long enough time (e.g., 10-20 years), the sum of births and cases should be approximately equal due to the high infectivity of pathogens such as measles and other childhood infections, in the pre-vaccine era.",
    "crumbs": [
      "Deterministic models",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>tsiR</span>"
    ]
  },
  {
    "objectID": "tsir.html#model",
    "href": "tsir.html#model",
    "title": "3  tsiR",
    "section": "3.2 Model",
    "text": "3.2 Model\n\\[\\mathbb{E}(I_{t + 1}) = \\beta_{t + 1} S_t I_t^{\\alpha}\\]\n\n\n\n\n\n\nExplain\n\n\n\n\n\nThis equation describes the transmission through the multiplicative interaction between susceptible and infected individuals (Finkenstädt & Grenfell, 2000).\n\\[I_{t + 1} = \\beta_{t + 1} S_t^{\\alpha_1} I_t^{\\alpha_2} \\epsilon_t\\]\n\nSusceptible (\\(S_t\\)) meet infectious individuals (\\(I_t\\)) with contact rate \\(\\beta_{t + 1}\\).\n\\(\\alpha_1\\) and \\(\\alpha_2\\) are mixing parameters of the contact process, such that \\(\\alpha_1 = \\alpha_2 = 1\\) is the homogeneous mixing.\n\\(\\epsilon_t\\) is the noise, \\(\\mathbb{E}\\{ log(\\epsilon_t) \\} = 0\\) and \\(\\mathbb{V}\\{ log(\\epsilon_t) \\} = 0\\).\n\n\n\n\n\\[S_{t + 1} = B_{t + 1} + S_t - I_{t + 1}\\]\n\n\n\n\n\n\nExplain\n\n\n\n\n\nSusceptible class in the next time step recruited by births (\\(B_{t + 1}\\)) and depleted by the infected individuals leaving the class (\\(I_{t + 1}\\)) (Finkenstädt & Grenfell, 2000).",
    "crumbs": [
      "Deterministic models",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>tsiR</span>"
    ]
  },
  {
    "objectID": "tsir.html#tsir-framework",
    "href": "tsir.html#tsir-framework",
    "title": "3  tsiR",
    "section": "3.3 tsiR framework",
    "text": "3.3 tsiR framework\n\n3.3.1 Reconstruct susceptible dynamics\nFit a regression between cumulative cases and cumulative births. The slope is assumed to be the report rate \\(\\rho_t\\) (rho) (Du et al., 2017), the residuals is assumed to be the shape of the susceptible dynamics (\\(Z_t\\)).\n\n\n\n\n\n\nExplain\n\n\n\n\n\nLet \\(\\rho_t\\) be the reporting rate and assume \\(\\rho_t\\) has a probability function with expected value \\(\\mathbb{E}(\\rho_t) = \\rho\\).\n\\[I_t = \\rho_t C_t\\]\n\n\\(I_t\\): the number of true cases.\n\\(C_t\\): the number of reported cases.\n\nThe number of true cases is under-reported if \\(\\rho_t &gt; 1\\) and is fully reported if \\(\\rho_t = 1\\).\nReplace \\(I_t\\) here:\n\\[S_t = B_t + S_{t - 1} - I_t\\]\n\\[S_t = B_t + S_{t - 1} - \\rho_t C_t\\]\nLet \\(\\mathbb{E}(S_t) = \\bar{S}\\) so that \\(S_t = \\bar{S} + Z_t\\), with \\(\\mathbb{E}(Z_t) = 0\\). The deviations \\(Z_t\\) from their mean follow the same recursive relationship as \\(S_t\\).\n\\[Z_t = B_t + Z_{t - 1} - \\rho_t C_t\\]\nA successive iteration to compute \\(Z_t\\) from \\(Z_0\\) gives:\n\\[Z_t = \\sum_{i = 1}^{t} B_i + Z_0 - \\sum_{i = 1}^{t} \\rho_i C_i\\]\n\n\\(\\sum_{i = 1}^{t} B_i\\): cumulative births.\n\\(\\sum_{i = 1}^{t} C_i\\): cumulative reported cases.\n\nFor ease of notation, let \\(Y_\\text{cumBirths} = \\sum_{i = 1}^{t} B_i\\), \\(X_\\text{cumCases} = \\sum_{i = 1}^{t} C_i\\), rearrange that equation so that we have:\n\\[Y_\\text{cumBirths} = \\rho X_\\text{cumCases} + Z_t - Z_0\\]\nIf we assume a constant reporting rate, this equation is a simple linear regression relationship between cumulative births \\(Y\\) and cumulative cases \\(X\\).\n\n\n\n\n\n3.3.2 Estimate parameters\nSet the expectation to the mean, then take log of both sides:\n\\[\\mathbb{E}(I_{t + 1}) = \\beta_{t + 1} S_t I_t^{\\alpha}\\]\n\\[log I_{t + 1} = log \\beta_{t + 1} + log(Z_t + \\bar{S}) + \\alpha log I_t\\]\n\n\\(\\bar{S}\\): mean susceptible individuals across the time-series. \\(Z_t\\) is the residuals or the shape of the susceptible dynamics, so \\(Z_t + \\bar{S} = S_t\\)\n\\(\\beta_t\\): contact rate at time t.\n\\(\\alpha\\): describes the epidemic saturation, a correction factor for switching from continuous to discrete time.",
    "crumbs": [
      "Deterministic models",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>tsiR</span>"
    ]
  },
  {
    "objectID": "tsir.html#basic-reproduction-number",
    "href": "tsir.html#basic-reproduction-number",
    "title": "3  tsiR",
    "section": "3.4 Basic reproduction number",
    "text": "3.4 Basic reproduction number\n\\[R_0 = \\beta \\times \\bar{S}\\]",
    "crumbs": [
      "Deterministic models",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>tsiR</span>"
    ]
  },
  {
    "objectID": "tsir.html#code",
    "href": "tsir.html#code",
    "title": "3  tsiR",
    "section": "3.5 Code",
    "text": "3.5 Code\n\nlibrary(tsiR)\n\nThe London measles data is available in the tsiR package.\n\nLondonMeas &lt;- twentymeas[[\"London\"]]\nhead(LondonMeas)\n\n\n  \n\n\n\nThe data frame containing cases and interpolated births and populations.\n\nplotdata(LondonMeas)\n\n\n\n\n\n\n\n\n\nLondonRes &lt;- runtsir(data = LondonMeas, IP = 2, xreg = \"cumcases\", regtype = \"gaussian\", alpha = NULL, sbar = NULL, method = \"negbin\", nsim = 100, family = \"gaussian\", link = \"identity\")\n\n           alpha        mean beta         mean rho         mean sus \n        9.60e-01         1.19e-05         4.57e-01         1.14e+05 \nprop. init. sus. prop. init. inf. \n        3.01e-02         6.12e-05 \n\n\n\nalpha: describes the epidemic saturation, a correction factor for switching from continuous to discrete time.\nmean beta: mean of the contact rate across the time-series.\nmean rho: mean of the report rate across the time-series.\nmean sus: mean of the number of susceptible across the time-series.\nprop. init. sus.: proportion of the initial susceptible individuals.\nprop. init. inf.: proportion of the initial infectious individuals.\n\n\n3.5.1 Reconstruct susceptible dynamics\nIn this step we compute the reported rate using cumulative births and cumulative reported cases.\n\\[Y_\\text{cumBirths} = \\rho X_\\text{cumCases} + Z_t - Z_0\\]\n\nplotregression(LondonRes)\n\n\n\n\n\n\n\n\n\nplotrho(LondonRes)\n\n\n\n\n\n\n\n\n\n\n3.5.2 Estimate parameters\nHaving \\(\\rho\\), we adjust the \\(I_t\\) to estimate other parameters.\n\\[I_t = \\rho_t C_t\\] \\[log I_{t + 1} = log \\beta_{t + 1} + log(Z_t + \\bar{S}) + \\alpha log I_t\\]\n\nplotres(LondonRes)\n\nWarning in geom_line(data = dat$res, aes_string(x = \"time\", y = \"cases\", :\nIgnoring unknown aesthetics: fill\n\n\n\n\n\n\n\n\n\n\n\n\n\nBecker, A. D., & Grenfell, B. T. (2017). tsiR: An R package for time-series Susceptible-Infected-Recovered models of epidemics. PLOS ONE, 12(9), e0185528. https://doi.org/10.1371/journal.pone.0185528\n\n\nDu, Z., Zhang, W., Zhang, D., Yu, S., & Hao, Y. (2017). Estimating the basic reproduction rate of HFMD using the time series SIR model in Guangdong, China. PLOS ONE, 12(7), e0179623. https://doi.org/10.1371/journal.pone.0179623\n\n\nFinkenstädt, B. F., & Grenfell, B. T. (2000). Time series modelling of childhood diseases: A dynamical systems approach. Journal of the Royal Statistical Society Series C: Applied Statistics, 49(2), 187–205. https://doi.org/10.1111/1467-9876.00187",
    "crumbs": [
      "Deterministic models",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>tsiR</span>"
    ]
  },
  {
    "objectID": "calib.html",
    "href": "calib.html",
    "title": "Calibration",
    "section": "",
    "text": "Least squares estimation\n\\[RSS = \\sum_{i = 1}^{n}[y_i - f(x_i)]^2 \\tag{1}\\]\nLeast squares estimation corresponds to maximum likelihood estimation when the noise is normally distributed with equal variances.",
    "crumbs": [
      "Calibration"
    ]
  },
  {
    "objectID": "calib.html#sec-calib-mle",
    "href": "calib.html#sec-calib-mle",
    "title": "Calibration",
    "section": "Maximum likelihood estimation",
    "text": "Maximum likelihood estimation\nA generalization of the least squares idea is the likelihood.\n\nLikelihood\nThe likelihood is the probability of observing data \\(x\\) given that our model is true[^2], \\(\\mathbb{P}(x|M)\\).\n\n\nLog-likelihood\nWe have a lot of data points, and they are independent. The probability of observing all these data points at the same time is the production of these likelihood \\(\\mathbb{P}(x_1|M) \\times \\mathbb{P}(x_2|M) \\times \\mathbb{P}(x_3|M)... = \\prod\\mathbb{P}(x|M)\\).\nMultiplying things together, you will end up losing precision if the numbers are too low. Here you are dealing with probability (a value &lt; 1), multiplying 100 probabilities you will end up with 1e-100.\nBut remember that \\(log(a \\times b) = log(a) + log(b)\\), and very convenient that \\(log(1^{-100} = -230.2585)\\).\nSo \\(log(\\mathbb{P}(x_1|M) \\times \\mathbb{P}(x_2|M) \\times \\mathbb{P}(x_3|M)...)\\) \\(=\\) \\(log(\\mathbb{P}(x_1|M)) + log(\\mathbb{P}(x_2|M)) + log(\\mathbb{P}(x_3|M))...\\) and it is so much easier to handle.\n\n\nNegative log-likelihood\nBecause statistical packages optimizers work by minimizing a function. Minimizing means decrease the distance of two distributions to its lowest, this is fairly easy because we get this when the distance close to 0 (just like the trick we do in hypothesis testing).\nMinimizing negative log-likelihood (meaning that \\(-1 \\times \\text{log-likelihood}\\)) is equivalent to maximizing the log-likelihood, which is what we want to do (MLE: maximum likelihood estimation).",
    "crumbs": [
      "Calibration"
    ]
  },
  {
    "objectID": "calib.html#poisson-distribution",
    "href": "calib.html#poisson-distribution",
    "title": "Calibration",
    "section": "Poisson distribution",
    "text": "Poisson distribution\nPoisson distribution is a discrete probability distribution that expresses probability of a given number of events occurring in a fixed interval of time1.\nSuitable to use because here we are fitting a number of prev occurring in this period.",
    "crumbs": [
      "Calibration"
    ]
  },
  {
    "objectID": "calib.html#sec-calib-mle-lse",
    "href": "calib.html#sec-calib-mle-lse",
    "title": "Calibration",
    "section": "When MLE is equal to LSE",
    "text": "When MLE is equal to LSE\nAssuming the data is generated from a normal distribution with mean \\(\\mu\\) and a standard deviation \\(\\sigma\\).\n\nStep 1. Write down the likelihood function \\(L(\\theta)\\).\n\n\\[L(\\theta) = \\prod_{i = 1}^{n} \\mathcal{N}(\\mu_i, \\sigma) = \\prod_{i = 1}^{n} \\frac{1}{\\sigma\\sqrt{2 \\pi}} \\text{exp} \\left[ \\frac{-1}{2 \\sigma^2} (y_i - \\mu_i)^2 \\right]\\]\n\\[L(\\theta) = \\frac{1}{(\\sigma \\sqrt{2 \\pi})^n} \\text{exp} \\left[ \\frac{-1}{2 \\sigma^2} \\sum_{i = 1}^n (y_i - \\mu_i)^2 \\right]\\]\nSince \\(\\sigma\\) and \\(\\sqrt{2 \\pi}\\) are constant.\n\\[L(\\theta) \\varpropto \\text{exp} \\left[ - \\sum_{i = 1}^n (y_i - \\mu_i)^2 \\right]\\]\n\nStep 2. Take the natural log of the likelihood \\(log L(\\theta)\\).\n\n\\[log L(\\theta) \\varpropto - \\sum_{i = 1}^n (y_i - \\mu_i)^2\\]\n\nStep 3. Take the negative log-likelihood \\(- log L(\\theta)\\).\n\n\\[- log L(\\theta) \\varpropto \\sum_{i = 1}^n (y_i - \\mu_i)^2\\]\nThis looks exactly like the residual sum of squares at Equation 1.\n\nStep 4. The optimizer minimize negative log-likelihood \\(- log L(\\theta)\\). It does the same thing as the LSE finds the optimal parameters by minimizing the RSS.\n\n\n\n\n\nRui, J., Li, K., Wei, H., Guo, X., Zhao, Z., Wang, Y., Song, W., Abudunaibi, B., & Chen, T. (2024). MODELS: A six-step framework for developing an infectious disease model. Infectious Diseases of Poverty, 13(1), 30. https://doi.org/10.1186/s40249-024-01195-3",
    "crumbs": [
      "Calibration"
    ]
  },
  {
    "objectID": "calib.html#footnotes",
    "href": "calib.html#footnotes",
    "title": "Calibration",
    "section": "",
    "text": "Wikipedia https://en.wikipedia.org/wiki/Poisson_distribution↩︎",
    "crumbs": [
      "Calibration"
    ]
  },
  {
    "objectID": "lse.html",
    "href": "lse.html",
    "title": "5  Least squares estimation",
    "section": "",
    "text": "5.1 Methods\nRefer to Definition A.2, the residual sum of squares (RSS) is the sum of the squares of residuals.\n\\[RSS = \\sum_{i = 1}^{n}[y_i - f(x_i)]^2\\]\nThe least squares method finds the optimal parameters by minimizing the RSS.",
    "crumbs": [
      "Calibration",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Least squares estimation</span>"
    ]
  },
  {
    "objectID": "lse.html#methods",
    "href": "lse.html#methods",
    "title": "5  Least squares estimation",
    "section": "",
    "text": "\\(y_i\\): the observed value.\n\\(f(x_i)\\): the predicted value.\n\\(y_i - f(x_i)\\): the residual.",
    "crumbs": [
      "Calibration",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Least squares estimation</span>"
    ]
  },
  {
    "objectID": "lse.html#sec-lse-code",
    "href": "lse.html#sec-lse-code",
    "title": "5  Least squares estimation",
    "section": "5.2 Code",
    "text": "5.2 Code\n\nlibrary(tidyr)\nlibrary(odin)\nlibrary(ggplot2)\nlibrary(RColorBrewer)\n\nWe will use data collected during a H1N1 influenza outbreak in an elementary school in Pennsylvania (Cauchemez et al., 2011). Let load the data and have a look.\n\ndf &lt;- read.csv(\"data/flu_inc.csv\")\n\nggplot(df, aes(x = day, y = inc)) +\n  geom_point() +\n  labs(x = \"Day\", y = \"Incidence\") +\n  theme_minimal()\n\n\n\n\n\n\n\n\nWe will fit a deterministic SEIR model and reuse the code from Listing 2.1. Let plug some initial values for the parameters and run the model.\nLooking at the original paper, the school has 370 students (Cauchemez et al., 2011). So we set the initial values as below.\n\nS0 &lt;- 369\nE0 &lt;- 0\nI0 &lt;- 1\nR0 &lt;- 0\n\n\n\nCode\npred &lt;- seir_mod(beta = 0.004, sigma = 0.5, gamma = 0.5, S0 = S0, E0 = E0, I0 = I0, R0 = R0, times = df$day)\n\ndf_plot &lt;- pivot_longer(pred, cols = S:Inc, names_to = \"comp\", values_to = \"n\")\n\nmy_palette &lt;- brewer.pal(11, \"PuOr\")[c(10, 1, 4, 3, 8)]\n\nggplot(df_plot, aes(x = t, y = n, color = comp)) +\n  geom_line(linewidth = 1.2) +\n  scale_color_manual(values = my_palette, breaks = c(\"S\", \"E\", \"Inc\", \"I\", \"R\")) +\n  labs(color = NULL, y = NULL, x = \"Day\") +\n  theme_minimal() +\n  theme(legend.position = \"bottom\")\n\n\n\n\n\n\n\n\n\nNow just plot the incidence to compare with our data.\n\n\nCode\ndf_plot &lt;- pred[,c(\"t\", \"Inc\")]\nggplot(df_plot, aes(x = t, y = Inc)) +\n  geom_line(color = my_palette[3], linewidth = 1.2) +\n  geom_point(data = df, aes(x = day, y = inc)) +\n  labs(x = \"Day\", y = \"Incidence\") +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\nWe need to calculate the residual sum of squares. The rss() function must be defined this way with 2 arguments data and par so that it could be passed to the optim() function.\n\nrss &lt;- function(data, par) {\n  pred &lt;- seir_mod(beta = par[1], sigma = par[2], gamma = par[3], S0 = S0, E0 = E0, I0 = I0, R0 = R0, times = 0:(length(data) - 1))\n  sum((data - pred$Inc)^2)\n}\n\nThe optim() function needs at least 2 inputs:\n\npar: a vector of initial values for the parameters to be optimized over.\nfn: a function to be minimized.\n...: other arguments will be passed to fn, here our function rss() needs an additional argument data, so we pass data = df$inc.\n\n\nseir_optim &lt;- optim(par = c(0.004, 0.5, 0.5), fn = rss, data = df$inc)\nseir_optim\n\n$par\n[1] 0.007665126 1.697323120 2.209129854\n\n$value\n[1] 147.9004\n\n$counts\nfunction gradient \n     197       NA \n\n$convergence\n[1] 0\n\n$message\nNULL\n\n\nLet plug these values into the model and compare with our data.\n\nCode\npred &lt;- seir_mod(beta = seir_optim$par[1], sigma = seir_optim$par[2], gamma = seir_optim$par[3], S0 = S0, E0 = E0, I0 = I0, R0 = R0, times = df$day)\ndf_plot &lt;- pred[,c(\"t\", \"Inc\")]\nggplot(df_plot, aes(x = t, y = Inc)) +\n  geom_line(color = my_palette[3], linewidth = 1.2) +\n  geom_point(data = df, aes(x = day, y = inc)) +\n  labs(x = \"Day\", y = \"Incidence\") +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 5.1: Deterministic SEIR model fitted with least squares estimation.\n\n\n\nSince we are using a “closed population” SEIR model, \\(R_0 = \\frac{\\beta}{\\gamma} S_0\\).\n\n\n\nListing 5.1: \\(R_0\\) from deterministic SEIR model fitted with least squares estimation.\n\n\n\nrnum0 &lt;- seir_optim$par[1] * S0 / seir_optim$par[3]\nrnum0\n\n[1] 1.280337\n\n\n\n\n\nThis is quite close to 1.4 (95% CI: 1.2, 1.5) as reported by (Cauchemez et al., 2011), considering that they used more complicated methods.\n\n\n\n\nCauchemez, S., Bhattarai, A., Marchbanks, T. L., Fagan, R. P., Ostroff, S., Ferguson, N. M., Swerdlow, D., Pennsylvania H1N1 working group, the, Sodha, S. V., Moll, M. E., Angulo, F. J., Palekar, R., Archer, W. R., & Finelli, L. (2011). Role of social networks in shaping disease transmission during a community outbreak of 2009 H1N1 pandemic influenza. Proceedings of the National Academy of Sciences, 108(7), 2825–2830. https://doi.org/10.1073/pnas.1008895108",
    "crumbs": [
      "Calibration",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Least squares estimation</span>"
    ]
  },
  {
    "objectID": "mle.html",
    "href": "mle.html",
    "title": "6  Maximum likelihood estimation",
    "section": "",
    "text": "6.1 Methods\nThe maximum likelihood estimation follows 4 steps:\n\\[L(\\theta) = \\prod_{i = 1}^{n} f_Y(y_i| \\theta)\\]\n\\[log L(\\theta) = \\sum_{i = 1}^{n} log \\left[ f_Y(y_i| \\theta) \\right]\\]\n\\[- log L(\\theta) = - \\sum_{i = 1}^{n} log \\left[ f_Y(y_i| \\theta) \\right]\\]",
    "crumbs": [
      "Calibration",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Maximum likelihood estimation</span>"
    ]
  },
  {
    "objectID": "mle.html#methods",
    "href": "mle.html#methods",
    "title": "6  Maximum likelihood estimation",
    "section": "",
    "text": "Step 1. Write down the likelihood function \\(L(\\theta)\\). Likelihood function is a function of \\(\\theta\\), which is the product of the \\(n\\) mass/density function terms of the observed values \\(y_i\\).\n\n\n\nStep 2. Take the natural log of the likelihood \\(log L(\\theta)\\), or log-likelihood. The production in likelihood now becomes the sum in log-likelihood. See Section 2.2 for more details.\n\n\n\nStep 3. Take the negative log-likelihood \\(- log L(\\theta)\\). Because optimizers work by minimizing a function, we have to work on negative log-likelihood. See Section 2.3 for more details.\n\n\n\nStep 4. The optimizer try different values of \\(\\theta\\) in the paramater space \\(\\Theta\\) for which negative log-likelihood \\(- log L(\\theta)\\) is minimized.",
    "crumbs": [
      "Calibration",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Maximum likelihood estimation</span>"
    ]
  },
  {
    "objectID": "mle.html#code",
    "href": "mle.html#code",
    "title": "6  Maximum likelihood estimation",
    "section": "6.2 Code",
    "text": "6.2 Code\n\nlibrary(tidyr)\nlibrary(odin)\nlibrary(bbmle)\nlibrary(ggplot2)\nlibrary(RColorBrewer)\n\nWe will use the same data of a H1N1 influenza outbreak in an elementary school in Section 5.2 and fit the deterministic SEIR model with code Listing 2.1.\n\ndf &lt;- read.csv(\"data/flu_inc.csv\")\n\nLooking at the original paper, the school has 370 students (Cauchemez et al., 2011). So we set the initial values as below.\n\nS0 &lt;- 369\nE0 &lt;- 0\nI0 &lt;- 1\nR0 &lt;- 0\n\n\nStep 1. Write down the likelihood function \\(L(\\theta)\\).\n\nWe assume the incidence data is generated from a normal distribution with mean \\(\\mu_{inc}\\) is the predicted incidence and a standard deviation \\(\\sigma_{inc}\\).\n\\[L(\\theta) = \\prod_{i = 1}^{n} \\mathcal{N}(\\mu_{inc}, \\sigma_{inc})\\]\nWe use the dnorm() function to define this likelihood.\n\ndnorm(x = data, mean = pred, sd = sd_inc)\n\n\nStep 2. Take the natural log of the likelihood \\(log L(\\theta)\\), product becomes sum.\n\n\\[log L(\\theta) = \\sum_{i = 1}^{n} log \\left[ \\mathcal{N}(\\mu_{inc}, \\sigma_{inc}) \\right]\\]\n\nsum(dnorm(x = data, mean = pred, sd = sd_inc, log = T))\n\n\nStep 3. Take the negative log-likelihood \\(- log L(\\theta)\\).\n\n\\[- log L(\\theta) = - \\sum_{i = 1}^{n} log \\left[ \\mathcal{N}(\\mu_{inc}, \\sigma_{inc}) \\right]\\]\n\n- sum(dnorm(x = data, mean = pred, sd = sd_inc, log = T))\n\n\nStep 4. Pass the negative log-likelihood \\(- log L(\\theta)\\) to the optimizer.\n\nRoot mean squared error as SD\n\nmll &lt;- function(beta, sigma, gamma, sd_inc) {\n  # Make sure that parameters are positive\n  beta &lt;- exp(beta) \n  sigma &lt;- exp(sigma)\n  gamma &lt;- exp(gamma)\n  sd_inc &lt;- exp(sd_inc)\n  \n  pred &lt;- seir_mod(beta = beta, sigma = sigma, gamma = gamma, S0 = S0, E0 = E0, I0 = I0, R0 = R0, times = 0:(length(df$inc) - 1))\n  pred &lt;- pred$Inc\n  # Return the negative log-likelihood\n  - sum(dnorm(x = df$inc, mean = pred, sd = sd_inc, log = T))\n}\n\nstarting_param_val &lt;- list(beta = 0.004, sigma = 0.5, gamma = 0.5, sd_inc = 3)\n\nestimates &lt;- mle2(minuslogl = mll, start = lapply(starting_param_val, log), method = \"Nelder-Mead\")\n\nsummary(estimates)\n\nMaximum likelihood estimation\n\nCall:\nmle2(minuslogl = mll, start = lapply(starting_param_val, log), \n    method = \"Nelder-Mead\")\n\nCoefficients:\n        Estimate Std. Error  z value     Pr(z)    \nbeta   -5.063479   0.092641 -54.6567 &lt; 2.2e-16 ***\nsigma   0.708384   0.134498   5.2669 1.388e-07 ***\ngamma   0.600399   0.092968   6.4581 1.060e-10 ***\nsd_inc  0.530870   0.099628   5.3285 9.902e-08 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n-2 log L: 198.8602 \n\n\n\nparams &lt;- exp(coef(estimates))\nparams\n\n       beta       sigma       gamma      sd_inc \n0.006323524 2.030707475 1.822846603 1.700410622 \n\n\nCompare the model with data.\n\n\nCode\npred &lt;- seir_mod(beta = params[1], sigma = params[2], gamma = params[3], S0 = S0, E0 = E0, I0 = I0, R0 = R0, times = df$day)\ndf_plot &lt;- pred[,c(\"t\", \"Inc\")]\n\n# Compute 95% confidence interval\nlwr &lt;- qnorm(p = 0.025, mean = pred$Inc, sd = params[4])\nupr &lt;- qnorm(p = 0.975, mean = pred$Inc, sd = params[4])\n\nmy_palette &lt;- brewer.pal(11, \"PuOr\")[c(10, 1, 4, 3, 8)]\n\nggplot(df_plot, aes(x = t, y = Inc)) +\n  geom_line(color = my_palette[3], linewidth = 1.2) +\n  geom_ribbon(aes(ymin = lwr, ymax = upr), fill = my_palette[3], alpha = 0.15) +\n  geom_point(data = df, aes(x = day, y = inc)) +\n  coord_cartesian(ylim = c(0, max(upr))) +\n  labs(x = \"Day\", y = \"Incidence\") +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\nIt looks very similar to the model we fitted with LSE at Figure 5.1.\nLet compute \\(R_0\\). For a “closed population” SEIR model, \\(R_0 = \\frac{\\beta}{\\gamma} S_0\\). Again, this is similar to the \\(R_0\\) estimated from LSE at Listing 5.1. The reason is MLE is equal to LSE when we pick the normal distribution likelihood, see Section 4 for more details.\n\nrnum0 &lt;- params[1] * S0 / params[3]\nrnum0\n\n    beta \n1.280075 \n\n\n\n\n\n\nCauchemez, S., Bhattarai, A., Marchbanks, T. L., Fagan, R. P., Ostroff, S., Ferguson, N. M., Swerdlow, D., Pennsylvania H1N1 working group, the, Sodha, S. V., Moll, M. E., Angulo, F. J., Palekar, R., Archer, W. R., & Finelli, L. (2011). Role of social networks in shaping disease transmission during a community outbreak of 2009 H1N1 pandemic influenza. Proceedings of the National Academy of Sciences, 108(7), 2825–2830. https://doi.org/10.1073/pnas.1008895108",
    "crumbs": [
      "Calibration",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Maximum likelihood estimation</span>"
    ]
  },
  {
    "objectID": "rnum.html",
    "href": "rnum.html",
    "title": "Reproduction number",
    "section": "",
    "text": "Basic reproduction number \\(R_0\\)\nThe basic reproduction number is sometimes called the basic reproductive number or basic reproductive ratio (Driessche, 2017).\nEstimations of the R0 value are often calculated as a function of 3 primary parameters (Chitnis, 2017; Jones, 2007):\n\\[R_0 = \\begin{pmatrix} \\text{Number of} \\\\ \\text{contacts} \\\\ \\text{per unit time} \\end{pmatrix} \\times \\begin{pmatrix} \\text{Probability of} \\\\ \\text{transmission} \\\\ \\text{per contact} \\end{pmatrix} \\times \\begin{pmatrix} \\text{Duration} \\\\ \\text{of} \\\\ \\text{infectious} \\end{pmatrix}\\]",
    "crumbs": [
      "Reproduction number"
    ]
  },
  {
    "objectID": "rnum.html#basic-reproduction-number-r_0",
    "href": "rnum.html#basic-reproduction-number-r_0",
    "title": "Reproduction number",
    "section": "",
    "text": "Definition 1 \\(R_0\\) (pronounced /R naught/) is the average number of individuals infected by each infectious individual in a fully susceptible population (Vegvari et al., 2022). In short, \\(R_0\\) is the \\(R\\) in a fully susceptible population, the maximum \\(R\\) in a population.\n\n\n\n\n\n\n\n\n\n\nCautions\n\n\n\n\nFor many vaccine-preventable diseases, \\(R_0\\) values were calculated long ago in history. For example, measles \\(R_0\\) values of 12-18 are based on data from 1912-1928 in the United States (\\(R_0 = 12.5\\)) and 1944-1979 in England and Wales (\\(R_0 = 13.7-18.0\\)). For pertussis, the original data sources are 1908-1917 in the United States (\\(R_0 = 12.2\\)) and 1944-1979 in England and Wales (\\(R_0 = 14.3-17.1\\)). Human contact patterns in the past are extremely unlikely to match present day epidemiological realities. However, historical \\(R_0\\) values are so frequently cited that new \\(R_0\\) values using modern data might be dismissed if they fall outside the old range. Public health decisions should be made using up-to-date \\(R_0\\) values (Delamater et al., 2019).\n\\(R_0\\) is not a biological constant for a pathogen, and \\(R_0\\) cannot be modified through vaccination campaigns (Delamater et al., 2019). In fact, more than 20 different \\(R_0\\) values (range 5.4-18) were reported for measles in a variety of study areas and periods, and a review in 2017 identified feasible measles \\(R_0\\) values of 3.7-203.3 (Delamater et al., 2019).\n\\(R_0\\) estimates in the early phase may not be representative for the population if the group of initial transmitters is atypical (Vegvari et al., 2022) (e.g. monkeypox).\n\\(R_0\\) may be incorrectly estimated if asymptomatic individuals are not counted or recognised, and their epidemiologically relevant behaviour differs from that of symptomatic individuals (Vegvari et al., 2022).",
    "crumbs": [
      "Reproduction number"
    ]
  },
  {
    "objectID": "rnum.html#effective-reproduction-number-r_e",
    "href": "rnum.html#effective-reproduction-number-r_e",
    "title": "Reproduction number",
    "section": "Effective reproduction number \\(R_e\\)",
    "text": "Effective reproduction number \\(R_e\\)\n\nDefinition 2 \\(R_e\\) is the average number of secondary cases generated by each infectious individual throughout their infectious period in a population that may be partially immune (Wallinga & Lipsitch, 2006).\n\nLet \\(s\\) be the proportion of the population that is susceptible.\n\\[R_e = s \\times R_0\\]",
    "crumbs": [
      "Reproduction number"
    ]
  },
  {
    "objectID": "rnum.html#effective-reproduction-number-at-time-t-r_t",
    "href": "rnum.html#effective-reproduction-number-at-time-t-r_t",
    "title": "Reproduction number",
    "section": "Effective reproduction number at time \\(t\\) \\(R_t\\)",
    "text": "Effective reproduction number at time \\(t\\) \\(R_t\\)\n\nDefinition 3 \\(R_e(t)\\) (Knight & Mishra, 2020) or \\(R_t\\) is the average number of secondary cases generated by one infected person at time \\(t\\) during the outbreak, where some individuals may no longer be susceptible (Gostic et al., 2020).\n\nA public health control strategy will end an outbreak if it can keep \\(R_t\\) below 1. The level of immunity at which \\(R_t = 1\\) is the herd immunity threshold (Vegvari et al., 2022).\n\n\n\n\n\n\n\n\n\nAt the beginning of an outbreak, we can estimate \\(R_0\\) when the whole population is fully susceptible. As the outbreak progresses, the number of susceptible individuals decreases, leading to a decline in \\(R_0\\). This adjusted value is referred to as \\(R_t\\) (if we want to measure at each time \\(t\\)). At the peak of the epidemic curve, \\(R_t = 1\\). After this peak, \\(R_t\\) continues to decrease, resulting in a decline in the number of new cases and the epidemic curve going down.\n\\(R_t\\) can be defined in 2 ways:\n\nInstantaneous reproduction number (\\(R_t^i\\)): the average number of individuals someone infected at time \\(t\\) would infect if conditions remained unchanged (Green et al., 2022).\nCase reproduction number (\\(R_t^c\\)): the average number of people an individual infected at time t actually infects, which will depend on changes in policy or behavior over the period of that cohort’s infection, and can only be estimated in retrospect (Green et al., 2022).\n\n\nInstantaneous reproduction number \\(R_t^i\\)\n\n\nFigure illustrates the Cori method (Gostic et al., 2020).\n\nMeasures transmission at a specific point in time (Gostic et al., 2020). The instantaneous reproduction number quantifies the number of new infections at a single point in time \\(t_i\\) (blue arrow), using the number of infections in the previous generation (green arrows) and their current infectiousness (green curve) (Gostic et al., 2020). The analyses can be done near real-time.\nMethods to estimate instantaneous reproduction number includes Cori and colleagues (Cori et al., 2013) (the best for near real-time estimation (Gostic et al., 2020)), and Bettencourt and Ribeiro (Bettencourt & Ribeiro, 2008) (use with caution because they implicitly assume the generation interval follows an exponential distribution, as in SIR model, which does not include alatent period).\n\n\nCase reproduction number \\(R_t^c\\)\n\n\nFigure illustrates the Wallinga and Teunis method (Gostic et al., 2020).\n\nMeasures transmission by a specific cohort of individuals (Gostic et al., 2020). A cohort is a group of individuals with the same date of infection or the same date of symptom onset. The case reproduction number is the average number of new infections that an individual who becomes infected on day \\(t_i\\) (green arrows in B) or symptomatic on day \\(t_s\\) (yellow arrows in C) will eventually go on to cause (blue downward arrows in B and C). It is a more natural choice for analyses that consider heterogeneity among individuals (Gostic et al., 2020).\nMethods to estimate instantaneous reproduction number includes Wallinga and Teunis method (Wallinga & Teunis, 2004).",
    "crumbs": [
      "Reproduction number"
    ]
  },
  {
    "objectID": "rnum.html#sec-rnum-growthrate-r0",
    "href": "rnum.html#sec-rnum-growthrate-r0",
    "title": "Reproduction number",
    "section": "Growth rate \\(r\\) and basic reproduction number \\(R_0\\)",
    "text": "Growth rate \\(r\\) and basic reproduction number \\(R_0\\)\nIn the initial phase of an epidemic where the population is completely susceptible, incidence increase exponentially.\nThe exponential growth rate \\(r\\) is defined as the per capita change in number of new cases per unit of time (Wallinga & Lipsitch, 2006). Let \\(C_0\\) be the incidence at time \\(t = 0\\). For continuous time \\(t\\), the incidence at time \\(t\\) is given by:\n\\[C_t = C_0 e^{rt}\\]\n\n\n\n\n\n\nExplanation\n\n\n\n\n\nLet \\(M\\) is the money you have at time \\(t = 0\\), \\(r\\) is the annual interest rate. The money you have after each year would be:\n\\[\\begin{align} M_1 & = M_0 + r M_0 = M_0 (1 + r) \\\\\nM_2 & = M_1 + r M_1 = M_1 (1 + r) \\\\\n& = M_0 (1 + r)(1 + r) = M_0 (1 + r)^2 \\\\\nM_3 & = M_2 + r M_2 = M_2 (1 + r) \\\\\n& = M_0 (1 + r)^2(1 + r) = M_0 (1 + r)^3 \\\\\n& \\cdots \\\\\nM_t & = M_0 (1 + r)^t \\end{align}\\]\nNow we imagined that, instead of paying interest once a year at a rate of \\(r\\), a bank might add interest twice a year at the rate \\(\\frac{r}{2}\\), or three times a year at the rate \\(\\frac{r}{3}\\). In general, we considered interest added \\(n\\) times a year at the rate of \\(\\frac{r}{n}\\). In this case, each year your money is:\n\\[M_t = M_0 \\left(1 + \\frac{r}{n} \\right)^{nt}\\]\nWhen \\(n\\) is very large and thus \\(\\frac{r}{n}\\) is very small, we can prove that:\n\\[\\lim_{n \\to \\infty} \\left(1 + \\frac{r}{n}\\right)^{n} \\approx e^r\\]\nProof\n\\[L = \\lim_{n \\to \\infty} \\left(1 + \\frac{r}{n}\\right)^{n}\\]\nTake the natural logarithm:\n\\[\\log L = \\log \\left[ \\lim_{n \\to \\infty} \\left(1 + \\frac{r}{n}\\right)^n \\right]\\]\nSince the natural logarithm is a continuous function, we can bring the limit inside the logarithm.\n\\[\\begin{align} \\log L & = \\lim_{n \\to \\infty} \\log \\left[ \\left(1 + \\frac{r}{n}\\right)^n \\right] \\\\\n& = \\lim_{n \\to \\infty} n \\log \\left(1 + \\frac{r}{n} \\right) \\end{align}\\]\nFor small values of \\(x\\), we can approximate \\(\\log(1 + x) \\approx x - \\frac{x^2}{2} + \\frac{x^3}{3} - \\cdots\\). When \\(x\\) is very small, higher-order terms become negligible, so: \\[\\log \\left(1 + \\frac{r}{n}\\right) \\approx \\frac{r}{n}\\]\nSubstitute this approximation into \\(L\\):\n\\[\\log L \\approx \\lim_{n \\to \\infty} n \\left( \\frac{r}{n} \\right) = \\lim_{n \\to \\infty} r = r\\]\nTherefore:\n\\[\\begin{align} \\log L & \\approx r \\\\\n\\Leftrightarrow L & \\approx e^r \\\\\n\\Leftrightarrow \\lim_{n \\to \\infty} \\left(1 + \\frac{r}{n}\\right)^{n} & \\approx e^r \\end{align}\\]\nTherefore:\n\\[M_t = M_0 \\left(1 + \\frac{r}{n} \\right)^{nt} \\approx M_0 e^{rt}\\]\n\n\n\nWe start with \\(C_0\\) infected individuals, each infects \\(R_0\\) individuals after generation time \\(T_g\\). The number of infected individuals will be:\n\\[\\begin{align} C_{T_g} & = C_0 R_0 \\end{align} \\tag{1}\\]\nWe also proved that:\n\\[\\begin{align} C_t & = C_0 e^{rt} \\\\\n\\Leftrightarrow C_{T_g} & = C_0 e^{rT_g} \\end{align}\\]\nSubstitute Equation 1, we have:\n\\[\\begin{align} C_0 R_0 & = C_0 e^{rT_g} \\\\\n\\Leftrightarrow R_0 & = e^{rT_g} \\end{align}\\]\nWe can prove that:\n\\[R_0 = e^{rT_g} \\approx 1 + rT_g\\]\n\n\n\n\n\n\nProof\n\n\n\n\n\nExpand \\(e^x\\) using the Taylor series:\n\\[e^x = 1 + x + \\frac{x^2}{2!} + \\frac{x^3}{3!} + \\cdots\\]\nSubstitute \\(x\\) with \\(rT_g\\) in the Taylor series expansion:\n\\[e^{rT_g} = 1 + rT_g + \\frac{{rT_g}^2}{2!} + \\frac{{rT_g}^3}{3!} + \\cdots\\]\nFor small values of \\(rT_g\\), \\(\\frac{{rT_g}^2}{2!}\\), \\(\\frac{{rT_g}^3}{3!}\\) become very small and can be neglected:\n\\[e^{rT_g} \\approx 1 + rT_g\\]\n\n\n\n\n\n\n\nBettencourt, L. M. A., & Ribeiro, R. M. (2008). Real Time Bayesian Estimation of the Epidemic Potential of Emerging Infectious Diseases. PLOS ONE, 3(5), e2185. https://doi.org/10.1371/journal.pone.0002185\n\n\nChitnis, N. (2017). Introduction to SEIR Models.\n\n\nCori, A., Ferguson, N. M., Fraser, C., & Cauchemez, S. (2013). A new framework and software to estimate time-varying reproduction numbers during epidemics. American Journal of Epidemiology, 178(9), 1505–1512. https://doi.org/10.1093/aje/kwt133\n\n\nDelamater, P. L., Street, E. J., Leslie, T. F., Yang, Y. T., & Jacobsen, K. H. (2019). Complexity of the basic reproduction number (R0) - volume 25, number 1january 2019 - emerging infectious diseases journal - CDC. https://doi.org/10.3201/eid2501.171901\n\n\nDriessche, P. van den. (2017). Reproduction numbers of infectious disease models. Infectious Disease Modelling, 2(3), 288–303. https://doi.org/10.1016/j.idm.2017.06.002\n\n\nGostic, K. M., McGough, L., Baskerville, E. B., Abbott, S., Joshi, K., Tedijanto, C., Kahn, R., Niehus, R., Hay, J. A., Salazar, P. M. D., Hellewell, J., Meakin, S., Munday, J. D., Bosse, N. I., Sherrat, K., Thompson, R. N., White, L. F., Huisman, J. S., Scire, J., … Cobey, S. (2020). Practical considerations for measuring the effective reproductive number, Rt. PLOS Computational Biology, 16(12), e1008409. https://doi.org/10.1371/journal.pcbi.1008409\n\n\nGreen, W. D., Ferguson, N. M., & Cori, A. (2022). Inferring the reproduction number using the renewal equation in heterogeneous epidemics. Journal of The Royal Society Interface, 19(188), 20210429. https://doi.org/10.1098/rsif.2021.0429\n\n\nJones, J. H. (2007). Notes on R0. California: Department of Anthropological Sciences, 323, 1–19.\n\n\nKnight, J., & Mishra, S. (2020). Estimating effective reproduction number using generation time versus serial interval, with application to covid-19 in the greater toronto area, canada. Infectious Disease Modelling, 5, 889–896. https://doi.org/10.1016/j.idm.2020.10.009\n\n\nVegvari, C., Abbott, S., Ball, F., Brooks-Pollock, E., Challen, R., Collyer, B. S., Dangerfield, C., Gog, J. R., Gostic, K. M., Heffernan, J. M., Hollingsworth, T. D., Isham, V., Kenah, E., Mollison, D., Panovska-Griffiths, J., Pellis, L., Roberts, M. G., Scalia Tomba, G., Thompson, R. N., & Trapman, P. (2022). Commentary on the use of the reproduction number R during the COVID-19 pandemic. Statistical Methods in Medical Research, 31(9), 1675–1685. https://doi.org/10.1177/09622802211037079\n\n\nWallinga, J., & Lipsitch, M. (2006). How generation intervals shape the relationship between growth rates and reproductive numbers. Proceedings of the Royal Society B: Biological Sciences, 274(1609), 599–604. https://doi.org/10.1098/rspb.2006.3754\n\n\nWallinga, J., & Teunis, P. (2004). Different epidemic curves for severe acute respiratory syndrome reveal similar impacts of control measures. American Journal of Epidemiology, 160(6), 509–516. https://doi.org/10.1093/aje/kwh255",
    "crumbs": [
      "Reproduction number"
    ]
  },
  {
    "objectID": "r0.html",
    "href": "r0.html",
    "title": "8  Estimating \\(R_0\\)",
    "section": "",
    "text": "8.1 Contact tracing\nThis approach is based upon the definition of \\(R_0\\). Once an individual is diagnosed, his/her contacts are traced and tested. \\(R_0\\) is then computed by averaging over the number of secondary cases of many diagnosed individuals (Breban et al., 2007).",
    "crumbs": [
      "Reproduction number",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Estimating $R_0$</span>"
    ]
  },
  {
    "objectID": "r0.html#contact-tracing",
    "href": "r0.html#contact-tracing",
    "title": "8  Estimating \\(R_0\\)",
    "section": "",
    "text": "Contact tracing figure from (Bradshaw et al., 2021)",
    "crumbs": [
      "Reproduction number",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Estimating $R_0$</span>"
    ]
  },
  {
    "objectID": "r0.html#exponential-growth-rate",
    "href": "r0.html#exponential-growth-rate",
    "title": "8  Estimating \\(R_0\\)",
    "section": "8.2 Exponential growth rate",
    "text": "8.2 Exponential growth rate\n\nDefinition 8.1 Generation interval is the time from the infection of a primary case to infection of the cases he/she generates (Cori et al., 2013).\n\nIf we match this to an SEIR model, the generation interval starts when the infector enters the E compartment (meaning they got infected). The latest time they can infect an infectee is at the end of their residence in the I compartment (they are infectious). Therefore, generation interval is the sum of residence times in compartments E and I (Gostic et al., 2020).\nThe mean generation interval decreases when susceptible persons are at risk of infectious contact from multiple sources. Because when a susceptible person has multiple potential infectors, there is a “race” to infect him/her in which only the first infectious contact leads to infection (Kenah et al., 2008).\nStep 1. Find an estimate for the mean generation time \\(T_g\\).\nStep 2. Identify the exponential phase of the epidemic curve: the period of which \\(\\log(\\text{incidence})\\) is linear.\nStep 3. Estimate the growth rate \\(r\\) for that phase by finding the slope from the linear regression on the \\(\\log(\\text{incidence})\\).\n\n\n\n\n\n\nProof\n\n\n\n\n\nSee Section 4 for more details. During the exponential phase, the incidence at time \\(t\\) is given by:\n\\[C_t = C_0 e^{rt}\\]\nTake the natural logarithm:\n\\[\\log C_t = log C_0 + rt\\]\nTherefore \\(r\\) is the slope from the linear regression on the \\(\\log(\\text{incidence})\\).\n\n\n\nStep 4. Given the exponential growth rate \\(r\\) and the \\(T_g\\), calculate the basic reproduction number:\n\nDiscrete generation:\n\n\\[R_0 = e^{rT_g}\\]\n\nIn an SIR model \\(T_g = \\frac{1}{\\gamma}\\) so:\n\n\\[R_0 \\approx 1 + rD = 1 + \\frac{r}{\\gamma}\\]\n\nIn an SEIR model \\(T_g = \\frac{1}{\\gamma} + \\frac{1}{\\sigma}\\) so:\n\n\\[R_0 \\approx (1 + rD)(1 + rL) = \\left( 1 + \\frac{r}{\\gamma} \\right) \\left( 1 + \\frac{r}{\\sigma} \\right)\\]\nIn which:\n\n\\(D\\) is the mean duration of the infectiousness.\n\\(L\\) is the mean duration of latency.\n\n\n8.2.1 Code\n\nlibrary(ggplot2)\nlibrary(patchwork)\n\nRead the data\n\ndf &lt;- read.csv(\"data/covid_uk.csv\")\n\nggplot(df, aes(x = day, y = inc)) +\n  geom_point() +\n  labs(x = \"Day\", y = \"Incidence\") +\n  theme_minimal()\n\n\n\n\n\n\n\n\nStep 1. Find an estimate for the mean generation time \\(T_g\\). Let say \\(T_g = D = 6.6\\) for COVID-19.\nStep 2. Identify the exponential phase of the epidemic curve: the period of which \\(\\log(\\text{incidence})\\) is linear.\n\ndf$loginc &lt;- log(df$inc)\n\np1 &lt;- ggplot(df, aes(x = day, y = inc)) +\n  geom_point() +\n  labs(x = NULL, y = \"Incidence\") +\n  theme_minimal()\n\np2 &lt;- ggplot(df, aes(x = day, y = loginc)) +\n  geom_point() +\n  labs(x = \"Day\", y = \"Log incidence\") +\n  theme_minimal()\n\np1 / p2\n\n\n\n\n\n\n\n\nLooks like day 1 to 21 is the exponential phase.\nStep 3. Estimate the growth rate \\(r\\) for that phase by finding the slope from the linear regression on the \\(\\log(\\text{incidence})\\).\n\nmod &lt;- lm(loginc ~ day, data = df[1:21,])\npred &lt;- data.frame(day = 1:21, loginc = predict(mod, data = df[1:21,]))\n\nggplot(df, aes(x = day, y = loginc)) +\n  geom_point() +\n  geom_line(data = pred, color = \"blue\") +\n  labs(x = \"Day\", y = \"Log incidence\") +\n  theme_minimal()\n\n\n\n\n\n\n\n\nLook at the linear regression:\n\nsummary(mod)\n\n\nCall:\nlm(formula = loginc ~ day, data = df[1:21, ])\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-1.45946 -0.32865 -0.05379  0.36148  0.98657 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept) -0.38285    0.25339  -1.511    0.147    \nday          0.30705    0.02018  15.216 4.28e-12 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.56 on 19 degrees of freedom\nMultiple R-squared:  0.9242,    Adjusted R-squared:  0.9202 \nF-statistic: 231.5 on 1 and 19 DF,  p-value: 4.28e-12\n\n\nThe slope is 0.3070509.\nStep 4. Given the exponential growth rate \\(r\\) and the \\(T_g\\), calculate the basic reproduction number.\nDiscrete generation: \\(R_0 = e^{rT_g}\\)\n\nexp(unname(mod$coefficients[2]) * 6.6)\n\n[1] 7.587758\n\n\nSIR model: \\(R_0 \\approx 1 + rD\\)\n\n1 + unname(mod$coefficients[2]) * 6.6\n\n[1] 3.026536\n\n\n\n\n\n\n\n\nNote\n\n\n\n\\(R_0\\) estimates are affected by the mean, variance and shape of the generation time distribution.\n\nA larger mean \\(T_g\\) leads to larger \\(R_0\\).\nFor the 2 models with the same mean but different distributions \\(T_g\\), \\(R_0\\) estimates are different:\n\nDiscrete generation assumes a uniform \\(T_g\\).\nSIR model assumes an exponential \\(T_g\\).\n\n\n\n\nPackage R0 provide a ready-to-use function est.R0.EG() to estimate \\(R_0\\) using exponential growth rate method. We can define different shape of \\(T_g\\), let try a \\(\\Gamma(6.6, 4)\\):\n\nlibrary(R0)\ngt &lt;- generation.time(\"gamma\", c(6.6, 4))\nplot(gt)\n\n\n\n\n\n\n\n\nNow compute \\(R_0\\):\n\nest.R0.EG(df$inc, gt, begin = 1, end = 21)\n\nWaiting for profiling to be done...\n\n\nReproduction number estimate using  Exponential Growth  method.\nR :  3.949484[ 3.716905 , 4.198451 ]",
    "crumbs": [
      "Reproduction number",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Estimating $R_0$</span>"
    ]
  },
  {
    "objectID": "r0.html#simple-compartmental-models",
    "href": "r0.html#simple-compartmental-models",
    "title": "8  Estimating \\(R_0\\)",
    "section": "8.3 Simple compartmental models",
    "text": "8.3 Simple compartmental models\nConsider a simple closed population SIR model.\n\\[\\begin{align} \\frac{dS}{dt} & = -\\beta SI \\\\ \\frac{dI}{dt} & = \\beta SI - \\gamma I\\\\ \\frac{dR}{dt} & = \\gamma I \\end{align}\\]\nFocusing on the \\(I\\) equation:\n\\[\\frac{dI}{dt} = \\beta SI - \\gamma I = I (\\beta S - \\gamma)\\]\nA disease spreads when:\n\\[\\begin{align} \\frac{dI}{dt} & &gt; 0 \\\\ \\Leftrightarrow I (\\beta S - \\gamma) & &gt; 0 \\\\ \\Leftrightarrow \\beta S - \\gamma & &gt; 0 \\\\ \\Leftrightarrow \\beta S & &gt; \\gamma \\\\ \\Leftrightarrow \\frac{\\beta S}{\\gamma} & &gt; 1 \\end{align}\\]\nThis leads to the definition of \\(R_0\\). By Definition 1, \\(R_0\\) is the \\(R\\) in a fully susceptible population \\(S_0\\):\n\\[R_0 = \\frac{\\beta S_0}{\\gamma}\\]\nTherefore:\n\n\\(R_0 &gt; 1\\) meaning that \\(\\frac{dI}{dt} &gt; 0\\), then the disease will spread.\n\\(R_0 &lt; 1\\) meaning that \\(\\frac{dI}{dt} &lt; 0\\), then no epidemic occurs.\n\nFor more complex compartmental models, especially those with more infected compartments, as proposed by (Diekmann et al., 1990) and (Driessche & Watmough, 2002), \\(R_0\\) can be determined using the next generation matrix (Driessche, 2017).",
    "crumbs": [
      "Reproduction number",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Estimating $R_0$</span>"
    ]
  },
  {
    "objectID": "r0.html#next-generation-matrix",
    "href": "r0.html#next-generation-matrix",
    "title": "8  Estimating \\(R_0\\)",
    "section": "8.4 Next generation matrix",
    "text": "8.4 Next generation matrix\n\\(R_0\\) is the maximum absolute eigenvalue (also called the spectral radius) of the next generation matrix (NGM) (Driessche, 2017).\nConsider an SEIR model with equal birth and death rate \\(\\mu\\).\n\\[\\begin{align} \\frac{dS}{dt} & = \\mu (S + E + I + R) -\\beta SI - \\mu S \\\\ \\frac{dE}{dt} & = \\beta SI - \\sigma E - \\mu E \\\\ \\frac{dI}{dt} & = \\sigma E - \\gamma I - \\mu I \\\\ \\frac{dR}{dt} & = \\gamma I - \\mu R \\end{align}\\]\nStep 1. Identify the infected compartments\nFor our SEIR model, the infected compartments are \\(E\\) and \\(I\\).\nStep 2. Write the NGM functions\n\n\\(\\mathcal{F}_i(x)\\): is the rate of appearance of new infections in compartment \\(i\\) (Driessche, 2017) (caused by contact).\n\\(\\mathcal{V}_i(x)\\): is the rate of other transitions between compartment \\(i\\) and other infected compartments (Driessche, 2017) (caused by transition between compartments).\n\nFor our SEIR model, we would write \\(\\mathcal{F}\\) and \\(\\mathcal{V}\\) as follows:\n\n\n\\[\\mathcal{F} = \\begin{bmatrix} \\beta SI \\\\ 0 \\end{bmatrix}\\] \\(\\mathcal{F}\\) is a vector contains of \\(\\begin{bmatrix} \\mathcal{F}_1 \\\\ \\mathcal{F}_2 \\end{bmatrix}\\):\n\n\\(\\mathcal{F}_1 = \\beta SI\\): the rate of new infections (caused by contact) in compartment \\(E\\).\n\\(\\mathcal{F}_2 = 0\\): as there is no new infections (caused by contact) in compartment \\(I\\).\n\n\n\\[\\mathcal{V} = \\begin{bmatrix} \\sigma E + \\mu E \\\\ - \\sigma E + \\gamma I + \\mu I \\end{bmatrix}\\]\n\\(\\mathcal{V}\\) is a vector contains of \\(\\begin{bmatrix} \\mathcal{V}_1 \\\\ \\mathcal{V}_2 \\end{bmatrix}\\):\n\n\\(\\mathcal{V}_1 = \\sigma E + \\mu E\\): is the rate of other transitions to and from compartment \\(E\\).\n\\(\\mathcal{V}_2 = - \\sigma E + \\gamma I + \\mu I\\): is the rate of other transitions to and from compartment \\(I\\).\n\n\n\n\\(\\mathcal{F}\\) and \\(\\mathcal{V}\\) are written such that:\n\\[\\frac{dx}{dt} = \\mathcal{F} - \\mathcal{V}\\]\nHere we have:\n\\[\\frac{dE}{dt} = \\mathcal{F}_1 - \\mathcal{V}_1 = \\beta SI - (\\sigma E + \\mu E)\\]\n\\[\\frac{dI}{dt} = \\mathcal{F}_2 - \\mathcal{V}_2 = 0 - (- \\sigma E + \\gamma I + \\mu I)\\]\nStep 3. Find the Jacobian matrix\nJacobian matrix \\(F\\) for \\(\\mathcal{F}\\), and \\(V\\) for \\(\\mathcal{V}\\). Jacobian matrix is a matrix contain all partial derivatives of a vector function.\n\\[\\begin{align} F & = \\begin{bmatrix} \\frac{\\partial \\mathcal{F}_1}{\\partial E} & \\frac{\\partial \\mathcal{F}_1}{\\partial I} \\\\ \\frac{\\partial \\mathcal{F}_2}{\\partial E} & \\frac{\\partial \\mathcal{F}_2}{\\partial I} \\end{bmatrix} \\\\ & = \\begin{bmatrix} \\frac{\\partial [\\beta SI]}{\\partial E} & \\frac{\\partial [\\beta SI]}{\\partial I} \\\\ \\frac{\\partial [0]}{\\partial E} & \\frac{\\partial [0]}{\\partial I} \\end{bmatrix} \\\\ & = \\begin{bmatrix} 0 & \\beta S \\\\ 0 & 0 \\end{bmatrix} \\end{align}\\]\nIn which:\n\n\\(\\frac{\\partial [\\beta SI]}{\\partial E} = 0\\): because there is no \\(E\\) in \\(\\beta SI\\).\n\\(\\frac{\\partial [\\beta SI]}{\\partial I} = \\beta S\\).\n\n\\[\\begin{align} V & = \\begin{bmatrix} \\frac{\\partial \\mathcal{V}_1}{\\partial E} & \\frac{\\partial \\mathcal{V}_1}{\\partial I} \\\\ \\frac{\\partial \\mathcal{V}_2}{\\partial E} & \\frac{\\partial \\mathcal{V}_2}{\\partial I} \\end{bmatrix} \\\\ & = \\begin{bmatrix} \\frac{\\partial [\\sigma E + \\mu E]}{\\partial E} & \\frac{\\partial [\\sigma E + \\mu E]}{\\partial I} \\\\ \\frac{\\partial [- \\sigma E + \\gamma I + \\mu I]}{\\partial E} & \\frac{\\partial [- \\sigma E + \\gamma I + \\mu I]}{\\partial I} \\end{bmatrix} \\\\ & = \\begin{bmatrix} \\sigma + \\mu & 0 \\\\ - \\sigma & \\gamma + \\mu \\end{bmatrix} \\end{align}\\]\nStep 4. Compute the NGM\nUse Definition A.4 to compute inverse matrix \\(V^{-1}\\):\n\\[\\begin{align} V^{-1} & = \\frac{1}{(\\sigma + \\mu)(\\gamma + \\mu)} \\begin{bmatrix} \\gamma + \\mu & - 0 \\\\ - \\sigma & \\sigma + \\mu \\end{bmatrix} \\\\& = \\begin{bmatrix} \\frac{1}{\\sigma + \\mu} & 0 \\\\ \\frac{\\sigma}{(\\sigma + \\mu)(\\gamma + \\mu)} & \\frac{1}{\\gamma + \\mu} \\end{bmatrix} \\end{align}\\]\n\\[\\begin{align} K & = FV^{-1} \\\\ & = \\begin{bmatrix} 0 & \\beta S \\\\ 0 & 0 \\end{bmatrix} \\begin{bmatrix} \\frac{1}{\\sigma + \\mu} & 0 \\\\ \\frac{\\sigma}{(\\sigma + \\mu)(\\gamma + \\mu)} & \\frac{1}{\\gamma + \\mu} \\end{bmatrix} \\\\ & = \\begin{bmatrix} \\frac{\\beta S \\sigma}{(\\sigma + \\mu)(\\gamma + \\mu)} & \\frac{\\beta S}{\\gamma + \\mu} \\\\ 0 & 0 \\end{bmatrix} \\end{align}\\]\n\n\n\n\n\n\nWhat is a next generation matrix?\n\n\n\n\n\nSource: quantpie’s video.\nA population consists of two groups: young and old.\n\nA young person on average infects 3 young and 2 old: \\(\\begin{bmatrix} 3 \\\\ 2 \\end{bmatrix}\\).\nAn old person on average infects 1 young and 2 old: \\(\\begin{bmatrix} 1 \\\\ 2 \\end{bmatrix}\\).\n\nEach group becomes a column in the next generation matrix (NGM):\n\\[\\text{NGM} = \\begin{bmatrix} 3 & 1 \\\\ 2 & 2 \\end{bmatrix}\\]\n\\(R_0\\) is the root of equation:\n\\[\\begin{align} \\begin{bmatrix} 3 - \\lambda & 1 \\\\ 2 & 2 - \\lambda \\end{bmatrix} & = 0 \\\\ \\Leftrightarrow (3 - \\lambda) \\times (2 - \\lambda) - 2 \\times 1 & = 0 \\\\ \\Leftrightarrow \\lambda^2 - 5 \\lambda + 6 - 2 & = 0 \\\\ \\Leftrightarrow \\lambda^2 - 5 \\lambda + 4 & = 0 \\end{align}\\]\nThere are two roots \\(\\lambda = 4\\) and \\(\\lambda = 1\\), for an outbreak to occur \\(R_0 &gt; 1\\), so here \\(R_0 = 4\\).\n\n\n\nStep 5. Compute \\(R_0\\)\n\\(R_0\\) is the eigenvalues of the NGM.\n\\[\\begin{align} det(K - \\lambda) & = \\begin{bmatrix} \\frac{\\beta S \\sigma}{(\\sigma + \\mu)(\\gamma + \\mu)} - \\lambda & \\frac{\\beta S}{\\gamma + \\mu} \\\\ 0 & 0 - \\lambda \\end{bmatrix} \\\\ & = [\\frac{\\beta S \\sigma}{(\\sigma + \\mu)(\\gamma + \\mu)} - \\lambda][0 - \\lambda] \\end{align}\\]\n\\[R_0 = \\frac{\\beta S \\sigma}{(\\sigma + \\mu)(\\gamma + \\mu)}\\]\n\n\n\n\n\n\nUse NGM to compute \\(R_0\\) for SIR model\n\n\n\n\n\nConsider a simple closed population SIR model.\n\\[\\begin{align} \\frac{dS}{dt} & = -\\beta SI \\\\ \\frac{dI}{dt} & = \\beta SI - \\gamma I\\\\ \\frac{dR}{dt} & = \\gamma I \\end{align}\\]\nStep 1. Identify the infected compartments\nFor our SIR model, the infected compartment is \\(I\\).\nStep 2. Write the NGM functions\n\\[\\mathcal{F} = \\beta SI\\]\n\\[\\mathcal{V} = \\gamma I\\]\nSuch that we have:\n\\[\\frac{dI}{dt} = \\mathcal{F} - \\mathcal{V} = \\beta SI - \\gamma I\\]\nStep 3. Find the Jacobian matrix\n\\[F = \\frac{\\partial \\mathcal{F}}{\\partial I} = \\frac{\\partial [\\beta SI]}{\\partial I} = \\beta S\\]\n\\[V = \\frac{\\partial \\mathcal{V}}{\\partial I} = \\frac{\\partial [\\gamma I]}{\\partial I} = \\gamma\\]\nStep 4 and 5. Compute the NGM and \\(R_0\\)\n\\[V^{-1} = \\gamma^{-1} = \\frac{1}{\\gamma}\\]\n\\[K = FV^{-1} = \\frac{\\beta S}{\\gamma}\\]\nHere we also have \\(R_0\\).\n\\[R_0 = \\frac{\\beta S}{\\gamma}\\]",
    "crumbs": [
      "Reproduction number",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Estimating $R_0$</span>"
    ]
  },
  {
    "objectID": "r0.html#epidemic-final-size",
    "href": "r0.html#epidemic-final-size",
    "title": "8  Estimating \\(R_0\\)",
    "section": "8.5 Epidemic final size",
    "text": "8.5 Epidemic final size\nIf there were no interventions or changes in behavior, the proportion of the population infected during the entire course of an epidemic would be approximately the non-zero solution of the equation:\n$$$$\n\n\n\n\nBradshaw, W. J., Alley, E. C., Huggins, J. H., Lloyd, A. L., & Esvelt, K. M. (2021). Bidirectional contact tracing could dramatically improve COVID-19 control. Nature Communications, 12(1), 232. https://doi.org/10.1038/s41467-020-20325-7\n\n\nBreban, R., Vardavas, R., & Blower, S. (2007). Theory versus Data: How to Calculate R0? PLOS ONE, 2(3), e282. https://doi.org/10.1371/journal.pone.0000282\n\n\nCori, A., Ferguson, N. M., Fraser, C., & Cauchemez, S. (2013). A new framework and software to estimate time-varying reproduction numbers during epidemics. American Journal of Epidemiology, 178(9), 1505–1512. https://doi.org/10.1093/aje/kwt133\n\n\nDiekmann, O., Heesterbeek, J. A. P., & Metz, J. A. J. (1990). On the definition and the computation of the basic reproduction ratio R0 in models for infectious diseases in heterogeneous populations. Journal of Mathematical Biology, 28(4), 365–382. https://doi.org/10.1007/BF00178324\n\n\nDriessche, P. van den. (2017). Reproduction numbers of infectious disease models. Infectious Disease Modelling, 2(3), 288–303. https://doi.org/10.1016/j.idm.2017.06.002\n\n\nDriessche, P. van den, & Watmough, J. (2002). Reproduction numbers and sub-threshold endemic equilibria for compartmental models of disease transmission. Mathematical Biosciences, 180(1), 29–48. https://doi.org/10.1016/S0025-5564(02)00108-6\n\n\nGostic, K. M., McGough, L., Baskerville, E. B., Abbott, S., Joshi, K., Tedijanto, C., Kahn, R., Niehus, R., Hay, J. A., Salazar, P. M. D., Hellewell, J., Meakin, S., Munday, J. D., Bosse, N. I., Sherrat, K., Thompson, R. N., White, L. F., Huisman, J. S., Scire, J., … Cobey, S. (2020). Practical considerations for measuring the effective reproductive number, Rt. PLOS Computational Biology, 16(12), e1008409. https://doi.org/10.1371/journal.pcbi.1008409\n\n\nKenah, E., Lipsitch, M., & Robins, J. M. (2008). Generation interval contraction and epidemic data analysis. Mathematical Biosciences, 213(1), 71–79. https://doi.org/10.1016/j.mbs.2008.02.007\n\n\nPandit, J. J. (2020). Managing the R0 of COVID-19: mathematics fights back. Anaesthesia, 75(12), 1643–1647. https://doi.org/10.1111/anae.15151",
    "crumbs": [
      "Reproduction number",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Estimating $R_0$</span>"
    ]
  },
  {
    "objectID": "rt.html",
    "href": "rt.html",
    "title": "9  Estimating \\(R_t\\)",
    "section": "",
    "text": "9.1 Instantaneous reproduction number \\(R_t^i\\)",
    "crumbs": [
      "Reproduction number",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Estimating $R_t$</span>"
    ]
  },
  {
    "objectID": "rt.html#instantaneous-reproduction-number-r_ti",
    "href": "rt.html#instantaneous-reproduction-number-r_ti",
    "title": "9  Estimating \\(R_t\\)",
    "section": "",
    "text": "Definition 9.1 The instantaneous reproduction number is the expected number of secondary infections occurring at time \\(t\\), divided by the number of infected individuals, each scaled by their relative infectiousness at time \\(t\\) (an individual’s relative infectiousness is based on the generation interval and time since infection) (Gostic et al., 2020).\n\n\n9.1.1 Exact calculation\nFor a compartmental model (SIR or SEIR), \\(R_t^i\\) can be calculated exactly as (Gostic et al., 2020):\n\\[R_t^i = \\beta(t) S(t) D\\]\n\n\\(\\beta(t)\\): the time-varying transmission rate.\n\\(S(t)\\): the fraction of the population that is susceptible.\n\\(D\\): the mean duration of infectiousness.\n\n\n\n9.1.2 Cori method\n\\[R_t^i = \\frac{I_t}{\\sum_{s = 1}^{t} I_{t - s} w_s}\\]\n\n\\(I_t\\): the number of infection on day \\(t\\).\n\\(I_{t - s}\\): the number of individuals who became infected \\(s\\) days in the past.\n\\(w_s\\): the infectivity profile, describes how infectious an individual is \\(s\\) days since infection, \\(w_s\\) dependent on time since infection \\(s\\) but independent of calendar time \\(t\\), and often be approximated by the generation interval (Cori et al., 2013).\n\\(I_{t - s} w_s\\): we scale the number of individuals who became infected \\(s\\) days in the past by how infectiousness are they still on day \\(t\\) (which is \\(s\\) days after the date they got infected, \\(w_s\\)).\n\nLooking back at Definition 9.1, \\(R_t^i\\) is the expected number of secondary infections occurring at time \\(t\\) (\\(I_t\\)), divided by the number of infected individuals (\\(\\sum_{s = 1}^{t} I_{t - s}\\)), each scaled by their relative infectiousness at time \\(t\\) (\\(w_s\\)).\nThe only parametric assumption required by this method is the form of the generation interval. The standard assumption is that \\(w_s\\) follows a discretized gamma distribution, but any parametric or empirical discrete distribution also work (Gostic et al., 2020).\n\n\n\n\n\n\nProofs\n\n\n\n\n\nThe renewal equation (also called the Euler-Lotka equation (Wallinga & Lipsitch, 2006)) is a cornerstone of demographic theory and backbone of the \\(R_t\\) estimators.\n\\[b(t) = \\int_{a = 0}^{\\infty} b(t - a) n(a) da\\]\n\n\\(b(t)\\): the number of female offspring at time \\(t\\).\n\\(b(t - a)\\): the number of mothers of age \\(a\\) at time \\(t\\), which is equal to the number of female offspring at time \\(t - a\\).\n\\(n(a)\\): the birth ability of mothers of age \\(a\\), scaled by the probability of surviving to age \\(a\\).\n\\(\\int_{a = 0}^{\\infty}\\): summing these female offspring over all possible mothers’ ages, we obtain the total number of female offspring at time \\(t\\) which is \\(b(t)\\).\n\nThis equation assume that the population displays exponential growth at a fixed growth rate and that the age distribution of the population does not change over time (Wallinga & Lipsitch, 2006).\nTo describe epidemic dynamics, the renewal equation is expressed in terms of \\(I(t)\\).\n\\[I(t) = R_0 S(t) \\int_{s = 0}^{\\infty} I(t - s) w_s ds\\]\n\n\\(R_0 S(t) = R_t\\): see Definition 3.\n\\(I(t - s)\\): the number of individuals who became infected \\(s\\) time points ago in the past.\n\\(w_s\\): the infectivity profile, or the probability of how infectiousness are they still at time \\(t\\) (which is \\(s\\) time points after the date they got infected).\n\\(I(t - s) w_s\\): we scale the number of individuals who in the past by how infectiousness are they still at time \\(t\\).\n\nNow we transform the equation a bit, and we got something very similar to the Cori method (see Section 9.1.2).\n\\[R_t = \\frac{I(t)}{\\int_{s = 0}^{\\infty} I(t - s) w_s ds}\\]\n\n\n\n\n\n9.1.3 When can we start estimating \\(R_t^i\\)?\nCori et al. suggest starting estimating \\(R_t^i\\) once those three criteria are fulfilled (Cori et al., 2013):\n\nAt least after the sliding window size.\nAt least after one mean serial interval.\nAt least 12 cases (the initial case + 11) have been observed since the beginning of the epidemic (in a time window): to get a posterior credible interval of 0.3, the time window must comprise at least 11 incident cases.\n\n\n\n9.1.4 Key considerations\nSource: Dr. Anne Cori’s webinar.\n\nTemporal resolution: we can’t apply the \\(R_t^i\\) method when the time step of observation is too large (&gt; mean generation interval).\nSpatial resolution: ideally use a spatial scale that you can distinguish locally infected cases from imported cases.\n\\(R_t^i\\) is very sensitive to the size of the sliding window: small windows can lead to highly variable estimates with wide credible intervals, whereas longer windows lead to smoothed estimates with narrower credible intervals. Perhaps also consider at least 11 incident cases in a sliding window to get a posterior credible interval of 0.3 (Cori et al., 2013).",
    "crumbs": [
      "Reproduction number",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Estimating $R_t$</span>"
    ]
  },
  {
    "objectID": "rt.html#case-reproduction-number-r_tc",
    "href": "rt.html#case-reproduction-number-r_tc",
    "title": "9  Estimating \\(R_t\\)",
    "section": "9.2 Case reproduction number \\(R_t^c\\)",
    "text": "9.2 Case reproduction number \\(R_t^c\\)\n\nDefinition 9.2 The case or cohort reproduction number is the expected number of secondary infections that an individual who becomes infected at time \\(t\\) will eventually cause as they progress through their infection (Gostic et al., 2020).\n\n\n9.2.1 Exact calculation\n\\[R_t^c = \\int_{u = t}^{\\infty} R_u^i w_{u-t} du\\]\n\n\\(R_u^i\\): the instantaneous reproduction number of current infected cases at time \\(u\\), starting from \\(t\\) to the end of their infectious period \\(\\infty\\).\n\\(w_{u-t}\\): the infectiousness of them at that time.\n\n\n\n9.2.2 Wallinga and Teunis method\nThere are 3 steps (Gostic et al., 2020):\nStep 1. Estimate the likelihood that case \\(j\\) (infected at time \\(t_j\\)) infected case \\(i\\) (at time \\(t_i\\)).\n\\[p_{ij} = \\frac{w_{t_i - t_j}}{\\sum_{i \\neq k} w_{t_i - t_k}}\\]\n\n\\(\\sum_{i \\neq k} w_{t_i - t_k}\\): sum of the infectiousness of all cases (other than \\(i\\)) infects case \\(i\\).\n\nStep 2. Compute the individual reproduction number of case \\(j\\).\n\\[R_j = \\sum_i p_{ij}\\]\nStep 3. Compute the case reproduction number at time \\(t\\), it is the expected value of \\(R_j\\) for all individuals infected at time \\(t\\).\n\\[R_t^c = \\mathbb{E}(R_j)\\]",
    "crumbs": [
      "Reproduction number",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Estimating $R_t$</span>"
    ]
  },
  {
    "objectID": "rt.html#compare-r_ti-and-r_tc",
    "href": "rt.html#compare-r_ti-and-r_tc",
    "title": "9  Estimating \\(R_t\\)",
    "section": "9.3 Compare \\(R_t^i\\) and \\(R_t^c\\)",
    "text": "9.3 Compare \\(R_t^i\\) and \\(R_t^c\\)\nThere are several important differences (Gostic et al., 2020):\n\nInstantaneous \\(R_t^i\\) is real-time estimation and only use data from before time \\(t\\), while case \\(R_t^c\\) is inherently forward-looking.\n\n\nInstantaneous \\(R_t^i\\) overestimates \\(R_t\\) early in the time series, because any infections that occurred before the first observed date are missing terms in the denominator (the \\(I_{t - s}\\) in Section 9.1.2, data is left-truncated at the beginning).\nCase \\(R_t^c\\) underestimates \\(R_t\\) at the end of the time series, because it relies on time points not yet observed which become missing terms in the integral (the \\(R_u^i\\) in Section 9.2.1, data is right-truncated at the end).\n\n\nCase \\(R_t^c\\) is shifted forward in time relative to instantaneous \\(R_t^i\\), produces leading estimates of \\(R_t\\) because it uses data from time points after \\(t\\), whereas the \\(R_t^i\\) uses data from time points before \\(t\\).\n\n\n\n\n\n\n\nImportant\n\n\n\nOverall, for real-time analyses aiming to infer the impact of changes in policy, behavior, or other extrinsic factors on transmission, the instantaneous reproductive number will provide more temporally accurate estimates and is most appropriate.",
    "crumbs": [
      "Reproduction number",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Estimating $R_t$</span>"
    ]
  },
  {
    "objectID": "rt.html#potential-biases",
    "href": "rt.html#potential-biases",
    "title": "9  Estimating \\(R_t\\)",
    "section": "9.4 Potential biases",
    "text": "9.4 Potential biases\n\\(R_t\\) is a value in specific time, therefore there are 2 potential forms of bias in \\(R_t\\) estimates (Gostic et al., 2020):\n\nAccuracy (the value): Systematic over- or underestimation caused by misspecification of the generation interval. Mostly impact when \\(R_t\\) is substantially &gt; 1 (e.g., the beginning of COVID-19 when \\(R_t\\) is relatively high) or &lt; 1 (e.g., after a very effective intervention then \\(R_t\\) might be low).\nTimeliness (the time): Temporal inaccuracy that \\(R_t\\) estimates may be leading or lagging the true date, has several possible causes and can be difficult to avoid.\n\n\n\nFigure from Sender et al. (Sender et al., 2022).\n\n\n9.4.1 Generation interval\nSee Definition 8.1 to recall the definition of generation interval.\n\n\nBiases from misspecification of the generation interval mean (A) or variance (B) (Gostic et al., 2020).\n\n\nIf mean generation interval is set too high, \\(R_t\\) will be more extreme (too high when true \\(R_t &gt; 1\\) and too low when true \\(R_t &lt; 1\\)).\nIf mean generation interval is set too low, \\(R_t\\) will be closer to 1 than the true value.\nThe effect of the mean generation interval is large when true \\(R_t\\) further from 1. Therefore, this bias may be greatest at the early epidemic, when true \\(R_t\\) is high, together with highly uncertain generation interval and limited data.\n\nTools like EpiEstim and EpiNow2 allow users to specify the prior variance of the mean and standard deviation. However, bear in mind that uncertainty around an incorrect generation interval only widen the 95% credible interval, but will not shift the estimates toward the truth and will not correct this bias.\n\n\n9.4.2 Serial interval\n\nDefinition 9.3 Serial interval is the time between symptom onset in an infector–infectee pair (Gostic et al., 2020).\n\nSerial interval is more easily observed than generation interval and often used in its place. Although the serial and generation intervals are often conflated, there are important differences (Gostic et al., 2020):\n\nSerial interval and generation interval usually have the same mean, but different variances.\nSerial interval can be negative (when the symptom onset of infector is later than infectee, such as in COVID-19), generation interval is always positive.\n\nThe distributions of the serial interval and the generation interval are identical in these scenarios (Cori et al., 2013):\n\nFor diseases such as influenza, SARS, measles, and smallpox, it is expected that infectiousness starts only around the time of symptom onset.\nWhen the infectiousness profile after symptoms is independent of the incubation period.\n\n\n\n9.4.3 Delays\n\n\nAdjusting for delays (Gostic et al., 2020).\n\nIf \\(d\\) is the delay from infection to observation, then observations at time \\(t\\) inform \\(R_{t − d}\\), not \\(R_t\\).\nIf the distribution of delays can be estimated, then \\(R_t\\) can be estimated in 2 steps:\n\nInfer the underlying time series of infections.\nInput the adjusted time series into an \\(R_t\\) estimation method.",
    "crumbs": [
      "Reproduction number",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Estimating $R_t$</span>"
    ]
  },
  {
    "objectID": "rt.html#code",
    "href": "rt.html#code",
    "title": "9  Estimating \\(R_t\\)",
    "section": "9.5 Code",
    "text": "9.5 Code\n\n9.5.1 EpiEstim\n\nlibrary(EpiEstim)\nlibrary(ggplot2)\n\nThe input data\n\ndata(Flu2009)\n\ndf &lt;- Flu2009$incidence\nhead(df)\n\n\n  \n\n\n\nLet have a look at the data.\n\nggplot(df, aes(x = dates, y = I)) +\n  geom_point() +\n  labs(x = \"Day\", y = \"Incidence\") +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\n9.5.1.1 \n\nmod &lt;- estimate_R(\n  incid = df, \n  method = \"parametric_si\", \n  config = make_config(\n    list(\n      mean_si = 2.6, \n      std_si = 1.5\n    )\n  )\n)\n\nDefault config will estimate R on weekly sliding windows.\n    To change this change the t_start and t_end arguments. \n\n\nNoted that the default config will estimate R on weekly sliding windows (day 2 to day 8).\n\nhead(mod$R)\n\n\n  \n\n\n\n\nplot(mod)\n\n\n\n\n\n\n\n\n\ntmp &lt;- df[df$dates &lt; as.Date(\"2009-05-11\"),]\nmod &lt;- estimate_R(\n  incid = tmp, \n  method = \"parametric_si\", \n  config = make_config(\n    list(\n      mean_si = 2.6, \n      std_si = 1.5\n    )\n  )\n)\n\nDefault config will estimate R on weekly sliding windows.\n    To change this change the t_start and t_end arguments. \n\nhead(mod$R)\n\n\n  \n\n\nplot(mod)\n\n\n\n\n\n\n\n\n\n\n\n9.5.2 EpiNow2\n\n\n\n\nCori, A., Ferguson, N. M., Fraser, C., & Cauchemez, S. (2013). A new framework and software to estimate time-varying reproduction numbers during epidemics. American Journal of Epidemiology, 178(9), 1505–1512. https://doi.org/10.1093/aje/kwt133\n\n\nGostic, K. M., McGough, L., Baskerville, E. B., Abbott, S., Joshi, K., Tedijanto, C., Kahn, R., Niehus, R., Hay, J. A., Salazar, P. M. D., Hellewell, J., Meakin, S., Munday, J. D., Bosse, N. I., Sherrat, K., Thompson, R. N., White, L. F., Huisman, J. S., Scire, J., … Cobey, S. (2020). Practical considerations for measuring the effective reproductive number, Rt. PLOS Computational Biology, 16(12), e1008409. https://doi.org/10.1371/journal.pcbi.1008409\n\n\nSender, R., Bar-On, Y., Park, S. W., Noor, E., Dushoff, J., & Milo, R. (2022). The unmitigated profile of COVID-19 infectiousness. eLife, 11, e79134. https://doi.org/10.7554/eLife.79134\n\n\nWallinga, J., & Lipsitch, M. (2006). How generation intervals shape the relationship between growth rates and reproductive numbers. Proceedings of the Royal Society B: Biological Sciences, 274(1609), 599–604. https://doi.org/10.1098/rspb.2006.3754",
    "crumbs": [
      "Reproduction number",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Estimating $R_t$</span>"
    ]
  },
  {
    "objectID": "ftc.html",
    "href": "ftc.html",
    "title": "10  Flattening the curve",
    "section": "",
    "text": "10.1 Shock-intervention\nAssuming your intervention will effective immediately reduce the contacts by a constant factor.",
    "crumbs": [
      "Interventions",
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>Flattening the curve</span>"
    ]
  },
  {
    "objectID": "vax.html",
    "href": "vax.html",
    "title": "Vaccination",
    "section": "",
    "text": "Vaccines",
    "crumbs": [
      "Vaccination"
    ]
  },
  {
    "objectID": "vax.html#vaccines",
    "href": "vax.html#vaccines",
    "title": "Vaccination",
    "section": "",
    "text": "Definition\nA vaccine is a biological product that can be used to safely induce an immune response that confers protection against infection and/or disease on subsequent exposure to a pathogen (Pollard & Bijker, 2021).\n\n\nClassification\nOver the past few decades, new vaccine platforms have been developed including viral vectors, nucleic acid-based RNA and DNA vaccines, and virus-like particles. However, traditionally vaccines are classified as live or non-live:\n\nLive:\n\n\nAre developed so that, in an immunocompetent host, they replicate sufficiently to produce a strong immune response, but not so much as to cause significant disease manifestations.\nTrade-off between strong immune response and avoid symptomatic disease, therefore some live attenuated vaccines require multiple doses and induce relatively short-lived immunity. For example, 5% of children will develop a rash and up to 15% fever after measles vaccination\nPotentially replicate in an uncontrolled manner in immuno-compromised individuals.\nExamples: measles, mumps, rubella and rotavirus, oral polio vaccine, the Mycobacterium bovis bacillus Calmette–Guérin (BCG) vaccine for TB and live attenuated influenza vaccine\n\n\nNon-live: no risk to immunocompromised individuals (although may not confer protection in those with B cell or combined immunodeficiency).\n\nB cells\n\nProduce antibodies (humoral immunity).\n\nT cells\n\nDirectly attack infected cells (cellular immunity).\n\n\nKiller (cytotoxic):\nHelper: subtypes by profiles of cytokine production",
    "crumbs": [
      "Vaccination"
    ]
  },
  {
    "objectID": "vax.html#the-effect-of-vaccines",
    "href": "vax.html#the-effect-of-vaccines",
    "title": "Vaccination",
    "section": "The effect of vaccines",
    "text": "The effect of vaccines\n\nDefinition 1 Efficacy is the percentage reduction in the disease rate (or infection risk (Shim & Galvani, 2012)) among vaccinated individuals compared to similar unvaccinated individuals (Verani et al., 2017).\n\n\nDefinition 2 Effectiveness is the percentage reduction in the disease rate (or infection risk (Shim & Galvani, 2012)) among vaccinated individuals compared to unvaccinated individuals, similar to efficacy, but in real-world conditions (Verani et al., 2017).\n\nVaccine effectiveness is categorized into 4 types:\n\nDirect\nIndirect\nTotal\nOverall\n\n\nDefinition 3 Impact quantifies the reduction in disease rate (either percentage decline or absolute change in disease rate) at the population level after vaccine introduction. It is determined by: (1) vaccine effectiveness, (2) vaccine coverage and (3) herd immunity (Verani et al., 2017).\n\nLet \\(R_v\\) be the infection risk in the vaccinated group and \\(R_u\\) be the infection risk in the unvaccinated group.\nThe absolute reduction in infection risk due to vaccination is \\(R_u - R_v\\).\nVaccine efficacy or effectiveness \\(VE\\) is the percentage reduction in infection risk, so we divide the absolute reduction by the infection risk of the unvaccinated group.\n\\[\\begin{align} VE &= \\frac{R_u - R_v}{R_u} \\\\ &= 1 - \\frac{R_v}{R_u} \\\\ &= 1 - \\text{Relative risk} \\end{align}\\]\nLet have an example:\n\n\nIn the control group, the infection risk is \\(\\frac{4}{8}\\) as 4 out of 8 people are infected.\nIn the vaccinated group, the infection risk is \\(\\frac{1}{8}\\) as 1 person is infected among 8 people.\n\n\\[VE = \\frac{\\frac{4}{8} - \\frac{1}{8}}{\\frac{4}{8}} = \\frac{4 - 1}{4} = \\frac{3}{4} = 0.75\\]\nWhile 4 people get infected without vaccination, only 1 would get infected if they were vaccinated. The vaccine can prevent 3 of these infections. So the vaccine efficacy is \\(\\frac{3}{4}\\) or 75%.",
    "crumbs": [
      "Vaccination"
    ]
  },
  {
    "objectID": "vax.html#innate-vs-adaptive-immune-system",
    "href": "vax.html#innate-vs-adaptive-immune-system",
    "title": "Vaccination",
    "section": "Innate vs adaptive immune system",
    "text": "Innate vs adaptive immune system",
    "crumbs": [
      "Vaccination"
    ]
  },
  {
    "objectID": "vax.html#prevent-infection-vs-disease",
    "href": "vax.html#prevent-infection-vs-disease",
    "title": "Vaccination",
    "section": "Prevent infection vs disease",
    "text": "Prevent infection vs disease\nSome evidence showed that BCG vaccine can prevent both infection and disease (Pollard & Bijker, 2021).\n\nInfection: BCG-vaccinated children had a memory T-cell response to infection, as indicated by a positive interferon-\\(\\gamma\\) release assay.\nDisease: BCG vaccination reduces the spread of M. tuberculosis bacteria in the blood, mediated by T-cell immunity.",
    "crumbs": [
      "Vaccination"
    ]
  },
  {
    "objectID": "vax.html#non-specific-effects",
    "href": "vax.html#non-specific-effects",
    "title": "Vaccination",
    "section": "Non-specific effects",
    "text": "Non-specific effects\nMeasles disease casts a prolonged ‘shadow’ over the immune system, with depletion of existing immune memory, such that children who have had the disease have an increased risk of death from other causes over the next few years (Pollard & Bijker, 2021).",
    "crumbs": [
      "Vaccination"
    ]
  },
  {
    "objectID": "vax.html#factors-affecting-vaccine-protection",
    "href": "vax.html#factors-affecting-vaccine-protection",
    "title": "Vaccination",
    "section": "Factors affecting vaccine protection",
    "text": "Factors affecting vaccine protection\n\nMaternal antibody levels\nPrior antigen exposure\nAge of vaccination\nVaccine schedule\nVaccine dose: intradermal vaccination has been shown to be immunogenic at much lower (fractional) doses than intramuscular vaccination for influenza, rabies and HBV vaccines (Pollard & Bijker, 2021).\n\n\n\n\n\nPollard, A. J., & Bijker, E. M. (2021). A guide to vaccinology: from basic principles to new developments. Nature Reviews Immunology, 21(2), 83–100. https://doi.org/10.1038/s41577-020-00479-7\n\n\nShim, E., & Galvani, A. P. (2012). Distinguishing vaccine efficacy and effectiveness. Vaccine, 30(47), 6700–6705. https://doi.org/10.1016/j.vaccine.2012.08.045\n\n\nVerani, J. R., Baqui, A. H., Broome, C. V., Cherian, T., Cohen, C., Farrar, J. L., Feikin, D. R., Groome, M. J., Hajjeh, R. A., Johnson, H. L., Madhi, S. A., Mulholland, K., O’Brien, K. L., Parashar, U. D., Patel, M. M., Rodrigues, L. C., Santosham, M., Scott, J. A., Smith, P. G., … Zell, E. R. (2017). Case-control vaccine effectiveness studies: Preparation, design, and enrollment of cases and controls. Vaccine, 35(25), 3295–3302. https://doi.org/10.1016/j.vaccine.2017.04.037",
    "crumbs": [
      "Vaccination"
    ]
  },
  {
    "objectID": "vep-sm.html",
    "href": "vep-sm.html",
    "title": "11  Screening method",
    "section": "",
    "text": "We have data of all or a random sample of disease cases over a given period in a population, from which we know the proportion vaccinated (\\(PCV\\)) of these cases.\nWe also know the proportion of the population vaccinated (\\(PPV\\)).\n\nThen the vaccine effectiveness (\\(VE\\)) is calculated as:\n\\[\\begin{align} VE &= 1 - \\frac{\\frac{PCV}{1 - PCV}}{\\frac{PPV}{1 - PPV}} = 1 - \\frac{PCV}{1 - PCV} \\times \\frac{1 - PPV}{PPV} \\\\\n&= \\frac{PPV(1 - PCV) - PCV(1 - PPV)}{PPV(1 - PCV)} \\\\\n&= \\frac{PPV - PPV \\times PCV - PCV + PCV \\times PPV}{PPV(1 - PCV)} \\\\\n&= \\frac{PPV - PCV}{PPV(1 - PCV)} \\end{align}\\]\nIn which:\n\n\\(\\frac{PCV}{1 - PCV}\\) is the odd of vaccination in disease cases group.\n\\(\\frac{PPV}{1 - PPV}\\) is the odd of vaccination in the population.\n\\(\\frac{\\frac{PCV}{1 - PCV}}{\\frac{PPV}{1 - PPV}} = \\frac{PCV}{1 - PCV} \\times \\frac{1 - PPV}{PPV}\\) is the odds ratio of vaccination between 2 groups (cases vs population).",
    "crumbs": [
      "Vaccination",
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>Screening method</span>"
    ]
  },
  {
    "objectID": "rp-risk.html",
    "href": "rp-risk.html",
    "title": "12  Risk assessment report",
    "section": "",
    "text": "12.1 Examples\nRisk assessment for measles resurgence in the UK\nRapid risk assessment: Measles in Canada, public health implications in 2024",
    "crumbs": [
      "Reports",
      "<span class='chapter-number'>12</span>  <span class='chapter-title'>Risk assessment report</span>"
    ]
  },
  {
    "objectID": "rp-risk.html#data",
    "href": "rp-risk.html#data",
    "title": "12  Risk assessment report",
    "section": "12.2 Data",
    "text": "12.2 Data\n\nHistorical case notification of past outbreaks 2014 and 2019 Date of onset + date of birth (or age)\nCurrent level of susceptibility in HCMC:\n\n\nSerology\nVaccine registry\nBirth rates\n\n\nConnectivity between Phu Quoc and HCMC: Flight data / boat data?\n\nP = 1 – (1 / (R0 * s))^m",
    "crumbs": [
      "Reports",
      "<span class='chapter-number'>12</span>  <span class='chapter-title'>Risk assessment report</span>"
    ]
  },
  {
    "objectID": "references.html",
    "href": "references.html",
    "title": "References",
    "section": "",
    "text": "Becker, A. D., & Grenfell, B. T. (2017). tsiR: An R package for\ntime-series Susceptible-Infected-Recovered models of epidemics. PLOS\nONE, 12(9), e0185528. https://doi.org/10.1371/journal.pone.0185528\n\n\nBettencourt, L. M. A., & Ribeiro, R. M. (2008). Real Time Bayesian\nEstimation of the Epidemic Potential of Emerging Infectious Diseases.\nPLOS ONE, 3(5), e2185. https://doi.org/10.1371/journal.pone.0002185\n\n\nBradshaw, W. J., Alley, E. C., Huggins, J. H., Lloyd, A. L., &\nEsvelt, K. M. (2021). Bidirectional contact tracing could dramatically\nimprove COVID-19 control. Nature Communications,\n12(1), 232. https://doi.org/10.1038/s41467-020-20325-7\n\n\nBreban, R., Vardavas, R., & Blower, S. (2007). Theory versus Data:\nHow to Calculate R0? PLOS ONE, 2(3), e282. https://doi.org/10.1371/journal.pone.0000282\n\n\nCauchemez, S., Bhattarai, A., Marchbanks, T. L., Fagan, R. P., Ostroff,\nS., Ferguson, N. M., Swerdlow, D., Pennsylvania H1N1 working group, the,\nSodha, S. V., Moll, M. E., Angulo, F. J., Palekar, R., Archer, W. R.,\n& Finelli, L. (2011). Role of social networks in shaping disease\ntransmission during a community outbreak of 2009 H1N1 pandemic\ninfluenza. Proceedings of the National Academy of Sciences,\n108(7), 2825–2830. https://doi.org/10.1073/pnas.1008895108\n\n\nChitnis, N. (2017). Introduction to SEIR Models.\n\n\nChristley, R. M., Mort, M., Wynne, B., Wastling, J. M., Heathwaite, A.\nL., Pickup, R., Austin, Z., & Latham, S. M. (2013).\n“Wrong, but Useful”: Negotiating Uncertainty\nin Infectious Disease Modelling. PLOS ONE, 8(10),\ne76277. https://doi.org/10.1371/journal.pone.0076277\n\n\nCori, A., Ferguson, N. M., Fraser, C., & Cauchemez, S. (2013). A new\nframework and software to estimate time-varying reproduction numbers\nduring epidemics. American Journal of Epidemiology,\n178(9), 1505–1512. https://doi.org/10.1093/aje/kwt133\n\n\nDelamater, P. L., Street, E. J., Leslie, T. F., Yang, Y. T., &\nJacobsen, K. H. (2019). Complexity of the basic reproduction number\n(R0) - volume 25, number 1january 2019 - emerging\ninfectious diseases journal - CDC. https://doi.org/10.3201/eid2501.171901\n\n\nDiekmann, O., Heesterbeek, J. A. P., & Metz, J. A. J. (1990). On the\ndefinition and the computation of the basic reproduction ratio R0 in\nmodels for infectious diseases in heterogeneous populations. Journal\nof Mathematical Biology, 28(4), 365–382. https://doi.org/10.1007/BF00178324\n\n\nDriessche, P. van den. (2017). Reproduction numbers of infectious\ndisease models. Infectious Disease Modelling, 2(3),\n288–303. https://doi.org/10.1016/j.idm.2017.06.002\n\n\nDriessche, P. van den, & Watmough, J. (2002). Reproduction numbers\nand sub-threshold endemic equilibria for compartmental models of disease\ntransmission. Mathematical Biosciences, 180(1), 29–48.\nhttps://doi.org/10.1016/S0025-5564(02)00108-6\n\n\nDu, Z., Zhang, W., Zhang, D., Yu, S., & Hao, Y. (2017). Estimating\nthe basic reproduction rate of HFMD using the time series SIR model in\nGuangdong, China. PLOS ONE, 12(7), e0179623. https://doi.org/10.1371/journal.pone.0179623\n\n\nFinkenstädt, B. F., & Grenfell, B. T. (2000). Time series modelling\nof childhood diseases: A dynamical systems approach. Journal of the\nRoyal Statistical Society Series C: Applied Statistics,\n49(2), 187–205. https://doi.org/10.1111/1467-9876.00187\n\n\nGostic, K. M., McGough, L., Baskerville, E. B., Abbott, S., Joshi, K.,\nTedijanto, C., Kahn, R., Niehus, R., Hay, J. A., Salazar, P. M. D.,\nHellewell, J., Meakin, S., Munday, J. D., Bosse, N. I., Sherrat, K.,\nThompson, R. N., White, L. F., Huisman, J. S., Scire, J., … Cobey, S.\n(2020). Practical considerations for measuring the effective\nreproductive number, Rt. PLOS Computational Biology,\n16(12), e1008409. https://doi.org/10.1371/journal.pcbi.1008409\n\n\nGreen, W. D., Ferguson, N. M., & Cori, A. (2022). Inferring the\nreproduction number using the renewal equation in heterogeneous\nepidemics. Journal of The Royal Society Interface,\n19(188), 20210429. https://doi.org/10.1098/rsif.2021.0429\n\n\nJones, J. H. (2007). Notes on R0. California: Department of\nAnthropological Sciences, 323, 1–19.\n\n\nKeeling, M. J. (2006). State-of-science review: Predictive and\nreal-time epidemiological modelling. S9. DTI.\n\n\nKeeling, M. J., & Rohani, P. (2011). Modeling Infectious\nDiseases in Humans and Animals. Princeton University Press. https://doi.org/10.1515/9781400841035\n\n\nKenah, E., Lipsitch, M., & Robins, J. M. (2008). Generation interval\ncontraction and epidemic data analysis. Mathematical\nBiosciences, 213(1), 71–79. https://doi.org/10.1016/j.mbs.2008.02.007\n\n\nKnight, J., & Mishra, S. (2020). Estimating effective reproduction\nnumber using generation time versus serial interval, with application to\ncovid-19 in the greater toronto area, canada. Infectious Disease\nModelling, 5, 889–896. https://doi.org/10.1016/j.idm.2020.10.009\n\n\nPandit, J. J. (2020). Managing the R0 of COVID-19: mathematics fights\nback. Anaesthesia, 75(12), 1643–1647. https://doi.org/10.1111/anae.15151\n\n\nPollard, A. J., & Bijker, E. M. (2021). A guide to vaccinology: from\nbasic principles to new developments. Nature Reviews\nImmunology, 21(2), 83–100. https://doi.org/10.1038/s41577-020-00479-7\n\n\nRui, J., Li, K., Wei, H., Guo, X., Zhao, Z., Wang, Y., Song, W.,\nAbudunaibi, B., & Chen, T. (2024). MODELS: A six-step framework for\ndeveloping an infectious disease model. Infectious Diseases of\nPoverty, 13(1), 30. https://doi.org/10.1186/s40249-024-01195-3\n\n\nSender, R., Bar-On, Y., Park, S. W., Noor, E., Dushoff, J., & Milo,\nR. (2022). The unmitigated profile of COVID-19 infectiousness.\neLife, 11, e79134. https://doi.org/10.7554/eLife.79134\n\n\nShim, E., & Galvani, A. P. (2012). Distinguishing vaccine efficacy\nand effectiveness. Vaccine, 30(47), 6700–6705. https://doi.org/10.1016/j.vaccine.2012.08.045\n\n\nVegvari, C., Abbott, S., Ball, F., Brooks-Pollock, E., Challen, R.,\nCollyer, B. S., Dangerfield, C., Gog, J. R., Gostic, K. M., Heffernan,\nJ. M., Hollingsworth, T. D., Isham, V., Kenah, E., Mollison, D.,\nPanovska-Griffiths, J., Pellis, L., Roberts, M. G., Scalia Tomba, G.,\nThompson, R. N., & Trapman, P. (2022). Commentary on the use of the\nreproduction number R during the COVID-19 pandemic. Statistical\nMethods in Medical Research, 31(9), 1675–1685. https://doi.org/10.1177/09622802211037079\n\n\nVerani, J. R., Baqui, A. H., Broome, C. V., Cherian, T., Cohen, C.,\nFarrar, J. L., Feikin, D. R., Groome, M. J., Hajjeh, R. A., Johnson, H.\nL., Madhi, S. A., Mulholland, K., O’Brien, K. L., Parashar, U. D.,\nPatel, M. M., Rodrigues, L. C., Santosham, M., Scott, J. A., Smith, P.\nG., … Zell, E. R. (2017). Case-control vaccine effectiveness studies:\nPreparation, design, and enrollment of cases and controls.\nVaccine, 35(25), 3295–3302. https://doi.org/10.1016/j.vaccine.2017.04.037\n\n\nVynnycky, E., & White, R. (2010). An Introduction to Infectious\nDisease Modelling. OUP Oxford.\n\n\nWallinga, J., & Lipsitch, M. (2006). How generation intervals shape\nthe relationship between growth rates and reproductive numbers.\nProceedings of the Royal Society B: Biological Sciences,\n274(1609), 599–604. https://doi.org/10.1098/rspb.2006.3754\n\n\nWallinga, J., & Teunis, P. (2004). Different epidemic curves for\nsevere acute respiratory syndrome reveal similar impacts of control\nmeasures. American Journal of Epidemiology, 160(6),\n509–516. https://doi.org/10.1093/aje/kwh255",
    "crumbs": [
      "References"
    ]
  },
  {
    "objectID": "dict.html",
    "href": "dict.html",
    "title": "Appendix A — Dictionary",
    "section": "",
    "text": "Definition A.1 Closed-form solution (or closed form expression) is any formula that can be evaluated in a finite number of standard operations (source).\n\ninfection fatality ratio (IFR) and case fatality ratio (CFR) and serology data.\n\nDefinition A.2 Residual: is the difference between the observed value and the estimated value.\n\n\nDefinition A.3 Error: is the deviation of the observed value from the true value.\n\nMatrix and linear transformation:\n\nLinear transformation is a function (transformation = function) that take in a vector and spit out a vector.\nLines remain lines, and origin remains fixed.\n\n\n\n\n\n\n\nVisualisation of linear transformation\n\n\n\n\n\n\n\n\n\nEigenvector (\\(\\vec{v}\\)):\nEigenvalue (\\(\\lambda\\)):\n\nDefinition A.4 Inverse matrix:\n\\[\\begin{bmatrix} a & b \\\\ c & d \\end{bmatrix}^{-1} = \\frac{1}{ad - bc} \\begin{bmatrix} d & -b \\\\ -c & a \\end{bmatrix}\\]",
    "crumbs": [
      "Appendices",
      "<span class='chapter-number'>A</span>  <span class='chapter-title'>Dictionary</span>"
    ]
  },
  {
    "objectID": "func.html",
    "href": "func.html",
    "title": "Appendix B — Useful functions",
    "section": "",
    "text": "B.1 approxfun()",
    "crumbs": [
      "Appendices",
      "<span class='chapter-number'>B</span>  <span class='chapter-title'>Useful functions</span>"
    ]
  }
]