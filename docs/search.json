[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Infectious disease modelling for babies",
    "section": "",
    "text": "Preface\nThis book brings together everything I have learned about infectious disease modelling during my PhD journey. Special thanks to my idol, Dr. James Hay, who once gave these genius advice:\n\n“Read and learn now - it will be harder later on.”\n“Spent a lot of time writing well-documented, generalisable code that didn’t necessarily turn into publications at the time. I now use that code all of the time.”\nDr. James Hay’s inspiring talk at the MIDSEA ECR April 2024 Meeting.\n\nThese words encouraged me to read and learn more, and to ensure every detail was carefully documented. In this book, you (and my future self) will find:\n\nA dictionary of jargon with cited definitions.\nMethodologies for mathematical models of infectious diseases.\nStep-by-step guides for writing infectious disease reports, following the Center for Disease Control and Prevention report format: data, workflow, analyses, and inference.\n\nIf you enjoyed this book or found any mistakes, please leave a comment below. Your feedback means a lot!",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "mod.html",
    "href": "mod.html",
    "title": "1  Infectious disease modelling",
    "section": "",
    "text": "1.1 Modelling\nA model is a simplified representation of a complex phenomenon (Vynnycky & White, 2010).\nWe all use models in our daily lives, often without realizing it. Imagine a colleague asks, “How long will it take to get to the restaurant?”. There are different ways you might answer this question, each reflecting a different “model” in your head:\nModels help us navigate and make decisions about complex situations by focusing on the most relevant factors and ignoring the less critical details.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Infectious disease modelling</span>"
    ]
  },
  {
    "objectID": "mod.html#modelling",
    "href": "mod.html#modelling",
    "title": "1  Infectious disease modelling",
    "section": "",
    "text": "The Bull, by Pablo Picasso (source).\n\n\n\n\nExperience-based model: You might think, “Last week it took me 20 minutes to get to this restaurant”. This model simplifies by assuming past experiences are a reliable predictor of future outcomes, ignoring daily variations like traffic or weather.\nDistance and speed model: You might think, “The restaurant is 15 kilometers away, and I drive at 45 km/h, so it should take about 20 minutes”. This model uses the formula \\(\\text{time} = \\frac{\\text{distance}}{\\text{speed}}\\). It simplifies by assuming a constant speed, and not accounting for real-world complexities like traffic lights or congestion.\n\n\n\n\n\n\nVynnycky, E., & White, R. (2010). An Introduction to Infectious Disease Modelling. OUP Oxford.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Infectious disease modelling</span>"
    ]
  },
  {
    "objectID": "rnum.html",
    "href": "rnum.html",
    "title": "Reproduction number",
    "section": "",
    "text": "Basic reproduction number \\(R_0\\)",
    "crumbs": [
      "Reproduction number"
    ]
  },
  {
    "objectID": "rnum.html#basic-reproduction-number-r_0",
    "href": "rnum.html#basic-reproduction-number-r_0",
    "title": "Reproduction number",
    "section": "",
    "text": "Definition 1 \\(R_0\\) (pronounced /R naught/) is the average number of secondary cases generated by an average infected person throughout their infectious period in a fully susceptible population (Anderson et al., 2020). In short, \\(R_0\\) is the \\(R\\) in a fully susceptible population, the maximum \\(R\\) in a population.",
    "crumbs": [
      "Reproduction number"
    ]
  },
  {
    "objectID": "rnum.html#effective-reproduction-number-r_e",
    "href": "rnum.html#effective-reproduction-number-r_e",
    "title": "Reproduction number",
    "section": "Effective reproduction number \\(R_e\\)",
    "text": "Effective reproduction number \\(R_e\\)\n\nDefinition 2 \\(R_e\\) is the average number of secondary cases generated by an average infected person throughout their infectious period in a population where not all individuals are susceptible.\n\nLet \\(s\\) be the proportion of the population that is susceptible.\n\\[R_e = s \\times R_0\\]",
    "crumbs": [
      "Reproduction number"
    ]
  },
  {
    "objectID": "rnum.html#effective-reproduction-number-at-time-t-r_t",
    "href": "rnum.html#effective-reproduction-number-at-time-t-r_t",
    "title": "Reproduction number",
    "section": "Effective reproduction number at time \\(t\\) \\(R_t\\)",
    "text": "Effective reproduction number at time \\(t\\) \\(R_t\\)\n\nDefinition 3 \\(R_e(t)\\) (Knight & Mishra, 2020) or \\(R_t\\) is the average number of secondary cases generated by one infected person at time \\(t\\) during the outbreak.\n\nA public health control strategy will end an outbreak if it can keep \\(R_t\\) below 1. The level of immunity at which \\(R_t = 1\\) is the herd immunity threshold (Vegvari et al., 2022).\n\n\n\n\n\n\n\n\n\nAt the beginning of an outbreak, we can estimate \\(R_0\\) when the whole population is fully susceptible. As the outbreak progresses, the number of susceptible individuals decreases, leading to a decline in \\(R_0\\). This adjusted value is referred to as \\(R_t\\) (if we want to measure at each time \\(t\\)). At the peak of the epidemic curve, \\(R_t = 1\\). After this peak, \\(R_t\\) continues to decrease, resulting in a decline in the number of new cases and the epidemic curve going down.\n\\(R_t\\) can be defined in 2 ways: as the instantaneous reproduction number or as the case reproduction number (Gostic et al., 2020).\n\nInstantaneous reproduction number \\(R_t^i\\)\n\n\nFigure illustrates the Cori method (Gostic et al., 2020).\n\nMeasures transmission at a specific point in time (Gostic et al., 2020). The instantaneous reproduction number quantifies the number of new infections at a single point in time \\(t_i\\) (blue arrow), using the number of infections in the previous generation (green arrows) and their current infectiousness (green curve) (Gostic et al., 2020). The analyses can be done near real-time.\nMethods to estimate instantaneous reproduction number includes Cori and colleagues (Cori et al., 2013) (the best for near real-time estimation (Gostic et al., 2020)), and Bettencourt and Ribeiro (Bettencourt & Ribeiro, 2008) (use with caution because they implicitly assume the generation interval follows an exponential distribution, as in SIR model, which does not include alatent period).\n\n\nCase reproduction number \\(R_t^c\\)\n\n\nFigure illustrates the Wallinga and Teunis method (Gostic et al., 2020).\n\nMeasures transmission by a specific cohort of individuals (Gostic et al., 2020). A cohort is a group of individuals with the same date of infection or the same date of symptom onset. The case reproduction number is the average number of new infections that an individual who becomes infected on day \\(t_i\\) (green arrows in B) or symptomatic on day \\(t_s\\) (yellow arrows in C) will eventually go on to cause (blue downward arrows in B and C). It is a more natural choice for analyses that consider heterogeneity among individuals (Gostic et al., 2020).\nMethods to estimate instantaneous reproduction number includes Wallinga and Teunis method (Wallinga & Teunis, 2004).",
    "crumbs": [
      "Reproduction number"
    ]
  },
  {
    "objectID": "rnum.html#growth-rate-r-and-reproduction-number-r",
    "href": "rnum.html#growth-rate-r-and-reproduction-number-r",
    "title": "Reproduction number",
    "section": "Growth rate \\(r\\) and reproduction number \\(R\\)",
    "text": "Growth rate \\(r\\) and reproduction number \\(R\\)\nGrowth rate \\(r\\) and reproduction number \\(R\\) are basically the same. \\(r\\) is used in continuous time and \\(R\\) is used in discrete time.\n\nGrowth rate \\(r\\)\nThe rate at which new cases are arising (Anderson et al., 2020). It can be a positive number (new infections is increasing) or a negative number (new infections is decreasing).\nThe number of new infections at an increasing or decreasing exponential rate. It is dependent on the reproduction number and timescale between infections.\n\\[\\frac{d_\\text{newCases}}{dt}\\]\n\n\n\n\nAnderson, R., Donnelly, C., Hollingsworth, D., Keeling, M., Vegvari, C., Baggaley, R., & Maddren, R. (2020). Reproduction number (R) and growth rate (r) of the COVID-19 epidemic in the UK. The Royal Society.\n\n\nBettencourt, L. M. A., & Ribeiro, R. M. (2008). Real Time Bayesian Estimation of the Epidemic Potential of Emerging Infectious Diseases. PLOS ONE, 3(5), e2185. https://doi.org/10.1371/journal.pone.0002185\n\n\nCori, A., Ferguson, N. M., Fraser, C., & Cauchemez, S. (2013). A new framework and software to estimate time-varying reproduction numbers during epidemics. American Journal of Epidemiology, 178(9), 1505–1512. https://doi.org/10.1093/aje/kwt133\n\n\nGostic, K. M., McGough, L., Baskerville, E. B., Abbott, S., Joshi, K., Tedijanto, C., Kahn, R., Niehus, R., Hay, J. A., Salazar, P. M. D., Hellewell, J., Meakin, S., Munday, J. D., Bosse, N. I., Sherrat, K., Thompson, R. N., White, L. F., Huisman, J. S., Scire, J., … Cobey, S. (2020). Practical considerations for measuring the effective reproductive number, Rt. PLOS Computational Biology, 16(12), e1008409. https://doi.org/10.1371/journal.pcbi.1008409\n\n\nKnight, J., & Mishra, S. (2020). Estimating effective reproduction number using generation time versus serial interval, with application to covid-19 in the greater toronto area, canada. Infectious Disease Modelling, 5, 889–896. https://doi.org/10.1016/j.idm.2020.10.009\n\n\nVegvari, C., Abbott, S., Ball, F., Brooks-Pollock, E., Challen, R., Collyer, B. S., Dangerfield, C., Gog, J. R., Gostic, K. M., Heffernan, J. M., Hollingsworth, T. D., Isham, V., Kenah, E., Mollison, D., Panovska-Griffiths, J., Pellis, L., Roberts, M. G., Scalia Tomba, G., Thompson, R. N., & Trapman, P. (2022). Commentary on the use of the reproduction number R during the COVID-19 pandemic. Statistical Methods in Medical Research, 31(9), 1675–1685. https://doi.org/10.1177/09622802211037079\n\n\nWallinga, J., & Teunis, P. (2004). Different epidemic curves for severe acute respiratory syndrome reveal similar impacts of control measures. American Journal of Epidemiology, 160(6), 509–516. https://doi.org/10.1093/aje/kwh255",
    "crumbs": [
      "Reproduction number"
    ]
  },
  {
    "objectID": "rt.html",
    "href": "rt.html",
    "title": "3  Estimating \\(R_t\\)",
    "section": "",
    "text": "3.1 Methods\n\\(R_t\\) can be defined in 2 ways: as the instantaneous reproduction number (see Section 3.1) or as the case reproduction number (see Section 3.2).",
    "crumbs": [
      "Reproduction number",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Estimating $R_t$</span>"
    ]
  },
  {
    "objectID": "rt.html#methods",
    "href": "rt.html#methods",
    "title": "3  Estimating \\(R_t\\)",
    "section": "",
    "text": "3.1.1 Instantaneous reproduction number \\(R_t^i\\)\n\nDefinition 3.1 The instantaneous reproduction number is the expected number of secondary infections occurring at time \\(t\\), divided by the number of infected individuals, each scaled by their relative infectiousness at time \\(t\\) (an individual’s relative infectiousness is based on the generation interval and time since infection) (Gostic et al., 2020).\n\n\n3.1.1.1 Exact calculation\nFor a compartmental model (SIR or SEIR), \\(R_t^i\\) can be calculated exactly as (Gostic et al., 2020):\n\\[R_t^i = \\beta(t) S(t) D\\]\n\n\\(\\beta(t)\\): the time-varying transmission rate.\n\\(S(t)\\): the fraction of the population that is susceptible.\n\\(D\\): the mean duration of infectiousness.\n\n\n\n3.1.1.2 Cori method\n\\[R_t^i = \\frac{I_t}{\\sum_{s = 1}^{t} I_{t - s} w_s}\\]\n\n\\(I_t\\): the number of infection on day \\(t\\).\n\\(I_{t - s}\\): the number of individuals who became infected \\(s\\) days in the past.\n\\(w_s\\): the infectivity profile, describes how infectious an individual is \\(s\\) days since infection, \\(w_s\\) dependent on time since infection \\(s\\) but independent of calendar time \\(t\\), and often be approximated by the generation interval (Cori et al., 2013).\n\\(I_{t - s} w_s\\): we scale the number of individuals who became infected \\(s\\) days in the past by how infectiousness are they still on day \\(t\\) (which is \\(s\\) days after the date they got infected, \\(w_s\\)).\n\nLooking back at Definition 3.1, \\(R_t^i\\) is the expected number of secondary infections occurring at time \\(t\\) (\\(I_t\\)), divided by the number of infected individuals (\\(\\sum_{s = 1}^{t} I_{t - s}\\)), each scaled by their relative infectiousness at time \\(t\\) (\\(w_s\\)).\nThe only parametric assumption required by this method is the form of the generation interval. The standard assumption is that \\(w_s\\) follows a discretized gamma distribution, but any parametric or empirical discrete distribution also work (Gostic et al., 2020).\n\n\n3.1.1.3 When can we start estimating \\(R_t^i\\)?\nCori et al. suggest starting estimating \\(R_t^i\\) once those three criteria are fulfilled (Cori et al., 2013):\n\nAt least after the sliding window size.\nAt least after one mean serial interval.\nAt least 12 cases have been observed since the beginning of the epidemic: because to get a posterior credible interval of 0.3, the time window considered must comprise at least 11 incident cases.\n\n\n\n3.1.1.4 Key considerations\nSource: Dr. Anne Cori’s webinar.\n\nTemporal resolution: we can’t apply the \\(R_t^i\\) method when the time step of observation is too large (&gt; mean generation interval).\nSpatial resolution: ideally use a spatial scale that you can distinguish locally infected cases from imported cases.\n\\(R_t^i\\) is very sensitive to the size of the sliding window: small windows can lead to highly variable estimates with wide credible intervals, whereas longer windows lead to smoothed estimates with narrower credible intervals. Perhaps also consider at least 11 incident cases in a sliding window to get a posterior credible interval of 0.3 (Cori et al., 2013).\n\n\n\n\n\n3.1.2 Case reproduction number \\(R_t^c\\)\n\nDefinition 3.2 The case or cohort reproduction number is the expected number of secondary infections that an individual who becomes infected at time \\(t\\) will eventually cause as they progress through their infection.\n\n\n3.1.2.1 Exact calculation\n\\[R_t^c = \\int_{u = t}^{\\infty} R_u^i w_{u-t} du\\]\n\n\\(R_u^i\\): the instantaneous reproduction number of current infected cases at time \\(u\\), starting from \\(t\\) to the end of their infectious period \\(\\infty\\).\n\\(w_{u-t}\\): the infectiousness of them at that time.\n\n\n\n3.1.2.2 Wallinga and Teunis method\nThere are 3 steps (Gostic et al., 2020):\nStep 1. Estimate the likelihood that case \\(j\\) (infected at time \\(t_j\\)) infected case \\(i\\) (at time \\(t_i\\)).\n\\[p_{ij} = \\frac{w_{t_i - t_j}}{\\sum_{i \\neq k} w_{t_i - t_k}}\\]\n\n\\(\\sum_{i \\neq k} w_{t_i - t_k}\\): sum of the infectiousness of all cases (other than \\(i\\)) infects case \\(i\\).\n\nStep 2. Compute the individual reproduction number of case \\(j\\).\n\\[R_j = \\sum_i p_{ij}\\]\nStep 3. Compute the case reproduction number at time \\(t\\), it is the expected value of \\(R_j\\) for all individuals infected at time \\(t\\).\n\\[R_t^c = \\mathbb{E}(R_j)\\]",
    "crumbs": [
      "Reproduction number",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Estimating $R_t$</span>"
    ]
  },
  {
    "objectID": "rt.html#proofs",
    "href": "rt.html#proofs",
    "title": "3  Estimating \\(R_t\\)",
    "section": "3.2 Proofs",
    "text": "3.2 Proofs\nThe renewal equation is a cornerstone of demographic theory and backbone of the \\(R_t\\) estimators.\n\\[b(t) = \\int_{a = 0}^{\\infty} b(t - a) n(a) da\\]\n\n\\(b(t)\\): the number of births at time \\(t\\).\n\\(b(t - a)\\): the number of birth at time \\(t - a\\), or the number of people of age \\(a\\) at time \\(t\\).\n\\(n(a)\\): the birth ability of people of age \\(a\\), scaled by the probability of surviving to age \\(a\\).\n\nTo describe epidemic dynamics, the renewal equation is expressed in terms of \\(I(t)\\).\n\\[I(t) = R_0 S(t) \\int_{s = 0}^{\\infty} I(t - s) w_s ds\\]\n\n\\(R_0 S(t) = R_t\\): see Definition 3.\n\\(I(t - s)\\): the number of individuals who became infected \\(s\\) time points ago in the past.\n\\(w_s\\): the infectivity profile, or the probability of how infectiousness are they still at time \\(t\\) (which is \\(s\\) time points after the date they got infected),\n\\(I(t - s) w_s\\): we scale the number of individuals who in the past by how infectiousness are they still at time \\(t\\).\n\nNow we transform the equation a bit, and we got something very similar to the Cori method (see Section 3.1.1.2).\n\\[R_t = \\frac{I(t)}{\\int_{s = 0}^{\\infty} I(t - s) w_s ds}\\]",
    "crumbs": [
      "Reproduction number",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Estimating $R_t$</span>"
    ]
  },
  {
    "objectID": "rt.html#compare-r_ti-and-r_tc",
    "href": "rt.html#compare-r_ti-and-r_tc",
    "title": "3  Estimating \\(R_t\\)",
    "section": "3.3 Compare \\(R_t^i\\) and \\(R_t^c\\)",
    "text": "3.3 Compare \\(R_t^i\\) and \\(R_t^c\\)\nThere are several important differences (Gostic et al., 2020):\n\nInstantaneous \\(R_t^i\\) is real-time estimation and only use data from before time \\(t\\), while case \\(R_t^c\\) is inherently forward-looking.\n\n\nInstantaneous \\(R_t^i\\) overestimates \\(R_t\\) early in the time series, because any infections that occurred before the first observed date are missing terms in the denominator (the \\(I_{t - s}\\) in Section 3.1.1.2, data is left-truncated at the beginning).\nCase \\(R_t^c\\) underestimates \\(R_t\\) at the end of the time series, because it relies on time points not yet observed which become missing terms in the production (data is right-truncated at the end).\n\n\nCase \\(R_t^c\\) is shifted forward in time relative to instantaneous \\(R_t^i\\), produces leading estimates of \\(R_t\\) because it uses data from time points after \\(t\\), whereas the \\(R_t^i\\) uses data from time points before \\(t\\).\n\n\n\n\n\n\n\nImportant\n\n\n\nOverall, for real-time analyses aiming to infer the impact of changes in policy, behavior, or other extrinsic factors on transmission, the instantaneous reproductive number will provide more temporally accurate estimates and is most appropriate.",
    "crumbs": [
      "Reproduction number",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Estimating $R_t$</span>"
    ]
  },
  {
    "objectID": "rt.html#potential-biases",
    "href": "rt.html#potential-biases",
    "title": "3  Estimating \\(R_t\\)",
    "section": "3.4 Potential biases",
    "text": "3.4 Potential biases\n\\(R_t\\) is a value in specific time, therefore there are 2 potential forms of bias in \\(R_t\\) estimates (Gostic et al., 2020):\n\nAccuracy (the value): Systematic over- or underestimation caused by misspecification of the generation interval. Mostly impact when \\(R_t\\) is substantially &gt; 1 (e.g., the beginning of COVID-19 when \\(R_t\\) is relatively high) or &lt; 1 (e.g., after a very effective intervention then \\(R_t\\) might be low).\nTimeliness (the time): Temporal inaccuracy that \\(R_t\\) estimates may be leading or lagging the true date, has several possible causes and can be difficult to avoid.\n\n\n\nFigure from Sender et al. (Sender et al., 2022).\n\n\n3.4.1 Generation interval\n\nDefinition 3.3 Generation interval is the time from the infection of a primary case to infection of the cases he/she generates (Cori et al., 2013).\n\nIf we match this to an SEIR model, the generation interval starts when the infector enters the E compartment (meaning they got infected). The latest time they can infect an infectee is at the end of their residence in the I compartment (they are infectious). Therefore, generation interval is the sum of residence times in compartments E and I (Gostic et al., 2020).\nThe mean generation interval decreases when susceptible persons are at risk of infectious contact from multiple sources. Because when a susceptible person has multiple potential infectors, there is a “race” to infect him/her in which only the first infectious contact leads to infection (Kenah et al., 2008).\n\n\n3.4.2 Serial interval\n\nDefinition 3.4 Serial interval is the time between symptom onset in an infector–infectee pair (Gostic et al., 2020).\n\nThe distributions of the serial interval and the generation interval are identical in these scenarios (Cori et al., 2013):\n\nFor diseases such as influenza, SARS, measles, and smallpox, it is expected that infectiousness starts only around the time of symptom onset.\nWhen the infectiousness profile after symptoms is independent of the incubation period.",
    "crumbs": [
      "Reproduction number",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Estimating $R_t$</span>"
    ]
  },
  {
    "objectID": "rt.html#code",
    "href": "rt.html#code",
    "title": "3  Estimating \\(R_t\\)",
    "section": "3.5 Code",
    "text": "3.5 Code\n\n3.5.1 EpiNow2\n\n\n\n\nCori, A., Ferguson, N. M., Fraser, C., & Cauchemez, S. (2013). A new framework and software to estimate time-varying reproduction numbers during epidemics. American Journal of Epidemiology, 178(9), 1505–1512. https://doi.org/10.1093/aje/kwt133\n\n\nGostic, K. M., McGough, L., Baskerville, E. B., Abbott, S., Joshi, K., Tedijanto, C., Kahn, R., Niehus, R., Hay, J. A., Salazar, P. M. D., Hellewell, J., Meakin, S., Munday, J. D., Bosse, N. I., Sherrat, K., Thompson, R. N., White, L. F., Huisman, J. S., Scire, J., … Cobey, S. (2020). Practical considerations for measuring the effective reproductive number, Rt. PLOS Computational Biology, 16(12), e1008409. https://doi.org/10.1371/journal.pcbi.1008409\n\n\nKenah, E., Lipsitch, M., & Robins, J. M. (2008). Generation interval contraction and epidemic data analysis. Mathematical Biosciences, 213(1), 71–79. https://doi.org/10.1016/j.mbs.2008.02.007\n\n\nSender, R., Bar-On, Y., Park, S. W., Noor, E., Dushoff, J., & Milo, R. (2022). The unmitigated profile of COVID-19 infectiousness. eLife, 11, e79134. https://doi.org/10.7554/eLife.79134",
    "crumbs": [
      "Reproduction number",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Estimating $R_t$</span>"
    ]
  },
  {
    "objectID": "sir-det.html",
    "href": "sir-det.html",
    "title": "4  SIR",
    "section": "",
    "text": "4.1 Assumptions",
    "crumbs": [
      "Deterministic models",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>SIR</span>"
    ]
  },
  {
    "objectID": "sir-det.html#assumptions",
    "href": "sir-det.html#assumptions",
    "title": "4  SIR",
    "section": "",
    "text": "Well-mixed population, or homogeneous mixing (a single contact rate \\(\\beta\\)).\nThe most basic form balances demographic processes (births \\(B\\) and deaths \\(\\mu\\)).\nInfectious disease properties are for a single pathogen.",
    "crumbs": [
      "Deterministic models",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>SIR</span>"
    ]
  },
  {
    "objectID": "sir-det.html#model",
    "href": "sir-det.html#model",
    "title": "4  SIR",
    "section": "4.2 Model",
    "text": "4.2 Model\nForce of infection \\(\\lambda = \\frac{\\beta I}{N}\\)\n\\[\\frac{dS}{dt} = -\\lambda S\\]\n\\[\\frac{dI}{dt} = \\lambda S - \\gamma I\\]\n\\[\\frac{dR}{dt} = \\gamma I\\]",
    "crumbs": [
      "Deterministic models",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>SIR</span>"
    ]
  },
  {
    "objectID": "sir-det.html#code",
    "href": "sir-det.html#code",
    "title": "4  SIR",
    "section": "4.3 Code",
    "text": "4.3 Code\n\n4.3.1 Model\n\n# sir_1() returns a data frame consists S, I, R values by time\nsir_1 &lt;- function(beta, gamma, S0, I0, R0, times) {\n  \n  sir_equations &lt;- function(time, variables, parameters) {\n    with(as.list(c(variables, parameters)), {\n      dS &lt;- -beta * I * S\n      dI &lt;-  beta * I * S - gamma * I\n      dR &lt;-  gamma * I\n      return(list(c(dS, dI, dR)))\n    })\n  }\n  \n  parameters_values &lt;- c(beta = beta, gamma = gamma)\n  initial_values &lt;- c(S = S0, I = I0, R = R0)\n  \n  out &lt;- ode(initial_values, times, sir_equations, parameters_values)\n\n  as.data.frame(out)\n}\n\nLoad the flu data.\n\nflu &lt;- readRDS(\"data/flu.rds\")\n\nLet have a look at this flu data. This is a very special data as it reports the flu prevalence. Usually, case notification data reports incidence.\n\n\n\n\n\n\nImportant\n\n\n\nRemember to fit the correct thing in SIR model to case notification data:\n\nPrevalence: fit to the I compartment.\nIncidence: fit only to the \\(\\lambda S\\).\n\n\n\n\nhead(flu)\n\n\n\n\n\ntime\nprev\n\n\n\n\n0\n1\n\n\n1\n6\n\n\n2\n26\n\n\n3\n73\n\n\n4\n222\n\n\n5\n293\n\n\n\n\n\n\nNow we run the SIR model, and compare predictions with the observed flu prevalence data.\n\npred &lt;- sir_1(beta = 0.004, gamma = 0.5, S0 = 999, I0 = 1, R0 = 0, times = flu$time)\n\ndf &lt;- merge(x = pred, y = flu, by = \"time\")\ndf &lt;- df[,c(\"time\", \"I\", \"prev\")]\n\nBetter off seeing the comparison on a plot.\n\n\nCode\ndf_plot &lt;- pivot_longer(df, cols = all_of(c(\"I\", \"prev\")), names_to = \"comp\", values_to = \"n\")\ndf_plot$comp &lt;- factor(df_plot$comp, levels = c(\"prev\", \"I\"))\n\nggplot(df_plot, aes(x = time, y = n, color = comp)) +\n  geom_point() + geom_line() +\n  scale_color_hue(labels = c(\"Prevalence\", \"Prediction\")) +\n  labs(color = NULL) +\n  theme_light() +\n  theme(legend.position = \"bottom\")\n\n\n\n\n\n\n\n\n\n\n\n4.3.2 Parameter sensitivity\n\n4.3.2.1 Effective contact rate \\(\\beta\\)\n\n\nCode\n# Try different gamma values\nbvals &lt;- seq(0.001, 0.005, 0.001)\nl &lt;- list()\nfor(i in 1:length(bvals)){\n  pred &lt;- sir_1(beta = bvals[i], gamma = 0.5, S0 = 999, I0 = 1, R0 = 0, times = flu$time)[,c(\"time\", \"I\")]\n  colnames(pred) &lt;- c(\"time\", paste0(\"I\", i))\n  l[[i]] &lt;- pred\n}\nl[[length(l) + 1]] &lt;- flu\n\n# Merge all with flu data\ndf &lt;- Reduce(function(x, y) merge(x, y, by = \"time\", all = TRUE), l)\n\ndf_plot &lt;- pivot_longer(df, cols = I1:prev, names_to = \"comp\", values_to = \"n\")\ndf_plot$comp &lt;- factor(df_plot$comp, levels = c(\"prev\", paste0(\"I\", 1:length(bvals))))\n\nggplot(df_plot, aes(x = time, y = n, color = comp)) +\n  geom_point() + geom_line() +\n  scale_color_hue(labels = c(\"Prevalence\", paste0(\"\\u03b2 = \", bvals))) +\n  labs(color = NULL) +\n  theme_light() +\n  theme(legend.position = \"bottom\")\n\n\n\n\n\n\n\n\n\n\n\n4.3.2.2 Recovery rate \\(\\gamma\\)\n\n\nCode\n# Try different gamma values\ngvals &lt;- seq(0.3, 0.7, 0.1)\nl &lt;- list()\nfor(i in 1:length(gvals)){\n  pred &lt;- sir_1(beta = 0.004, gamma = gvals[i], S0 = 999, I0 = 1, R0 = 0, times = flu$time)[,c(\"time\", \"I\")]\n  colnames(pred) &lt;- c(\"time\", paste0(\"I\", i))\n  l[[i]] &lt;- pred\n}\nl[[length(l) + 1]] &lt;- flu\n\n# Merge all with flu data\ndf &lt;- Reduce(function(x, y) merge(x, y, by = \"time\", all = TRUE), l)\n\ndf_plot &lt;- pivot_longer(df, cols = I1:prev, names_to = \"comp\", values_to = \"n\")\ndf_plot$comp &lt;- factor(df_plot$comp, levels = c(\"prev\", paste0(\"I\", 1:length(gvals))))\n\nggplot(df_plot, aes(x = time, y = n, color = comp)) +\n  geom_point() + geom_line() +\n  scale_color_hue(labels = c(\"Prevalence\", paste0(\"\\u03b3 = \", gvals))) +\n  labs(color = NULL) +\n  theme_light() +\n  theme(legend.position = \"bottom\")\n\n\n\n\n\n\n\n\n\nWhen \\(\\gamma\\) increase, the shape and time to reach the peak of the outbreak stay the same, the outbreak size is reduced. This is because \\(\\gamma\\) increase means patients recover faster, they have less time to infect susceptible individuals, leading to a decrease in outbreak size.",
    "crumbs": [
      "Deterministic models",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>SIR</span>"
    ]
  },
  {
    "objectID": "sir-det.html#poisson-distribution",
    "href": "sir-det.html#poisson-distribution",
    "title": "4  SIR",
    "section": "4.4 Poisson distribution",
    "text": "4.4 Poisson distribution\nPoisson distribution is a discrete probability distribution that expresses probability of a given number of events occurring in a fixed interval of time1.\nSuitable to use because here we are fitting a number of prev occurring in this period.",
    "crumbs": [
      "Deterministic models",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>SIR</span>"
    ]
  },
  {
    "objectID": "sir-det.html#footnotes",
    "href": "sir-det.html#footnotes",
    "title": "4  SIR",
    "section": "",
    "text": "Wikipedia https://en.wikipedia.org/wiki/Poisson_distribution↩︎",
    "crumbs": [
      "Deterministic models",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>SIR</span>"
    ]
  },
  {
    "objectID": "tsir.html",
    "href": "tsir.html",
    "title": "5  tsiR",
    "section": "",
    "text": "5.1 Assumptions\nThe TSIR model relies on two main assumptions (Becker & Grenfell, 2017):",
    "crumbs": [
      "Deterministic models",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>tsiR</span>"
    ]
  },
  {
    "objectID": "tsir.html#assumptions",
    "href": "tsir.html#assumptions",
    "title": "5  tsiR",
    "section": "",
    "text": "Infectious period is fixed at the sampling interval of the data (e.g., bi-weekly for measles). The time step of the model is equal to the infectious period.\nOver a long enough time (e.g., 10-20 years), the sum of births and cases should be approximately equal due to the high infectivity of pathogens such as measles and other childhood infections, in the pre-vaccine era.",
    "crumbs": [
      "Deterministic models",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>tsiR</span>"
    ]
  },
  {
    "objectID": "tsir.html#model",
    "href": "tsir.html#model",
    "title": "5  tsiR",
    "section": "5.2 Model",
    "text": "5.2 Model\n\\[\\mathbb{E}(I_{t + 1}) = \\beta_{t + 1} S_t I_t^{\\alpha}\\]\n\n\n\n\n\n\nExplain\n\n\n\n\n\nThis equation describes the transmission through the multiplicative interaction between susceptible and infected individuals (Finkenstädt & Grenfell, 2000).\n\\[I_{t + 1} = \\beta_{t + 1} S_t^{\\alpha_1} I_t^{\\alpha_2} \\epsilon_t\\]\n\nSusceptible (\\(S_t\\)) meet infectious individuals (\\(I_t\\)) with contact rate \\(\\beta_{t + 1}\\).\n\\(\\alpha_1\\) and \\(\\alpha_2\\) are mixing parameters of the contact process, such that \\(\\alpha_1 = \\alpha_2 = 1\\) is the homogeneous mixing.\n\\(\\epsilon_t\\) is the noise, \\(\\mathbb{E}\\{ log(\\epsilon_t) \\} = 0\\) and \\(\\mathbb{V}\\{ log(\\epsilon_t) \\} = 0\\).\n\n\n\n\n\\[S_{t + 1} = B_{t + 1} + S_t - I_{t + 1}\\]\n\n\n\n\n\n\nExplain\n\n\n\n\n\nSusceptible class in the next time step recruited by births (\\(B_{t + 1}\\)) and depleted by the infected individuals leaving the class (\\(I_{t + 1}\\)) (Finkenstädt & Grenfell, 2000).",
    "crumbs": [
      "Deterministic models",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>tsiR</span>"
    ]
  },
  {
    "objectID": "tsir.html#tsir-framework",
    "href": "tsir.html#tsir-framework",
    "title": "5  tsiR",
    "section": "5.3 tsiR framework",
    "text": "5.3 tsiR framework\n\n5.3.1 Reconstruct susceptible dynamics\nFit a regression between cumulative cases and cumulative births. The slope is assumed to be the report rate \\(\\rho_t\\) (rho) (Du et al., 2017), the residuals is assumed to be the shape of the susceptible dynamics (\\(Z_t\\)).\n\n\n\n\n\n\nExplain\n\n\n\n\n\nLet \\(\\rho_t\\) be the reporting rate and assume \\(\\rho_t\\) has a probability function with expected value \\(\\mathbb{E}(\\rho_t) = \\rho\\).\n\\[I_t = \\rho_t C_t\\]\n\n\\(I_t\\): the number of true cases.\n\\(C_t\\): the number of reported cases.\n\nThe number of true cases is under-reported if \\(\\rho_t &gt; 1\\) and is fully reported if \\(\\rho_t = 1\\).\nReplace \\(I_t\\) here:\n\\[S_t = B_t + S_{t - 1} - I_t\\]\n\\[S_t = B_t + S_{t - 1} - \\rho_t C_t\\]\nLet \\(\\mathbb{E}(S_t) = \\bar{S}\\) so that \\(S_t = \\bar{S} + Z_t\\), with \\(\\mathbb{E}(Z_t) = 0\\). The deviations \\(Z_t\\) from their mean follow the same recursive relationship as \\(S_t\\).\n\\[Z_t = B_t + Z_{t - 1} - \\rho_t C_t\\]\nA successive iteration to compute \\(Z_t\\) from \\(Z_0\\) gives:\n\\[Z_t = \\sum_{i = 1}^{t} B_i + Z_0 - \\sum_{i = 1}^{t} \\rho_i C_i\\]\n\n\\(\\sum_{i = 1}^{t} B_i\\): cumulative births.\n\\(\\sum_{i = 1}^{t} C_i\\): cumulative reported cases.\n\nFor ease of notation, let \\(Y_\\text{cumBirths} = \\sum_{i = 1}^{t} B_i\\), \\(X_\\text{cumCases} = \\sum_{i = 1}^{t} C_i\\), rearrange that equation so that we have:\n\\[Y_\\text{cumBirths} = \\rho X_\\text{cumCases} + Z_t - Z_0\\]\nIf we assume a constant reporting rate, this equation is a simple linear regression relationship between cumulative births \\(Y\\) and cumulative cases \\(X\\).\n\n\n\n\n\n5.3.2 Estimate parameters\nSet the expectation to the mean, then take log of both sides:\n\\[\\mathbb{E}(I_{t + 1}) = \\beta_{t + 1} S_t I_t^{\\alpha}\\]\n\\[log I_{t + 1} = log \\beta_{t + 1} + log(Z_t + \\bar{S}) + \\alpha log I_t\\]\n\n\\(\\bar{S}\\): mean susceptible individuals across the time-series. \\(Z_t\\) is the residuals or the shape of the susceptible dynamics, so \\(Z_t + \\bar{S} = S_t\\)\n\\(\\beta_t\\): contact rate at time t.\n\\(\\alpha\\): describes the epidemic saturation, a correction factor for switching from continuous to discrete time.",
    "crumbs": [
      "Deterministic models",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>tsiR</span>"
    ]
  },
  {
    "objectID": "tsir.html#basic-reproduction-number",
    "href": "tsir.html#basic-reproduction-number",
    "title": "5  tsiR",
    "section": "5.4 Basic reproduction number",
    "text": "5.4 Basic reproduction number\n\\[R_0 = \\beta \\times \\bar{S}\\]",
    "crumbs": [
      "Deterministic models",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>tsiR</span>"
    ]
  },
  {
    "objectID": "tsir.html#code",
    "href": "tsir.html#code",
    "title": "5  tsiR",
    "section": "5.5 Code",
    "text": "5.5 Code\n\nlibrary(tsiR)\n\nThe London measles data is available in the tsiR package.\n\nLondonMeas &lt;- twentymeas[[\"London\"]]\nhead(LondonMeas)\n\n\n\n\n\ntime\ncases\nbirths\npop\n\n\n\n\n1944.016\n180\n1725.038\n2462500\n\n\n1944.055\n271\n1726.429\n2467578\n\n\n1944.093\n423\n1727.820\n2472655\n\n\n1944.131\n465\n1729.211\n2477733\n\n\n1944.170\n523\n1730.602\n2482810\n\n\n1944.208\n649\n1731.992\n2487888\n\n\n\n\n\n\nThe data frame containing cases and interpolated births and populations.\n\nplotdata(LondonMeas)\n\n\n\n\n\n\n\n\n\nLondonRes &lt;- runtsir(data = LondonMeas, IP = 2, xreg = \"cumcases\", regtype = \"gaussian\", alpha = NULL, sbar = NULL, method = \"negbin\", nsim = 100, family = \"gaussian\", link = \"identity\")\n\n           alpha        mean beta         mean rho         mean sus \n        9.60e-01         1.19e-05         4.57e-01         1.14e+05 \nprop. init. sus. prop. init. inf. \n        3.01e-02         6.12e-05 \n\n\n\nalpha: describes the epidemic saturation, a correction factor for switching from continuous to discrete time.\nmean beta: mean of the contact rate across the time-series.\nmean rho: mean of the report rate across the time-series.\nmean sus: mean of the number of susceptible across the time-series.\nprop. init. sus.: proportion of the initial susceptible individuals.\nprop. init. inf.: proportion of the initial infectious individuals.\n\n\n5.5.1 Reconstruct susceptible dynamics\nIn this step we compute the reported rate using cumulative births and cumulative reported cases.\n\\[Y_\\text{cumBirths} = \\rho X_\\text{cumCases} + Z_t - Z_0\\]\n\nplotregression(LondonRes)\n\n\n\n\n\n\n\n\n\nplotrho(LondonRes)\n\n\n\n\n\n\n\n\n\n\n5.5.2 Estimate parameters\nHaving \\(\\rho\\), we adjust the \\(I_t\\) to estimate other parameters.\n\\[I_t = \\rho_t C_t\\] \\[log I_{t + 1} = log \\beta_{t + 1} + log(Z_t + \\bar{S}) + \\alpha log I_t\\]\n\nplotres(LondonRes)\n\nWarning in geom_line(data = dat$res, aes_string(x = \"time\", y = \"cases\", :\nIgnoring unknown aesthetics: fill\n\n\n\n\n\n\n\n\n\n\n\n\n\nBecker, A. D., & Grenfell, B. T. (2017). tsiR: An R package for time-series Susceptible-Infected-Recovered models of epidemics. PLOS ONE, 12(9), e0185528. https://doi.org/10.1371/journal.pone.0185528\n\n\nDu, Z., Zhang, W., Zhang, D., Yu, S., & Hao, Y. (2017). Estimating the basic reproduction rate of HFMD using the time series SIR model in Guangdong, China. PLOS ONE, 12(7), e0179623. https://doi.org/10.1371/journal.pone.0179623\n\n\nFinkenstädt, B. F., & Grenfell, B. T. (2000). Time series modelling of childhood diseases: A dynamical systems approach. Journal of the Royal Statistical Society Series C: Applied Statistics, 49(2), 187–205. https://doi.org/10.1111/1467-9876.00187",
    "crumbs": [
      "Deterministic models",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>tsiR</span>"
    ]
  },
  {
    "objectID": "calib.html",
    "href": "calib.html",
    "title": "Calibration",
    "section": "",
    "text": "Log-likelihood\nThe likelihood is the probability of observing data \\(x\\) given that our model is true[^2], \\(\\mathbb{P}(x|M)\\).\nWe have a lot of data points, and they are independent. The probability of observing all these data points at the same time is the production of these likelihood \\(\\mathbb{P}(x_1|M) \\times \\mathbb{P}(x_2|M) \\times \\mathbb{P}(x_3|M)... = \\prod\\mathbb{P}(x|M)\\).\nMultiplying things together, you will end up losing precision if the numbers are too low. Here you are dealing with probability (a value &lt; 1), multiplying 100 probabilities you will end up with 1e-100.\nBut remember that \\(log(a \\times b) = log(a) + log(b)\\), and very convenient that \\(log(1^{-100} = -230.2585)\\).\nSo \\(log(\\mathbb{P}(x_1|M) \\times \\mathbb{P}(x_2|M) \\times \\mathbb{P}(x_3|M)...)\\) \\(=\\) \\(log(\\mathbb{P}(x_1|M)) + log(\\mathbb{P}(x_2|M)) + log(\\mathbb{P}(x_3|M))...\\) and it is so much easier to handle.",
    "crumbs": [
      "Calibration"
    ]
  },
  {
    "objectID": "calib.html#negative-log-likelihood",
    "href": "calib.html#negative-log-likelihood",
    "title": "Calibration",
    "section": "Negative log-likelihood",
    "text": "Negative log-likelihood\nBecause statistical packages optimizers work by minimizing a function. Minimizing means decrease the distance of two distributions to its lowest, this is fairly easy because we get this when the distance close to 0 (just like the trick we do in hypothesis testing).\nMinimizing negative log-likelihood (meaning that \\(-1 \\times \\text{log-likelihood}\\)) is equivalent to maximizing the log-likelihood, which is what we want to do (MLE: maximum likelihood estimation).",
    "crumbs": [
      "Calibration"
    ]
  },
  {
    "objectID": "rp-risk.html",
    "href": "rp-risk.html",
    "title": "8  Risk assessment report",
    "section": "",
    "text": "8.1 Examples\nRisk assessment for measles resurgence in the UK\nRapid risk assessment: Measles in Canada, public health implications in 2024",
    "crumbs": [
      "Reports",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Risk assessment report</span>"
    ]
  },
  {
    "objectID": "rp-risk.html#data",
    "href": "rp-risk.html#data",
    "title": "8  Risk assessment report",
    "section": "8.2 Data",
    "text": "8.2 Data\n\nHistorical case notification of past outbreaks 2014 and 2019 Date of onset + date of birth (or age)\nCurrent level of susceptibility in HCMC:\n\n\nSerology\nVaccine registry\nBirth rates\n\n\nConnectivity between Phu Quoc and HCMC: Flight data / boat data?\n\nP = 1 – (1 / (R0 * s))^m",
    "crumbs": [
      "Reports",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Risk assessment report</span>"
    ]
  },
  {
    "objectID": "references.html",
    "href": "references.html",
    "title": "References",
    "section": "",
    "text": "Anderson, R., Donnelly, C., Hollingsworth, D., Keeling, M., Vegvari, C.,\nBaggaley, R., & Maddren, R. (2020). Reproduction number (R) and\ngrowth rate (r) of the COVID-19 epidemic in the UK. The Royal\nSociety.\n\n\nBecker, A. D., & Grenfell, B. T. (2017). tsiR: An R package for\ntime-series Susceptible-Infected-Recovered models of epidemics. PLOS\nONE, 12(9), e0185528. https://doi.org/10.1371/journal.pone.0185528\n\n\nBettencourt, L. M. A., & Ribeiro, R. M. (2008). Real Time Bayesian\nEstimation of the Epidemic Potential of Emerging Infectious Diseases.\nPLOS ONE, 3(5), e2185. https://doi.org/10.1371/journal.pone.0002185\n\n\nCori, A., Ferguson, N. M., Fraser, C., & Cauchemez, S. (2013). A new\nframework and software to estimate time-varying reproduction numbers\nduring epidemics. American Journal of Epidemiology,\n178(9), 1505–1512. https://doi.org/10.1093/aje/kwt133\n\n\nDu, Z., Zhang, W., Zhang, D., Yu, S., & Hao, Y. (2017). Estimating\nthe basic reproduction rate of HFMD using the time series SIR model in\nGuangdong, China. PLOS ONE, 12(7), e0179623. https://doi.org/10.1371/journal.pone.0179623\n\n\nFinkenstädt, B. F., & Grenfell, B. T. (2000). Time series modelling\nof childhood diseases: A dynamical systems approach. Journal of the\nRoyal Statistical Society Series C: Applied Statistics,\n49(2), 187–205. https://doi.org/10.1111/1467-9876.00187\n\n\nGostic, K. M., McGough, L., Baskerville, E. B., Abbott, S., Joshi, K.,\nTedijanto, C., Kahn, R., Niehus, R., Hay, J. A., Salazar, P. M. D.,\nHellewell, J., Meakin, S., Munday, J. D., Bosse, N. I., Sherrat, K.,\nThompson, R. N., White, L. F., Huisman, J. S., Scire, J., … Cobey, S.\n(2020). Practical considerations for measuring the effective\nreproductive number, Rt. PLOS Computational Biology,\n16(12), e1008409. https://doi.org/10.1371/journal.pcbi.1008409\n\n\nKenah, E., Lipsitch, M., & Robins, J. M. (2008). Generation interval\ncontraction and epidemic data analysis. Mathematical\nBiosciences, 213(1), 71–79. https://doi.org/10.1016/j.mbs.2008.02.007\n\n\nKnight, J., & Mishra, S. (2020). Estimating effective reproduction\nnumber using generation time versus serial interval, with application to\ncovid-19 in the greater toronto area, canada. Infectious Disease\nModelling, 5, 889–896. https://doi.org/10.1016/j.idm.2020.10.009\n\n\nSender, R., Bar-On, Y., Park, S. W., Noor, E., Dushoff, J., & Milo,\nR. (2022). The unmitigated profile of COVID-19 infectiousness.\neLife, 11, e79134. https://doi.org/10.7554/eLife.79134\n\n\nVegvari, C., Abbott, S., Ball, F., Brooks-Pollock, E., Challen, R.,\nCollyer, B. S., Dangerfield, C., Gog, J. R., Gostic, K. M., Heffernan,\nJ. M., Hollingsworth, T. D., Isham, V., Kenah, E., Mollison, D.,\nPanovska-Griffiths, J., Pellis, L., Roberts, M. G., Scalia Tomba, G.,\nThompson, R. N., & Trapman, P. (2022). Commentary on the use of the\nreproduction number R during the COVID-19 pandemic. Statistical\nMethods in Medical Research, 31(9), 1675–1685. https://doi.org/10.1177/09622802211037079\n\n\nVynnycky, E., & White, R. (2010). An Introduction to Infectious\nDisease Modelling. OUP Oxford.\n\n\nWallinga, J., & Teunis, P. (2004). Different epidemic curves for\nsevere acute respiratory syndrome reveal similar impacts of control\nmeasures. American Journal of Epidemiology, 160(6),\n509–516. https://doi.org/10.1093/aje/kwh255",
    "crumbs": [
      "References"
    ]
  }
]