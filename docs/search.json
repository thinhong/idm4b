[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Infectious disease modelling for babies",
    "section": "",
    "text": "Preface\nLast modified: August 08, 2024.\nThis book brings together everything I have learned about infectious disease modelling during my PhD journey. Special thanks to my idol, Dr. James Hay, who once gave these genius advice:\n\n“Read and learn now - it will be harder later on.”\n“Spent a lot of time writing well-documented, generalisable code that didn’t necessarily turn into publications at the time. I now use that code all of the time.”\nDr. James Hay’s inspiring talk at the MIDSEA ECR April 2024 Meeting.\n\nThese words encouraged me to read and learn more, and to ensure every detail was carefully documented. In this book, you (and my future self) will find:\n\nMethodologies for mathematical models of infectious diseases.\nA dictionary of jargon with cited definitions.\nStep-by-step guides for writing infectious disease reports, following the Center for Disease Control and Prevention report format: data, workflow, analyses, and inference.\n\nThe content of this book is based on the materials I digested during my PhD, with specific articles and readings cited throughout the text. I am deeply grateful to my PhD supervisors, Dr. Marc Choisy, A/Prof. Louise Thwaites, Dr. Hugo Turner, for their caring, inspiring, and enthusiastic guidance. My most heartfelt thanks also go to my mentors, A/Prof. Le Van Tan, Prof. Wirichada Pan-Ngum, Asst Prof. Kiesha Prem and Dr. Leigh Jones, for always nurturing and guiding me towards the best path.\nI would like to acknowledge the following educational experiences:\n\n\n\n\n\n\n\n\nCourse\nLecturers\nInstitutions\n\n\n\n\nModelling Infectious Diseases in South East Asia (MIDSEA) Summer School (2024)\nModelling Master Class: Prof. Alex Cook; Prof. Jomar Fajardo Rabajante; Prof. Wirichada Pan-Ngum\nModelling interventions and Health economic evaluation: Asst/Prof. Kiesha Prem; Asst/Prof. Hannah Clapham; Asst/Prof. Swapnil Mishra; Asst/Prof. Thitiya Theparod\nNational University of Singapore; Mahidol Oxford Research Unit; Oxford University Clinical Research Unit; University of the Philippines; De La Salle Manila; Mahasarakham University\n\n\nSummer Institute in Statistics and Modeling in Infectious Diseases (SISMID) (2023)\nStochastic Epidemic Models with Inference: Prof. Tom Britton; Prof. Ira M Longini\nMCMC I: Prof. M. Elizabeth Halloran; Prof. Volodymyr Minin; Prof. Kari Auranen\nMCMC II: Prof. Philip O’Neill; Prof. Theodore Kypraios\nSimulation-Based Inference for Epidemiological Dynamics: Prof. Aaron King; Prof. Edward Ionides\nUniversity of Washington\n\n\nIntroduction to mathematical models of the Epidemiology & Control of Infectious Diseases (2022)\nProf. Azra Ghani; Prof. Alex Cook; Dr. Lilith Whittles; Dr. Clare McCormack; Dr. Tara Mangal; Dr. Juliette Unwin\nImperial College London; Nanyang Technological University\n\n\nMathematical Modelling for Vaccine-preventable Diseases (2022)\nProf. Caroline Trotter; Prof. Julia Gog; Prof. Nik Cunniffe; Prof. Thumbi Mwanga; A/Prof. Andrew Conlan; Dr. Cerian Webb; Dr. Katy Gaythorpe; Dr. Matt Castle\nVaccine Impact Modelling Consortium; University of Cambridge\n\n\n\nMany thanks to the authors who kindly shared materials in response to my inquiries on these topics:\n\nWorkshop: Modeling Rabies Outbreak and Control (2023), by Dr. Phrutsamon Wongnak.\n\nIf you enjoyed this book or found any mistakes, please leave a comment below. Your feedback means a lot!",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "mod.html",
    "href": "mod.html",
    "title": "Modelling",
    "section": "",
    "text": "What is a model?\nA model is a simplified representation of a complex phenomenon (Vynnycky & White, 2010).\nWe all use models in our daily lives, often without realizing it. Imagine a colleague asks, “How long will it take to get to the restaurant?”. There are different ways you might answer this question, each reflecting a different “model” in your head:\nModels help us navigate and make decisions about complex situations by focusing on the most relevant factors and ignoring the less critical details.",
    "crumbs": [
      "Modelling"
    ]
  },
  {
    "objectID": "mod.html#what-is-a-model",
    "href": "mod.html#what-is-a-model",
    "title": "Modelling",
    "section": "",
    "text": "The Bull, by Pablo Picasso (source).\n\n\n\n\nExperience-based model: You might think, “Last week it took me 20 minutes to get to this restaurant”. This model simplifies by assuming past experiences are a reliable predictor of future outcomes, ignoring daily variations like traffic or weather.\nDistance and speed model: You might think, “The restaurant is 15 kilometers away, and I drive at 45 km/h, so it should take about 20 minutes”. This model uses the formula \\(\\text{time} = \\frac{\\text{distance}}{\\text{speed}}\\). It simplifies by assuming a constant speed, and not accounting for real-world complexities like traffic lights or congestion.",
    "crumbs": [
      "Modelling"
    ]
  },
  {
    "objectID": "mod.html#there-is-no-perfect-model",
    "href": "mod.html#there-is-no-perfect-model",
    "title": "Modelling",
    "section": "There is no perfect model",
    "text": "There is no perfect model\n\nDespite the advances in modelling that will arise in the coming decades, models will never be able to accurately predict if, or when, a particular person, farm or community will become infected. This is for two reasons:\n\nThe transmission of infection is a stochastic process, such that no two epidemics are identical.\nModels will always be an approximation, and rare or unforeseen behavioural events can have a significant impact on the disease dynamics\n\nKeeling M (2006) State-of-science review: predictive and real-time epidemiological modelling. London: Office of Science and Innovation (Christley et al., 2013; Keeling, 2006).",
    "crumbs": [
      "Modelling"
    ]
  },
  {
    "objectID": "mod.html#types-of-model",
    "href": "mod.html#types-of-model",
    "title": "Modelling",
    "section": "Types of model",
    "text": "Types of model\nModels can be classified based on the following attributes (Kim & Goldie, 2008):\n\nTime dynamics: main features change over time (dynamic) or remain constant (static).\nRandomness: Any changes in the model occur randomly (stochastic or probabilistic) or follow pre-specified rules (deterministic).\nBehavior representation: the population’s behaviour is simulated using aggregate variables (population averages) or individual behaviors (individual-based).\nTime representation: events occur at discrete intervals (discrete) or on a continuum (continuous).\nPopulation entry: allows individuals to enter or exit the model (open) or not (closed).\nEquation structure: the model is expressed in equations that are functions of linearly linked parameters (linear) or not (non-linear).\n\n\nStatic vs dynamic\nA static model is one where time does not affect its operation. Time may be present but does not influence the model’s structure or function (Smith & Sturrock, 2023). In infectious disease modelling, static model assumes that the force of infection is constant or changes only as a function of age and other individual characteristics (not time) (Bishai et al., 2023).\nA dynamic model is one where time is essential to its operation. The model cannot function without representing time (Smith & Sturrock, 2023). In infectious disease modelling, dynamic model assumes that the force of infection can vary throughout the course of time and as a function of population interactions, often in non-linear ways (Bishai et al., 2023).\n\n\nDynamic continuous-change vs discrete-change\nDynamic models use state variables to describe the system’s status at any point in time. If the state variables can change continuously over continuous time, then the model has continuous-change aspects.\n\n\nDeterministic vs stochastic\nA deterministic model assumes that there is no randomness, and the system can be fully described by a defined set of equations and parameters. Each run of the deterministic model always generates the same result (Bishai et al., 2023).\nA stochastic model assumes events occur randomly, affecting single parameters or multiple components within the system. Each run of a stochastic model generates different results. Therefore, stochastic models must be run for hundreds or thousands of iterations to explore the full range of possible outcomes (Bishai et al., 2023).\n\n\nPopulation-based vs individual-based\nIn population-based (aggregate or population average) models, individuals are assigned to cohorts (or compartments) and move across different states based on parameter values at the aggregate level (averages of individuals belonging to a compartment or the entire population). The model records the number of individuals in each compartment over time (Kim & Goldie, 2008).\nIndividual-based (or microsimulation - see Definition A.1) models keep track of each individual’s behaviour. Individual-based models may or may not allow for interactions among individuals. If simulated individuals do not interact, the model is static. If they interact with others or the environment, it is dynamic (Kim & Goldie, 2008).\nDynamic individual-based models have 3 subtypes (Kim & Goldie, 2008):\n\nIndividual-level Markov models: extend static microsimulation model based with a Markov structure to allow interactions among individuals.\nDiscrete-event simulations (DES): sample the time to the next event and describes the life history of individuals progressing with various events over time, this type of model is originated from industrial engineering.\nAgent-based models: one of the most flexible modelling techniques, model each agent one by one and allow agents (e.g. individuals) to act and interact autonomously with their own behavioural rules (Bishai et al., 2023).",
    "crumbs": [
      "Modelling"
    ]
  },
  {
    "objectID": "mod.html#solving-a-model",
    "href": "mod.html#solving-a-model",
    "title": "Modelling",
    "section": "Solving a model",
    "text": "Solving a model\nSolving a model means finding a function that satisfies the given conditions. Consider the Malthusian growth model as an example:\n\\[\\frac{dP}{dt} = rP\\]\n\n\\(r\\): the growth rate.\n\\(P\\): the population size.\n\nSolving this model means to write a function of \\(P\\) that satisfies the derivative. This model can be solved analytically by:\n\\[\\begin{align} \\frac{dP}{dt} & = rP \\\\\n\\Leftrightarrow \\frac{dP}{P} & = rdt \\\\\n\\Leftrightarrow \\int \\frac{dP}{P} & = \\int rdt \\\\\n\\Leftrightarrow \\log P & = rt + C \\\\\n\\Leftrightarrow P & = e^{rt + C} \\end{align}\\]\nwhere \\(C\\) is the constant of integration.\n\n\n\n\nBishai, D., Brenzel, L., & Padula, W. (Eds.). (2023). Handbook of applied health economics in vaccines. Oxford University Press. https://doi.org/10.1093/oso/9780192896087.001.0001\n\n\nChristley, R. M., Mort, M., Wynne, B., Wastling, J. M., Heathwaite, A. L., Pickup, R., Austin, Z., & Latham, S. M. (2013). “Wrong, but Useful”: Negotiating Uncertainty in Infectious Disease Modelling. PLOS ONE, 8(10), e76277. https://doi.org/10.1371/journal.pone.0076277\n\n\nKeeling, M. J. (2006). State-of-science review: Predictive and real-time epidemiological modelling. S9. DTI.\n\n\nKim, S.-Y., & Goldie, S. J. (2008). Cost-Effectiveness Analyses of Vaccination Programmes. PharmacoEconomics, 26(3), 191–215. https://doi.org/10.2165/00019053-200826030-00004\n\n\nSmith, J. S., & Sturrock, D. T. (2023). Simio and simulation - modeling, analysis, applications - 6th edition. https://textbook.simio.com/SASMAA6/\n\n\nVynnycky, E., & White, R. (2010). An Introduction to Infectious Disease Modelling. OUP Oxford.",
    "crumbs": [
      "Modelling"
    ]
  },
  {
    "objectID": "sir-det.html",
    "href": "sir-det.html",
    "title": "1  SIR",
    "section": "",
    "text": "1.1 Model\n\\[\\frac{dS}{dt} = -\\beta SI = -\\lambda S \\tag{1.1}\\]\n\\[\\frac{dI}{dt} = \\beta SI - \\gamma I = \\lambda S - \\gamma I \\tag{1.2}\\]\n\\[\\frac{dR}{dt} = \\gamma I \\tag{1.3}\\]",
    "crumbs": [
      "Deterministic models",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>SIR</span>"
    ]
  },
  {
    "objectID": "sir-det.html#model",
    "href": "sir-det.html#model",
    "title": "1  SIR",
    "section": "",
    "text": "\\(\\beta\\): effective contact rate.\n\\(\\gamma\\): removal rate.\n\\(\\beta I = \\lambda\\): the rate from S to I is called force of infection.",
    "crumbs": [
      "Deterministic models",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>SIR</span>"
    ]
  },
  {
    "objectID": "sir-det.html#assumptions",
    "href": "sir-det.html#assumptions",
    "title": "1  SIR",
    "section": "1.2 Assumptions",
    "text": "1.2 Assumptions\n\nEach member of a population is either susceptible, infectious, or recovered (Driessche, 2017).\nThe disease spreads through direct contact between susceptible and infected individuals.\nWell-mixed population, or homogeneous mixing (represented by a single effective contact rate \\(\\beta\\)) (Becker & Grenfell, 2017).\nIn the most basic form it considers a “closed population” without demographics (no births, deaths, or migration) (Keeling & Rohani, 2011), make sense when the disease is short lived compared with the population lifetime (Driessche, 2017).\nThere is no latent period, individuals become infectious immediately upon contracting the disease.\nThe effective contact rate \\(\\beta\\) and recovery rate \\(\\gamma\\) are constant over time.\nInfectious disease properties are for a single pathogen (Becker & Grenfell, 2017).\nRecovered individuals gain lifelong immunity.",
    "crumbs": [
      "Deterministic models",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>SIR</span>"
    ]
  },
  {
    "objectID": "sir-det.html#density-or-frequency-dependent",
    "href": "sir-det.html#density-or-frequency-dependent",
    "title": "1  SIR",
    "section": "1.3 Density or frequency-dependent",
    "text": "1.3 Density or frequency-dependent\n\n\nSource: Density-dependent vs. Frequency-dependent Disease Transmission - Parasite Ecology.\n\n\n\nDensity-dependent\n\\[\\frac{dS}{dt} = -\\beta SI\\]\n\nThe unit of \\(\\beta\\) is \\(\\frac{1}{\\text{time} \\times \\text{people}}\\).\nTransmission increases as density increases.\nAerosol contacts (COVID-19).\n\n\nFrequency-dependent\n\\[\\frac{dS}{dt} = -\\beta S \\frac{I}{N}\\]\n\nThe unit of \\(\\beta\\) is \\(\\frac{1}{\\text{time}}\\).\nTransmission does not increase as density increases.\nSexually-transmitted diseases.",
    "crumbs": [
      "Deterministic models",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>SIR</span>"
    ]
  },
  {
    "objectID": "sir-det.html#code",
    "href": "sir-det.html#code",
    "title": "1  SIR",
    "section": "1.4 Code",
    "text": "1.4 Code\n\nlibrary(odin)\nlibrary(tidyr)\nlibrary(ggplot2)\nlibrary(RColorBrewer)\nlibrary(patchwork)\n\nBelow is how we numerically solve the differential equations Equation 1.1, Equation 1.2, Equation 1.3 in R with the odin package.\n\n\n\nListing 1.1: Deterministic SIR model\n\n\n\nodin_sir &lt;- odin::odin({\n  # Derivatives\n  deriv(S) &lt;- -beta * S * I\n  deriv(I) &lt;- beta * S * I - gamma * I\n  deriv(R) &lt;- gamma * I\n  deriv(CInc) &lt;- beta * S * I\n  \n  # Initial conditions\n  initial(S) &lt;- S_init\n  initial(I) &lt;- I_init\n  initial(R) &lt;- R_init\n  initial(CInc) &lt;- CInc_init\n  \n  # Parameters and initial values\n  beta &lt;- user(0.004)\n  gamma &lt;- user(0.5)\n  S_init &lt;- user(999)\n  I_init &lt;- user(1)\n  R_init &lt;- user(0)\n  CInc_init &lt;- user(0)\n})\n\nsir_mod &lt;- function(beta, gamma, S0, I0, R0, times) {\n  # Set values for a new run\n  odin_run &lt;- odin_sir$new(beta = beta, gamma = gamma, S_init = S0, I_init = I0, R_init = R0)\n  \n  # Run the model\n  out &lt;- data.frame(odin_run$run(times))\n\n  # Compute incidence from cumulative incidence\n  out$Inc &lt;- c(I0, diff(out$CInc))\n  out$CInc &lt;- NULL\n  out\n}",
    "crumbs": [
      "Deterministic models",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>SIR</span>"
    ]
  },
  {
    "objectID": "sir-det.html#incidence-or-prevalence",
    "href": "sir-det.html#incidence-or-prevalence",
    "title": "1  SIR",
    "section": "1.5 Incidence or prevalence",
    "text": "1.5 Incidence or prevalence\n\n\n\n\n\n\nImportant\n\n\n\nBe careful of what kind of data we are using to fit the model:\n\nIncidence: use the \\(\\beta SI\\) part.\n\n\\[\\text{Incidence} = \\frac{\\text{Number of new cases during a period}}{\\text{Population at risk during the same period}}\\]\n\nPrevalence: use the I compartment.\n\n\\[\\text{Prevalence} = \\frac{\\text{Number of existing cases at time t}}{\\text{Total population at time t}}\\]\n\n\nThere are two ways to compute incidence.\n\nWhile writing the differential equations, we tell odin to compute the cumulative incidence, then compute the incidence by using diff() on the cumulative incidence.\n\n\n# Cumulative incidence\nderiv(CInc) &lt;- beta * S * I\n# Compute incidence from cumulative incidence\nout$Inc &lt;- c(I0, diff(out$CInc))\n\n\nIn this “closed population”, the incidence is the number of individuals moving out of \\(S\\) in each time step. So we can compute it from the \\(S\\) column. Let compare it with the previous method.\n\n\npred &lt;- sir_mod(beta = 0.004, gamma = 0.5, S0 = 999, I0 = 1, R0 = 0, times = 0:13)\n\ntmp &lt;- pred\ntmp$Inc2 &lt;- c(tmp$I[1], -diff(tmp$S))\ntmp[,\"Inc-Inc2\"] &lt;- round(tmp$Inc - tmp$Inc2)\ntmp[,c(\"Inc\", \"Inc2\", \"Inc-Inc2\")]\n\n\n  \n\n\n\nNow let have a look at the output.\n\nhead(pred)\n\n\n  \n\n\n\n\n\nCode\ndf_plot &lt;- pivot_longer(pred, cols = S:Inc, names_to = \"comp\", values_to = \"n\")\n\nggplot(df_plot, aes(x = t, y = n, color = comp)) +\n  geom_line(linewidth = 1.2) +\n  scale_color_brewer(palette = \"PuOr\", breaks = c(\"S\", \"Inc\", \"I\", \"R\")) +\n  labs(color = NULL, y = NULL, x = \"Time\") +\n  theme_minimal() +\n  theme(legend.position = \"bottom\")\n\n\n\n\n\n\n\n\n\nThe time to peak of incidence is earlier than prevalence:\n\nIncidence reflects the immediate rate of new infections, the peak of incidence is reached when the transmission rate begins to decline.\nPrevalence accumulates both new and existing cases. Even after the incidence starts to decline, the active cases who were infected before the incidence peak are still there waiting for recovering. Prevalence only starts to decline when the recovery rate surpasses the rate of new infections significantly.\n\n\n\n\n\n\n\nImportant\n\n\n\nNormally, public health officials are interested in the incidence in the general population (to track disease spread) and the prevalence in intensive care units (to ensure it does not exceed ICU bed capacity).",
    "crumbs": [
      "Deterministic models",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>SIR</span>"
    ]
  },
  {
    "objectID": "sir-det.html#sensitivity-analysis",
    "href": "sir-det.html#sensitivity-analysis",
    "title": "1  SIR",
    "section": "1.6 Sensitivity analysis",
    "text": "1.6 Sensitivity analysis\nThe effective contact rate \\(\\beta\\) and the recovery rate \\(\\gamma\\) both affect whether or not there is an epidemic. The total number of people in the population and the initial number of infected people have no effect on whether there is an epidemic.\nBelow is a function that take a range of values of parameters and compare the model outputs.\n\n\nCode\nsir_sa &lt;- function(vals, parm, outcome, times, init_beta = 0.004, init_gamma = 0.5) {\n  pick_comp &lt;- ifelse(outcome == \"prev\", \"I\", \"Inc\")\n  plot_lab &lt;- ifelse(outcome == \"prev\", \"Prevalence\", \"Incidence\")\n  symb &lt;- ifelse(parm == \"beta\", \"\\u03b2\", \"\\u03b3\")\n  l &lt;- list()\n  for(i in 1:length(vals)) {\n    if (parm == \"beta\") {\n      pred &lt;- sir_mod(beta = vals[i], gamma = init_gamma, S0 = 999, I0 = 1, R0 = 0, times = times)[, c(\"t\", pick_comp)]\n    } else {\n      pred &lt;- sir_mod(beta = init_beta, gamma = vals[i], S0 = 999, I0 = 1, R0 = 0, times = times)[, c(\"t\", pick_comp)]\n    }\n    pred$comp &lt;- paste0(pick_comp, i)\n    colnames(pred) &lt;- c(\"t\", \"n\", \"comp\")\n    l[[i]] &lt;- pred\n  }\n  # Bind this list into a data frame\n  df_plot &lt;- Reduce(rbind, l)\n  # Set level I1 &lt; I2 &lt; I3... according to the increase of beta values\n  df_plot$comp &lt;- factor(df_plot$comp, levels = c(paste0(pick_comp, 1:length(vals))))\n  \n  # Plot results\n  my_palette &lt;- brewer.pal(9, \"Blues\")[(9-length(vals)+1):9]\n  \n  ggplot(df_plot, aes(x = t, y = n, color = comp)) + \n    geom_line(linewidth = 1.2) +\n    scale_color_manual(values = my_palette, labels = c(paste0(symb, \" = \", vals))) +\n    labs(color = NULL, y = plot_lab, x = \"Time\") +\n    theme_minimal()\n}\n\n\n\n1.6.1 Effective contact rate \\(\\beta\\)\n\n\nCode\nvals &lt;- seq(0.001, 0.006, 0.001)\n\np1 &lt;- sir_sa(vals = vals, parm = \"beta\", outcome = \"prev\", times = 0:13) + labs(x = NULL)\np2 &lt;- sir_sa(vals = vals, parm = \"beta\", outcome = \"inc\", times = 0:13)\n\np1 / p2 + plot_layout(guides = \"collect\") & theme(legend.position = \"bottom\")\n\n\n\n\n\n\n\n\n\nWhen \\(\\beta\\) decreases, less susceptible individuals become infected per unit time:\n\nTime until peak increases: because the speed of susceptible individuals become infected is slower.\nEpidemic duration increases: the rate of new infections slows down so it can lead to a longer epidemic period, but depends on the balance between the infection rate and the recovery rate.\nOutbreak size decreases: \\(R_0 = \\frac{\\beta}{\\gamma}\\), so if \\(\\beta\\) decreases, \\(R_0\\) decreases, each infected individual infect less people on average.\nLower epidemic peak: because fewer infections occurring simultaneously.\n\nInterventions that decrease \\(\\beta\\) cause a lower outbreak size and a lower epidemic peak. This effect is often referred to as “flattening the curve”.\n\n\n1.6.2 Recovery rate \\(\\gamma\\)\n\n\nCode\nvals &lt;- seq(0.3, 0.8, 0.1)\n\np1 &lt;- sir_sa(vals = vals, parm = \"gamma\", outcome = \"prev\", times = 0:13) + labs(x = NULL)\np2 &lt;- sir_sa(vals = vals, parm = \"gamma\", outcome = \"inc\", times = 0:13)\n\np1 / p2 + plot_layout(guides = \"collect\") & theme(legend.position = \"bottom\")\n\n\n\n\n\n\n\n\n\nWhen \\(\\gamma\\) decreases, patients recover more slowly:\n\nOutbreak size increases: patients remain infectious for a longer period; since \\(R_0 = \\frac{\\beta}{\\gamma}\\), a decrease in \\(\\gamma\\) leads to an increase in \\(R_0\\), meaning each infected individual infects less people on average.\nHigher epidemic peak: with a higher \\(R_0\\) more individuals are infected after each generation.\nTime until peak may increases: the infected population takes longer to clear out due to slower recovery, but the exact timing of the peak also depends on the balance between infection and recovery rates.\nEpidemic duration slightly increases: for same reason as the peak time, the overall duration of the epidemic is prolonged due to slower recovery rates.",
    "crumbs": [
      "Deterministic models",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>SIR</span>"
    ]
  },
  {
    "objectID": "sir-det.html#corollaries",
    "href": "sir-det.html#corollaries",
    "title": "1  SIR",
    "section": "1.7 Corollaries",
    "text": "1.7 Corollaries\n\n1.7.1 The threshold phenomenon\nFrom Equation 1.2:\n\\[\\frac{dI}{dt} = \\beta SI - \\gamma I = I(\\beta S - \\gamma)\\]\nThe infection “dies out” when:\n\\[\\frac{dI}{dt} &lt; 0 \\Leftrightarrow \\beta S - \\gamma &lt; 0 \\Leftrightarrow S &lt; \\frac{\\gamma}{\\beta}\\]\n\nThe proportion of susceptibles in the population must exceed this critical threshold \\(\\frac{\\gamma}{\\beta}\\) for an infection to invade (Keeling & Rohani, 2011).\n\nThe inverse of the relative removal rate is called the basic reproductive ratio \\(R_0 = \\frac{\\beta}{\\gamma}\\) (Keeling & Rohani, 2011). See Definition 1 for more details.\n\n\n1.7.2 Epidemic burnout\nDivide Equation 1.1 by Equation 1.3:\n\\[\\frac{dS}{dR} = \\frac{-\\beta S I}{\\gamma I} = -\\frac{\\beta}{\\gamma} S\\]\nUpon integrating with respect to R, we obtain:\n\\[S(t) = S(0)e^{-\\frac{\\beta}{\\gamma} R(t)}\\]\nGiven that \\(e^x &gt; 0 \\quad \\forall x\\), therefore \\(S(t) &gt; 0\\) there will always be some susceptibles in the population who escape infection, leading to an important counter-intuitive conclusion from this model:\n\nThe chain of transmission eventually breaks due to the decline in infectives, not due to a complete lack of susceptibles (Keeling & Rohani, 2011).\n\n\n\n\n\nBecker, A. D., & Grenfell, B. T. (2017). tsiR: An R package for time-series Susceptible-Infected-Recovered models of epidemics. PLOS ONE, 12(9), e0185528. https://doi.org/10.1371/journal.pone.0185528\n\n\nDriessche, P. van den. (2017). Reproduction numbers of infectious disease models. Infectious Disease Modelling, 2(3), 288–303. https://doi.org/10.1016/j.idm.2017.06.002\n\n\nKeeling, M. J., & Rohani, P. (2011). Modeling Infectious Diseases in Humans and Animals. Princeton University Press. https://doi.org/10.1515/9781400841035",
    "crumbs": [
      "Deterministic models",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>SIR</span>"
    ]
  },
  {
    "objectID": "seir-det.html",
    "href": "seir-det.html",
    "title": "2  SEIR",
    "section": "",
    "text": "2.1 Code\nlibrary(odin)\nlibrary(tidyr)\nlibrary(ggplot2)\nlibrary(RColorBrewer)\nlibrary(patchwork)\nLet reuse the deterministic SIR model code from Listing 1.1 and write code for the deterministic SEIR model.\nCode\npred1 &lt;- sir_mod(beta = 0.004, gamma = 0.5, S0 = 999, I0 = 1, R0 = 0, times = 1:20)\npred2 &lt;- seir_mod(beta = 0.004, sigma = 0.5, gamma = 0.5, S0 = 999, E0 = 0, I0 = 1, R0 = 0, times = 1:20)\n\ndf_plot &lt;- pivot_longer(pred1, cols = S:Inc, names_to = \"comp\", values_to = \"n\")\n\nmy_palette &lt;- brewer.pal(11, \"PuOr\")[c(10, 4, 3, 8)]\n\np1 &lt;- ggplot(df_plot, aes(x = t, y = n, color = comp)) +\n  geom_line(linewidth = 1.2) +\n  scale_color_manual(values = my_palette, breaks = c(\"S\", \"Inc\", \"I\", \"R\")) +\n  labs(color = NULL, y = NULL, x = NULL) +\n  theme_minimal() +\n  theme(legend.position = \"none\")\n\ndf_plot &lt;- pivot_longer(pred2, cols = S:Inc, names_to = \"comp\", values_to = \"n\")\n\nmy_palette &lt;- brewer.pal(11, \"PuOr\")[c(10, 1, 4, 3, 8)]\n\np2 &lt;- ggplot(df_plot, aes(x = t, y = n, color = comp)) +\n  geom_line(linewidth = 1.2) +\n  scale_color_manual(values = my_palette, breaks = c(\"S\", \"E\", \"Inc\", \"I\", \"R\")) +\n  labs(color = NULL, y = NULL, x = \"Time\") +\n  theme_minimal() +\n  theme(legend.position = \"bottom\")\n\np1 / p2",
    "crumbs": [
      "Deterministic models",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>SEIR</span>"
    ]
  },
  {
    "objectID": "seir-det.html#code",
    "href": "seir-det.html#code",
    "title": "2  SEIR",
    "section": "",
    "text": "Listing 2.1: Deterministic SEIR model\n\n\n\nodin_seir &lt;- odin::odin({\n  # Derivatives\n  deriv(S) &lt;- -beta * S * I\n  deriv(E) &lt;- beta * S * I - sigma * E\n  deriv(I) &lt;- sigma * E - gamma * I\n  deriv(R) &lt;- gamma * I\n  deriv(CInc) &lt;- sigma * E\n  \n  # Initial conditions\n  initial(S) &lt;- S_init\n  initial(E) &lt;- E_init\n  initial(I) &lt;- I_init\n  initial(R) &lt;- R_init\n  initial(CInc) &lt;- CInc_init\n  \n  # Parameters and initial values\n  beta &lt;- user(0.004)\n  sigma &lt;- user(0.5)\n  gamma &lt;- user(0.5)\n  S_init &lt;- user(369)\n  E_init &lt;- user(0)\n  I_init &lt;- user(1)\n  R_init &lt;- user(0)\n  CInc_init &lt;- user(0)\n})\n\nseir_mod &lt;- function(beta, sigma, gamma, S0, E0, I0, R0, times) {\n  # Set values for a new run\n  odin_run &lt;- odin_seir$new(beta = beta, sigma = sigma, gamma = gamma, S_init = S0, E_init = E0, I_init = I0, R_init = R0)\n  \n  # Run the model\n  out &lt;- data.frame(odin_run$run(times))\n\n  # Compute incidence from cumulative incidence\n  out$Inc &lt;- c(I0, diff(out$CInc))\n  out$CInc &lt;- NULL\n  out\n}",
    "crumbs": [
      "Deterministic models",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>SEIR</span>"
    ]
  },
  {
    "objectID": "tsir.html",
    "href": "tsir.html",
    "title": "3  tsiR",
    "section": "",
    "text": "3.1 Assumptions\nThe TSIR model relies on two main assumptions (Becker & Grenfell, 2017):",
    "crumbs": [
      "Deterministic models",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>tsiR</span>"
    ]
  },
  {
    "objectID": "tsir.html#assumptions",
    "href": "tsir.html#assumptions",
    "title": "3  tsiR",
    "section": "",
    "text": "Infectious period is fixed at the sampling interval of the data (e.g., bi-weekly for measles). The time step of the model is equal to the infectious period.\nOver a long enough time (e.g., 10-20 years), the sum of births and cases should be approximately equal due to the high infectivity of pathogens such as measles and other childhood infections, in the pre-vaccine era.",
    "crumbs": [
      "Deterministic models",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>tsiR</span>"
    ]
  },
  {
    "objectID": "tsir.html#model",
    "href": "tsir.html#model",
    "title": "3  tsiR",
    "section": "3.2 Model",
    "text": "3.2 Model\n\\[\\mathbb{E}(I_{t + 1}) = \\beta_{t + 1} S_t I_t^{\\alpha}\\]\n\n\n\n\n\n\nExplain\n\n\n\n\n\nThis equation describes the transmission through the multiplicative interaction between susceptible and infected individuals (Finkenstädt & Grenfell, 2000).\n\\[I_{t + 1} = \\beta_{t + 1} S_t^{\\alpha_1} I_t^{\\alpha_2} \\epsilon_t\\]\n\nSusceptible (\\(S_t\\)) meet infectious individuals (\\(I_t\\)) with contact rate \\(\\beta_{t + 1}\\).\n\\(\\alpha_1\\) and \\(\\alpha_2\\) are mixing parameters of the contact process, such that \\(\\alpha_1 = \\alpha_2 = 1\\) is the homogeneous mixing.\n\\(\\epsilon_t\\) is the noise, \\(\\mathbb{E}\\{ log(\\epsilon_t) \\} = 0\\) and \\(\\mathbb{V}\\{ log(\\epsilon_t) \\} = 0\\).\n\n\n\n\n\\[S_{t + 1} = B_{t + 1} + S_t - I_{t + 1}\\]\n\n\n\n\n\n\nExplain\n\n\n\n\n\nSusceptible class in the next time step recruited by births (\\(B_{t + 1}\\)) and depleted by the infected individuals leaving the class (\\(I_{t + 1}\\)) (Finkenstädt & Grenfell, 2000).",
    "crumbs": [
      "Deterministic models",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>tsiR</span>"
    ]
  },
  {
    "objectID": "tsir.html#tsir-framework",
    "href": "tsir.html#tsir-framework",
    "title": "3  tsiR",
    "section": "3.3 tsiR framework",
    "text": "3.3 tsiR framework\n\n3.3.1 Reconstruct susceptible dynamics\nFit a regression between cumulative cases and cumulative births. The slope is assumed to be the report rate \\(\\rho_t\\) (rho) (Du et al., 2017), the residuals is assumed to be the shape of the susceptible dynamics (\\(Z_t\\)).\n\n\n\n\n\n\nExplain\n\n\n\n\n\nLet \\(\\rho_t\\) be the reporting rate and assume \\(\\rho_t\\) has a probability function with expected value \\(\\mathbb{E}(\\rho_t) = \\rho\\).\n\\[I_t = \\rho_t C_t\\]\n\n\\(I_t\\): the number of true cases.\n\\(C_t\\): the number of reported cases.\n\nThe number of true cases is under-reported if \\(\\rho_t &gt; 1\\) and is fully reported if \\(\\rho_t = 1\\).\nReplace \\(I_t\\) here:\n\\[S_t = B_t + S_{t - 1} - I_t\\]\n\\[S_t = B_t + S_{t - 1} - \\rho_t C_t\\]\nLet \\(\\mathbb{E}(S_t) = \\bar{S}\\) so that \\(S_t = \\bar{S} + Z_t\\), with \\(\\mathbb{E}(Z_t) = 0\\). The deviations \\(Z_t\\) from their mean follow the same recursive relationship as \\(S_t\\).\n\\[Z_t = B_t + Z_{t - 1} - \\rho_t C_t\\]\nA successive iteration to compute \\(Z_t\\) from \\(Z_0\\) gives:\n\\[Z_t = \\sum_{i = 1}^{t} B_i + Z_0 - \\sum_{i = 1}^{t} \\rho_i C_i\\]\n\n\\(\\sum_{i = 1}^{t} B_i\\): cumulative births.\n\\(\\sum_{i = 1}^{t} C_i\\): cumulative reported cases.\n\nFor ease of notation, let \\(Y_\\text{cumBirths} = \\sum_{i = 1}^{t} B_i\\), \\(X_\\text{cumCases} = \\sum_{i = 1}^{t} C_i\\), rearrange that equation so that we have:\n\\[Y_\\text{cumBirths} = \\rho X_\\text{cumCases} + Z_t - Z_0\\]\nIf we assume a constant reporting rate, this equation is a simple linear regression relationship between cumulative births \\(Y\\) and cumulative cases \\(X\\).\n\n\n\n\n\n3.3.2 Estimate parameters\nSet the expectation to the mean, then take log of both sides:\n\\[\\mathbb{E}(I_{t + 1}) = \\beta_{t + 1} S_t I_t^{\\alpha}\\]\n\\[log I_{t + 1} = log \\beta_{t + 1} + log(Z_t + \\bar{S}) + \\alpha log I_t\\]\n\n\\(\\bar{S}\\): mean susceptible individuals across the time-series. \\(Z_t\\) is the residuals or the shape of the susceptible dynamics, so \\(Z_t + \\bar{S} = S_t\\)\n\\(\\beta_t\\): contact rate at time t.\n\\(\\alpha\\): describes the epidemic saturation, a correction factor for switching from continuous to discrete time.",
    "crumbs": [
      "Deterministic models",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>tsiR</span>"
    ]
  },
  {
    "objectID": "tsir.html#basic-reproduction-number",
    "href": "tsir.html#basic-reproduction-number",
    "title": "3  tsiR",
    "section": "3.4 Basic reproduction number",
    "text": "3.4 Basic reproduction number\n\\[R_0 = \\beta \\times \\bar{S}\\]",
    "crumbs": [
      "Deterministic models",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>tsiR</span>"
    ]
  },
  {
    "objectID": "tsir.html#code",
    "href": "tsir.html#code",
    "title": "3  tsiR",
    "section": "3.5 Code",
    "text": "3.5 Code\n\nlibrary(tsiR)\n\nThe London measles data is available in the tsiR package.\n\nLondonMeas &lt;- twentymeas[[\"London\"]]\nhead(LondonMeas)\n\n\n  \n\n\n\nThe data frame containing cases and interpolated births and populations.\n\nplotdata(LondonMeas)\n\n\n\n\n\n\n\n\n\nLondonRes &lt;- runtsir(data = LondonMeas, IP = 2, xreg = \"cumcases\", regtype = \"gaussian\", alpha = NULL, sbar = NULL, method = \"negbin\", nsim = 100, family = \"gaussian\", link = \"identity\")\n\n           alpha        mean beta         mean rho         mean sus \n        9.60e-01         1.19e-05         4.57e-01         1.14e+05 \nprop. init. sus. prop. init. inf. \n        3.01e-02         6.12e-05 \n\n\n\nalpha: describes the epidemic saturation, a correction factor for switching from continuous to discrete time.\nmean beta: mean of the contact rate across the time-series.\nmean rho: mean of the report rate across the time-series.\nmean sus: mean of the number of susceptible across the time-series.\nprop. init. sus.: proportion of the initial susceptible individuals.\nprop. init. inf.: proportion of the initial infectious individuals.\n\n\n3.5.1 Reconstruct susceptible dynamics\nIn this step we compute the reported rate using cumulative births and cumulative reported cases.\n\\[Y_\\text{cumBirths} = \\rho X_\\text{cumCases} + Z_t - Z_0\\]\n\nplotregression(LondonRes)\n\n\n\n\n\n\n\n\n\nplotrho(LondonRes)\n\n\n\n\n\n\n\n\n\n\n3.5.2 Estimate parameters\nHaving \\(\\rho\\), we adjust the \\(I_t\\) to estimate other parameters.\n\\[I_t = \\rho_t C_t\\] \\[log I_{t + 1} = log \\beta_{t + 1} + log(Z_t + \\bar{S}) + \\alpha log I_t\\]\n\nplotres(LondonRes)\n\nWarning in geom_line(data = dat$res, aes_string(x = \"time\", y = \"cases\", :\nIgnoring unknown aesthetics: fill\n\n\n\n\n\n\n\n\n\n\n\n\n\nBecker, A. D., & Grenfell, B. T. (2017). tsiR: An R package for time-series Susceptible-Infected-Recovered models of epidemics. PLOS ONE, 12(9), e0185528. https://doi.org/10.1371/journal.pone.0185528\n\n\nDu, Z., Zhang, W., Zhang, D., Yu, S., & Hao, Y. (2017). Estimating the basic reproduction rate of HFMD using the time series SIR model in Guangdong, China. PLOS ONE, 12(7), e0179623. https://doi.org/10.1371/journal.pone.0179623\n\n\nFinkenstädt, B. F., & Grenfell, B. T. (2000). Time series modelling of childhood diseases: A dynamical systems approach. Journal of the Royal Statistical Society Series C: Applied Statistics, 49(2), 187–205. https://doi.org/10.1111/1467-9876.00187",
    "crumbs": [
      "Deterministic models",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>tsiR</span>"
    ]
  },
  {
    "objectID": "seir-sto.html",
    "href": "seir-sto.html",
    "title": "4  SEIR",
    "section": "",
    "text": "4.1 Vaccination\ntransitions &lt;- c(\"S -&gt; beta * S * I -&gt; E\",\n                 \"E -&gt; epsilon * E -&gt; I\",\n                 \"I -&gt; gamma * I -&gt; R\")\ncompartments &lt;- c(\"S\", \"E\", \"I\", \"R\")",
    "crumbs": [
      "Stochastic models",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>SEIR</span>"
    ]
  },
  {
    "objectID": "calib.html",
    "href": "calib.html",
    "title": "Calibration",
    "section": "",
    "text": "Least squares estimation\n\\[RSS = \\sum_{i = 1}^{n}[y_i - f(x_i)]^2 \\tag{1}\\]\nLeast squares estimation corresponds to maximum likelihood estimation when the noise is normally distributed with equal variances.",
    "crumbs": [
      "Calibration"
    ]
  },
  {
    "objectID": "calib.html#sec-calib-mle",
    "href": "calib.html#sec-calib-mle",
    "title": "Calibration",
    "section": "Maximum likelihood estimation",
    "text": "Maximum likelihood estimation\nA generalization of the least squares idea is the likelihood.\n\nLikelihood\nThe likelihood is the probability of observing data \\(x\\) given that our model is true[^2], \\(\\mathbb{P}(x|M)\\).\n\n\nLog-likelihood\nWe have a lot of data points, and they are independent. The probability of observing all these data points at the same time is the production of these likelihood \\(\\mathbb{P}(x_1|M) \\times \\mathbb{P}(x_2|M) \\times \\mathbb{P}(x_3|M)... = \\prod\\mathbb{P}(x|M)\\).\nMultiplying things together, you will end up losing precision if the numbers are too low. Here you are dealing with probability (a value &lt; 1), multiplying 100 probabilities you will end up with 1e-100.\nBut remember that \\(log(a \\times b) = log(a) + log(b)\\), and very convenient that \\(log(1^{-100} = -230.2585)\\).\nSo \\(log(\\mathbb{P}(x_1|M) \\times \\mathbb{P}(x_2|M) \\times \\mathbb{P}(x_3|M)...)\\) \\(=\\) \\(log(\\mathbb{P}(x_1|M)) + log(\\mathbb{P}(x_2|M)) + log(\\mathbb{P}(x_3|M))...\\) and it is so much easier to handle.\n\n\nNegative log-likelihood\nBecause statistical packages optimizers work by minimizing a function. Minimizing means decrease the distance of two distributions to its lowest, this is fairly easy because we get this when the distance close to 0 (just like the trick we do in hypothesis testing).\nMinimizing negative log-likelihood (meaning that \\(-1 \\times \\text{log-likelihood}\\)) is equivalent to maximizing the log-likelihood, which is what we want to do (MLE: maximum likelihood estimation).",
    "crumbs": [
      "Calibration"
    ]
  },
  {
    "objectID": "calib.html#poisson-distribution",
    "href": "calib.html#poisson-distribution",
    "title": "Calibration",
    "section": "Poisson distribution",
    "text": "Poisson distribution\nPoisson distribution is a discrete probability distribution that expresses probability of a given number of events occurring in a fixed interval of time1.\nSuitable to use because here we are fitting a number of prev occurring in this period.",
    "crumbs": [
      "Calibration"
    ]
  },
  {
    "objectID": "calib.html#sec-calib-mle-lse",
    "href": "calib.html#sec-calib-mle-lse",
    "title": "Calibration",
    "section": "When MLE is equal to LSE",
    "text": "When MLE is equal to LSE\nAssuming the data is generated from a normal distribution with mean \\(\\mu\\) and a standard deviation \\(\\sigma\\).\n\nStep 1. Write down the likelihood function \\(L(\\theta)\\).\n\n\\[L(\\theta) = \\prod_{i = 1}^{n} \\mathcal{N}(\\mu_i, \\sigma) = \\prod_{i = 1}^{n} \\frac{1}{\\sigma\\sqrt{2 \\pi}} \\text{exp} \\left[ \\frac{-1}{2 \\sigma^2} (y_i - \\mu_i)^2 \\right]\\]\n\\[L(\\theta) = \\frac{1}{(\\sigma \\sqrt{2 \\pi})^n} \\text{exp} \\left[ \\frac{-1}{2 \\sigma^2} \\sum_{i = 1}^n (y_i - \\mu_i)^2 \\right]\\]\nSince \\(\\sigma\\) and \\(\\sqrt{2 \\pi}\\) are constant.\n\\[L(\\theta) \\varpropto \\text{exp} \\left[ - \\sum_{i = 1}^n (y_i - \\mu_i)^2 \\right]\\]\n\nStep 2. Take the natural log of the likelihood \\(log L(\\theta)\\).\n\n\\[log L(\\theta) \\varpropto - \\sum_{i = 1}^n (y_i - \\mu_i)^2\\]\n\nStep 3. Take the negative log-likelihood \\(- log L(\\theta)\\).\n\n\\[- log L(\\theta) \\varpropto \\sum_{i = 1}^n (y_i - \\mu_i)^2\\]\nThis looks exactly like the residual sum of squares at Equation 1.\n\nStep 4. The optimizer minimize negative log-likelihood \\(- log L(\\theta)\\). It does the same thing as the LSE finds the optimal parameters by minimizing the RSS.\n\n\n\n\n\nRui, J., Li, K., Wei, H., Guo, X., Zhao, Z., Wang, Y., Song, W., Abudunaibi, B., & Chen, T. (2024). MODELS: A six-step framework for developing an infectious disease model. Infectious Diseases of Poverty, 13(1), 30. https://doi.org/10.1186/s40249-024-01195-3",
    "crumbs": [
      "Calibration"
    ]
  },
  {
    "objectID": "calib.html#footnotes",
    "href": "calib.html#footnotes",
    "title": "Calibration",
    "section": "",
    "text": "Wikipedia https://en.wikipedia.org/wiki/Poisson_distribution↩︎",
    "crumbs": [
      "Calibration"
    ]
  },
  {
    "objectID": "lse.html",
    "href": "lse.html",
    "title": "5  Least squares estimation",
    "section": "",
    "text": "5.1 Methods\nRefer to Definition A.4, the residual sum of squares (RSS) is the sum of the squares of residuals.\n\\[RSS = \\sum_{i = 1}^{n}[y_i - f(x_i)]^2\\]\nThe least squares method finds the optimal parameters by minimizing the RSS.",
    "crumbs": [
      "Calibration",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Least squares estimation</span>"
    ]
  },
  {
    "objectID": "lse.html#methods",
    "href": "lse.html#methods",
    "title": "5  Least squares estimation",
    "section": "",
    "text": "\\(y_i\\): the observed value.\n\\(f(x_i)\\): the predicted value.\n\\(y_i - f(x_i)\\): the residual.",
    "crumbs": [
      "Calibration",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Least squares estimation</span>"
    ]
  },
  {
    "objectID": "lse.html#sec-lse-code",
    "href": "lse.html#sec-lse-code",
    "title": "5  Least squares estimation",
    "section": "5.2 Code",
    "text": "5.2 Code\n\nlibrary(tidyr)\nlibrary(odin)\nlibrary(ggplot2)\nlibrary(RColorBrewer)\n\nWe will use data collected during a H1N1 influenza outbreak in an elementary school in Pennsylvania (Cauchemez et al., 2011). Let load the data and have a look.\n\ndf &lt;- read.csv(\"data/flu_inc.csv\")\n\nggplot(df, aes(x = day, y = inc)) +\n  geom_point() +\n  labs(x = \"Day\", y = \"Incidence\") +\n  theme_minimal()\n\n\n\n\n\n\n\n\nWe will fit a deterministic SEIR model and reuse the code from Listing 2.1. Let plug some initial values for the parameters and run the model.\nLooking at the original paper, the school has 370 students (Cauchemez et al., 2011). So we set the initial values as below.\n\nS0 &lt;- 369\nE0 &lt;- 0\nI0 &lt;- 1\nR0 &lt;- 0\n\n\n\nCode\npred &lt;- seir_mod(beta = 0.004, sigma = 0.5, gamma = 0.5, S0 = S0, E0 = E0, I0 = I0, R0 = R0, times = df$day)\n\ndf_plot &lt;- pivot_longer(pred, cols = S:Inc, names_to = \"comp\", values_to = \"n\")\n\nmy_palette &lt;- brewer.pal(11, \"PuOr\")[c(10, 1, 4, 3, 8)]\n\nggplot(df_plot, aes(x = t, y = n, color = comp)) +\n  geom_line(linewidth = 1.2) +\n  scale_color_manual(values = my_palette, breaks = c(\"S\", \"E\", \"Inc\", \"I\", \"R\")) +\n  labs(color = NULL, y = NULL, x = \"Day\") +\n  theme_minimal() +\n  theme(legend.position = \"bottom\")\n\n\n\n\n\n\n\n\n\nNow just plot the incidence to compare with our data.\n\n\nCode\ndf_plot &lt;- pred[,c(\"t\", \"Inc\")]\nggplot(df_plot, aes(x = t, y = Inc)) +\n  geom_line(color = my_palette[3], linewidth = 1.2) +\n  geom_point(data = df, aes(x = day, y = inc)) +\n  labs(x = \"Day\", y = \"Incidence\") +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\nWe need to calculate the residual sum of squares. The rss() function must be defined this way with 2 arguments data and par so that it could be passed to the optim() function.\n\nrss &lt;- function(data, par) {\n  pred &lt;- seir_mod(beta = par[1], sigma = par[2], gamma = par[3], S0 = S0, E0 = E0, I0 = I0, R0 = R0, times = 0:(length(data) - 1))\n  sum((data - pred$Inc)^2)\n}\n\nThe optim() function needs at least 2 inputs:\n\npar: a vector of initial values for the parameters to be optimized over.\nfn: a function to be minimized.\n...: other arguments will be passed to fn, here our function rss() needs an additional argument data, so we pass data = df$inc.\n\n\nseir_optim &lt;- optim(par = c(0.004, 0.5, 0.5), fn = rss, data = df$inc)\nseir_optim\n\n$par\n[1] 0.007665126 1.697323120 2.209129854\n\n$value\n[1] 147.9004\n\n$counts\nfunction gradient \n     197       NA \n\n$convergence\n[1] 0\n\n$message\nNULL\n\n\nLet plug these values into the model and compare with our data.\n\nCode\npred &lt;- seir_mod(beta = seir_optim$par[1], sigma = seir_optim$par[2], gamma = seir_optim$par[3], S0 = S0, E0 = E0, I0 = I0, R0 = R0, times = df$day)\ndf_plot &lt;- pred[,c(\"t\", \"Inc\")]\nggplot(df_plot, aes(x = t, y = Inc)) +\n  geom_line(color = my_palette[3], linewidth = 1.2) +\n  geom_point(data = df, aes(x = day, y = inc)) +\n  labs(x = \"Day\", y = \"Incidence\") +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 5.1: Deterministic SEIR model fitted with least squares estimation.\n\n\n\nSince we are using a “closed population” SEIR model, \\(R_0 = \\frac{\\beta}{\\gamma} S_0\\).\n\n\n\nListing 5.1: \\(R_0\\) from deterministic SEIR model fitted with least squares estimation.\n\n\n\nrnum0 &lt;- seir_optim$par[1] * S0 / seir_optim$par[3]\nrnum0\n\n[1] 1.280337\n\n\n\n\n\nThis is quite close to 1.4 (95% CI: 1.2, 1.5) as reported by (Cauchemez et al., 2011), considering that they used more complicated methods.\n\n\n\n\nCauchemez, S., Bhattarai, A., Marchbanks, T. L., Fagan, R. P., Ostroff, S., Ferguson, N. M., Swerdlow, D., Pennsylvania H1N1 working group, the, Sodha, S. V., Moll, M. E., Angulo, F. J., Palekar, R., Archer, W. R., & Finelli, L. (2011). Role of social networks in shaping disease transmission during a community outbreak of 2009 H1N1 pandemic influenza. Proceedings of the National Academy of Sciences, 108(7), 2825–2830. https://doi.org/10.1073/pnas.1008895108",
    "crumbs": [
      "Calibration",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Least squares estimation</span>"
    ]
  },
  {
    "objectID": "mle.html",
    "href": "mle.html",
    "title": "6  Maximum likelihood estimation",
    "section": "",
    "text": "6.1 Likelihood\n\\[\\mathbb{L}(\\theta | x) = \\mathbb{P}(x | \\theta)\\]",
    "crumbs": [
      "Calibration",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Maximum likelihood estimation</span>"
    ]
  },
  {
    "objectID": "mle.html#methods",
    "href": "mle.html#methods",
    "title": "6  Maximum likelihood estimation",
    "section": "6.2 Methods",
    "text": "6.2 Methods\nThe maximum likelihood estimation follows 4 steps:\n\nStep 1. Write down the likelihood function \\(L(\\theta)\\). Likelihood function is a function of \\(\\theta\\), which is the product of the \\(n\\) mass/density function terms of the observed values \\(y_i\\).\n\n\\[\\mathbb{L}(\\theta) = \\prod_{i = 1}^{n} f_Y(y_i| \\theta)\\]\n\nStep 2. Take the natural log of the likelihood \\(log L(\\theta)\\), or log-likelihood. The production in likelihood now becomes the sum in log-likelihood. See Section 2.2 for more details.\n\n\\[log \\mathbb{L}(\\theta) = \\sum_{i = 1}^{n} log \\left[ f_Y(y_i| \\theta) \\right]\\]\n\nStep 3. Take the negative log-likelihood \\(- log L(\\theta)\\). Because optimizers work by minimizing a function, we have to work on negative log-likelihood. See Section 2.3 for more details.\n\n\\[- log \\mathbb{L}(\\theta) = - \\sum_{i = 1}^{n} log \\left[ f_Y(y_i| \\theta) \\right]\\]\n\nStep 4. The optimizer try different values of \\(\\theta\\) in the paramater space \\(\\Theta\\) for which negative log-likelihood \\(- log \\mathbb{L}(\\theta)\\) is minimized.",
    "crumbs": [
      "Calibration",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Maximum likelihood estimation</span>"
    ]
  },
  {
    "objectID": "mle.html#code",
    "href": "mle.html#code",
    "title": "6  Maximum likelihood estimation",
    "section": "6.4 Code",
    "text": "6.4 Code\n\nlibrary(tidyr)\nlibrary(odin)\nlibrary(bbmle)\nlibrary(ggplot2)\nlibrary(RColorBrewer)\n\nWe will use the same data of a H1N1 influenza outbreak in an elementary school in Section 5.2 and fit the deterministic SEIR model with code Listing 2.1.\n\ndf &lt;- read.csv(\"data/flu_inc.csv\")\n\nLooking at the original paper, the school has 370 students (Cauchemez et al., 2011). So we set the initial values as below.\n\nS0 &lt;- 369\nE0 &lt;- 0\nI0 &lt;- 1\nR0 &lt;- 0\n\n\nStep 1. Write down the likelihood function \\(L(\\theta)\\).\n\nWe assume the incidence data is generated from a normal distribution with mean \\(\\mu_{inc}\\) is the predicted incidence and a standard deviation \\(\\sigma_{inc}\\).\n\\[L(\\theta) = \\prod_{i = 1}^{n} \\mathcal{N}(\\mu_{inc}, \\sigma_{inc})\\]\nWe use the dnorm() function to define this likelihood.\n\ndnorm(x = data, mean = pred, sd = sd_inc)\n\n\nStep 2. Take the natural log of the likelihood \\(log L(\\theta)\\), product becomes sum.\n\n\\[log L(\\theta) = \\sum_{i = 1}^{n} log \\left[ \\mathcal{N}(\\mu_{inc}, \\sigma_{inc}) \\right]\\]\n\nsum(dnorm(x = data, mean = pred, sd = sd_inc, log = T))\n\n\nStep 3. Take the negative log-likelihood \\(- log L(\\theta)\\).\n\n\\[- log L(\\theta) = - \\sum_{i = 1}^{n} log \\left[ \\mathcal{N}(\\mu_{inc}, \\sigma_{inc}) \\right]\\]\n\n- sum(dnorm(x = data, mean = pred, sd = sd_inc, log = T))\n\n\nStep 4. Pass the negative log-likelihood \\(- log L(\\theta)\\) to the optimizer.\n\nRoot mean squared error as SD\n\nmll &lt;- function(beta, sigma, gamma, sd_inc) {\n  # Make sure that parameters are positive\n  beta &lt;- exp(beta) \n  sigma &lt;- exp(sigma)\n  gamma &lt;- exp(gamma)\n  sd_inc &lt;- exp(sd_inc)\n  \n  pred &lt;- seir_mod(beta = beta, sigma = sigma, gamma = gamma, S0 = S0, E0 = E0, I0 = I0, R0 = R0, times = 0:(length(df$inc) - 1))\n  pred &lt;- pred$Inc\n  # Return the negative log-likelihood\n  - sum(dnorm(x = df$inc, mean = pred, sd = sd_inc, log = T))\n}\n\nstarting_param_val &lt;- list(beta = 0.004, sigma = 0.5, gamma = 0.5, sd_inc = 3)\n\nestimates &lt;- mle2(minuslogl = mll, start = lapply(starting_param_val, log), method = \"Nelder-Mead\")\n\nsummary(estimates)\n\nMaximum likelihood estimation\n\nCall:\nmle2(minuslogl = mll, start = lapply(starting_param_val, log), \n    method = \"Nelder-Mead\")\n\nCoefficients:\n        Estimate Std. Error  z value     Pr(z)    \nbeta   -5.063479   0.092641 -54.6567 &lt; 2.2e-16 ***\nsigma   0.708384   0.134498   5.2669 1.388e-07 ***\ngamma   0.600399   0.092968   6.4581 1.060e-10 ***\nsd_inc  0.530870   0.099628   5.3285 9.902e-08 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n-2 log L: 198.8602 \n\n\n\nparams &lt;- exp(coef(estimates))\nparams\n\n       beta       sigma       gamma      sd_inc \n0.006323524 2.030707475 1.822846603 1.700410622 \n\n\nCompare the model with data.\n\n\nCode\npred &lt;- seir_mod(beta = params[1], sigma = params[2], gamma = params[3], S0 = S0, E0 = E0, I0 = I0, R0 = R0, times = df$day)\ndf_plot &lt;- pred[,c(\"t\", \"Inc\")]\n\n# Compute 95% confidence interval\nlwr &lt;- qnorm(p = 0.025, mean = pred$Inc, sd = params[4])\nupr &lt;- qnorm(p = 0.975, mean = pred$Inc, sd = params[4])\n\nmy_palette &lt;- brewer.pal(11, \"PuOr\")[c(10, 1, 4, 3, 8)]\n\nggplot(df_plot, aes(x = t, y = Inc)) +\n  geom_line(color = my_palette[3], linewidth = 1.2) +\n  geom_ribbon(aes(ymin = lwr, ymax = upr), fill = my_palette[3], alpha = 0.15) +\n  geom_point(data = df, aes(x = day, y = inc)) +\n  coord_cartesian(ylim = c(0, max(upr))) +\n  labs(x = \"Day\", y = \"Incidence\") +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\nIt looks very similar to the model we fitted with LSE at Figure 5.1.\nLet compute \\(R_0\\). For a “closed population” SEIR model, \\(R_0 = \\frac{\\beta}{\\gamma} S_0\\). Again, this is similar to the \\(R_0\\) estimated from LSE at Listing 5.1. The reason is MLE is equal to LSE when we pick the normal distribution likelihood, see Section 4 for more details.\n\nrnum0 &lt;- params[1] * S0 / params[3]\nrnum0\n\n    beta \n1.280075 \n\n\n\n\n\n\nCauchemez, S., Bhattarai, A., Marchbanks, T. L., Fagan, R. P., Ostroff, S., Ferguson, N. M., Swerdlow, D., Pennsylvania H1N1 working group, the, Sodha, S. V., Moll, M. E., Angulo, F. J., Palekar, R., Archer, W. R., & Finelli, L. (2011). Role of social networks in shaping disease transmission during a community outbreak of 2009 H1N1 pandemic influenza. Proceedings of the National Academy of Sciences, 108(7), 2825–2830. https://doi.org/10.1073/pnas.1008895108",
    "crumbs": [
      "Calibration",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Maximum likelihood estimation</span>"
    ]
  },
  {
    "objectID": "mcmc.html",
    "href": "mcmc.html",
    "title": "7  MCMC",
    "section": "",
    "text": "Suppose that we have an iid (see Definition A.2) incubation periods dataset of \\(n\\) samples \\(y = (y_1, y_2, \\cdots, y_n)\\). We assume these data are independent draws from a Gamma distribution with shape \\(\\alpha\\) and rate \\(\\beta\\).\n\n\n\n\n\n\npdf of Gamma distribution\n\n\n\n\n\nA random variable \\(x\\) that is gamma-distributed with shape \\(\\alpha\\) and rate \\(\\beta\\) has this pdf:\n\\[f(x | \\alpha, \\beta) = \\frac{\\beta^{\\alpha}}{\\Gamma(\\alpha)} x^{\\alpha - 1} e^{-\\beta x}\\]\n\\(f(x | \\alpha, \\beta)\\) or sometimes written as \\(f(x; \\alpha, \\beta)\\) (Wikipedia) reads as: probability density of random variable \\(x\\) given that we know parameters \\(\\alpha\\) and \\(\\beta\\).\n\n\n\nStep 1. Write the likelihood function of the dataset.\nLikelihood of a data point is \\(f(y_1| \\alpha, \\beta)\\).\nLikelihood of the dataset is:\n\\[\\begin{align}\nf(y| \\alpha, \\beta) &= f(y_1| \\alpha, \\beta) \\times f(y_2| \\alpha, \\beta) \\times \\cdots \\times f(y_n| \\alpha, \\beta) \\\\\n&= \\prod_{i = 1}^{n} \\frac{\\beta^{\\alpha}}{\\Gamma(\\alpha)} y_i^{\\alpha - 1} e^{-\\beta y_i} \\\\\n&= \\frac{\\beta^{n\\alpha}}{\\Gamma(\\alpha)^n} \\prod_{i = 1}^{n} y_i^{\\alpha - 1} e^{-\\beta y_i}\n\\end{align}\\]\nStep 2. Assign prior distributions to the parameters of interest.\nBoth shape \\(\\alpha\\) and rate \\(\\beta\\) are positive so a natural to distribution to represent our prior beliefs them is a Gamma distribution. We will also assume that a priori (i.e. before we see the data) that \\(\\alpha\\) and \\(\\beta\\) are independent.\n\\[\\alpha \\sim \\text{Gamma}(\\lambda_\\alpha, \\nu_\\alpha)\\]\nThe pdf of \\(\\alpha\\) is:\n\\[f(\\alpha| \\lambda_\\alpha, \\nu_\\alpha) = \\frac{\\nu_\\alpha^{\\lambda_\\alpha}}{\\Gamma(\\lambda_\\alpha)} \\alpha^{\\lambda_\\alpha - 1} e^{-\\nu_\\alpha \\alpha}\\]\nBecause \\(\\frac{\\nu_\\alpha^{\\lambda_\\alpha}}{\\Gamma(\\lambda_\\alpha)}\\) does not depends on \\(\\alpha\\).\n\\[\\begin{align}\nf(\\alpha| \\lambda_\\alpha, \\nu_\\alpha) &= \\frac{\\nu_\\alpha^{\\lambda_\\alpha}}{\\Gamma(\\lambda_\\alpha)} \\alpha^{\\lambda_\\alpha - 1} e^{-\\nu_\\alpha \\alpha} \\\\\n&\\propto \\alpha^{\\lambda_\\alpha - 1} e^{-\\nu_\\alpha \\alpha} \\end{align}\\]\nSimilarly:\n\\[\\beta \\sim \\text{Gamma}(\\lambda_\\beta, \\nu_\\beta)\\]\n\\[\\begin{align}\nf(\\beta| \\lambda_\\beta, \\nu_\\beta) &= \\frac{\\nu_\\beta^{\\lambda_\\beta}}{\\Gamma(\\lambda_\\beta)} \\beta^{\\lambda_\\beta - 1} e^{-\\nu_\\beta \\beta} \\\\\n&\\propto \\beta^{\\lambda_\\beta - 1} e^{-\\nu_\\beta \\beta} \\end{align}\\]\nStep 3. Write the joint posterior distribution.\n\\[\\begin{align}\nf(\\alpha, \\beta | y) &\\propto f(y| \\alpha, \\beta) \\times f(\\alpha) \\times f(\\beta) \\\\\n&= f(y| \\alpha, \\beta) \\times f(\\alpha| \\lambda_\\alpha, \\nu_\\alpha) \\times f(\\beta| \\lambda_\\beta, \\nu_\\beta) \\\\\n&= \\frac{\\beta^{n\\alpha}}{\\Gamma(\\alpha)^n} \\prod_{i = 1}^{n} y_i^{\\alpha - 1} e^{-\\beta y_i} \\times \\alpha^{\\lambda_\\alpha - 1} e^{-\\nu_\\alpha \\alpha} \\times \\beta^{\\lambda_\\beta - 1} e^{-\\nu_\\beta \\beta}\n\\end{align}\\]\nStep 4. Derive the full conditionals.\nThe full conditional",
    "crumbs": [
      "Calibration",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>MCMC</span>"
    ]
  },
  {
    "objectID": "rnum.html",
    "href": "rnum.html",
    "title": "Reproduction number",
    "section": "",
    "text": "Basic reproduction number \\(R_0\\)\nThe basic reproduction number is sometimes called the basic reproductive number or basic reproductive ratio (Driessche, 2017).\nEstimations of the R0 value are often calculated as a function of 3 primary parameters (Chitnis, 2017; Jones, 2007):\n\\[R_0 = \\begin{pmatrix} \\text{Number of} \\\\ \\text{contacts} \\\\ \\text{per unit time} \\end{pmatrix} \\times \\begin{pmatrix} \\text{Probability of} \\\\ \\text{transmission} \\\\ \\text{per contact} \\end{pmatrix} \\times \\begin{pmatrix} \\text{Duration} \\\\ \\text{of} \\\\ \\text{infectious} \\end{pmatrix}\\]",
    "crumbs": [
      "Reproduction number"
    ]
  },
  {
    "objectID": "rnum.html#basic-reproduction-number-r_0",
    "href": "rnum.html#basic-reproduction-number-r_0",
    "title": "Reproduction number",
    "section": "",
    "text": "Definition 1 \\(R_0\\) (pronounced /R naught/) is the average number of individuals infected by each infectious individual in a fully susceptible population (Vegvari et al., 2022). In short, \\(R_0\\) is the \\(R\\) in a fully susceptible population, the maximum \\(R\\) in a population.\n\n\n\n\n\n\n\n\n\n\nCautions\n\n\n\n\nFor many vaccine-preventable diseases, \\(R_0\\) values were calculated long ago in history. For example, measles \\(R_0\\) values of 12-18 are based on data from 1912-1928 in the United States (\\(R_0 = 12.5\\)) and 1944-1979 in England and Wales (\\(R_0 = 13.7-18.0\\)). For pertussis, the original data sources are 1908-1917 in the United States (\\(R_0 = 12.2\\)) and 1944-1979 in England and Wales (\\(R_0 = 14.3-17.1\\)). Human contact patterns in the past are extremely unlikely to match present day epidemiological realities. However, historical \\(R_0\\) values are so frequently cited that new \\(R_0\\) values using modern data might be dismissed if they fall outside the old range. Public health decisions should be made using up-to-date \\(R_0\\) values (Delamater et al., 2019).\n\\(R_0\\) is not a biological constant for a pathogen, and \\(R_0\\) cannot be modified through vaccination campaigns (Delamater et al., 2019). In fact, more than 20 different \\(R_0\\) values (range 5.4-18) were reported for measles in a variety of study areas and periods, and a review in 2017 identified feasible measles \\(R_0\\) values of 3.7-203.3 (Delamater et al., 2019).\n\\(R_0\\) estimates in the early phase may not be representative for the population if the group of initial transmitters is atypical (Vegvari et al., 2022) (e.g. monkeypox).\n\\(R_0\\) may be incorrectly estimated if asymptomatic individuals are not counted or recognised, and their epidemiologically relevant behaviour differs from that of symptomatic individuals (Vegvari et al., 2022).",
    "crumbs": [
      "Reproduction number"
    ]
  },
  {
    "objectID": "rnum.html#effective-reproduction-number-r_e",
    "href": "rnum.html#effective-reproduction-number-r_e",
    "title": "Reproduction number",
    "section": "Effective reproduction number \\(R_e\\)",
    "text": "Effective reproduction number \\(R_e\\)\n\nDefinition 2 \\(R_e\\) is the average number of secondary cases generated by each infectious individual throughout their infectious period in a population that may be partially immune (Wallinga & Lipsitch, 2006).\n\nLet \\(s\\) be the proportion of the population that is susceptible.\n\\[R_e = s \\times R_0\\]",
    "crumbs": [
      "Reproduction number"
    ]
  },
  {
    "objectID": "rnum.html#effective-reproduction-number-at-time-t-r_t",
    "href": "rnum.html#effective-reproduction-number-at-time-t-r_t",
    "title": "Reproduction number",
    "section": "Effective reproduction number at time \\(t\\) \\(R_t\\)",
    "text": "Effective reproduction number at time \\(t\\) \\(R_t\\)\n\nDefinition 3 \\(R_e(t)\\) (Knight & Mishra, 2020) or \\(R_t\\) is the average number of secondary cases generated by one infected person at time \\(t\\) during the outbreak, where some individuals may no longer be susceptible (Gostic et al., 2020).\n\nA public health control strategy will end an outbreak if it can keep \\(R_t\\) below 1. The level of immunity at which \\(R_t = 1\\) is the herd immunity threshold (Vegvari et al., 2022).\n\n\n\n\n\n\n\n\n\nAt the beginning of an outbreak, we can estimate \\(R_0\\) when the whole population is fully susceptible. As the outbreak progresses, the number of susceptible individuals decreases, leading to a decline in \\(R_0\\). This adjusted value is referred to as \\(R_t\\) (if we want to measure at each time \\(t\\)). At the peak of the epidemic curve, \\(R_t = 1\\). After this peak, \\(R_t\\) continues to decrease, resulting in a decline in the number of new cases and the epidemic curve going down.\n\\(R_t\\) can be defined in 2 ways:\n\nInstantaneous reproduction number (\\(R_t^i\\)): the average number of individuals someone infected at time \\(t\\) would infect if conditions remained unchanged (Green et al., 2022).\nCase reproduction number (\\(R_t^c\\)): the average number of people an individual infected at time t actually infects, which will depend on changes in policy or behavior over the period of that cohort’s infection, and can only be estimated in retrospect (Green et al., 2022).\n\n\nInstantaneous reproduction number \\(R_t^i\\)\n\n\nFigure illustrates the Cori method (Gostic et al., 2020).\n\nMeasures transmission at a specific point in time (Gostic et al., 2020). The instantaneous reproduction number quantifies the number of new infections at a single point in time \\(t_i\\) (blue arrow), using the number of infections in the previous generation (green arrows) and their current infectiousness (green curve) (Gostic et al., 2020). The analyses can be done near real-time.\nMethods to estimate instantaneous reproduction number includes Cori and colleagues (Cori et al., 2013) (the best for near real-time estimation (Gostic et al., 2020)), and Bettencourt and Ribeiro (Bettencourt & Ribeiro, 2008) (use with caution because they implicitly assume the generation interval follows an exponential distribution, as in SIR model, which does not include alatent period).\n\n\nCase reproduction number \\(R_t^c\\)\n\n\nFigure illustrates the Wallinga and Teunis method (Gostic et al., 2020).\n\nMeasures transmission by a specific cohort of individuals (Gostic et al., 2020). A cohort is a group of individuals with the same date of infection or the same date of symptom onset. The case reproduction number is the average number of new infections that an individual who becomes infected on day \\(t_i\\) (green arrows in B) or symptomatic on day \\(t_s\\) (yellow arrows in C) will eventually go on to cause (blue downward arrows in B and C). It is a more natural choice for analyses that consider heterogeneity among individuals (Gostic et al., 2020).\nMethods to estimate instantaneous reproduction number includes Wallinga and Teunis method (Wallinga & Teunis, 2004).",
    "crumbs": [
      "Reproduction number"
    ]
  },
  {
    "objectID": "rnum.html#sec-rnum-growthrate-r0",
    "href": "rnum.html#sec-rnum-growthrate-r0",
    "title": "Reproduction number",
    "section": "Growth rate \\(r\\) and basic reproduction number \\(R_0\\)",
    "text": "Growth rate \\(r\\) and basic reproduction number \\(R_0\\)\nIn the initial phase of an epidemic where the population is completely susceptible, incidence increase exponentially.\nThe exponential growth rate \\(r\\) is defined as the per capita change in number of new cases per unit of time (Wallinga & Lipsitch, 2006). Let \\(C_0\\) be the incidence at time \\(t = 0\\). For continuous time \\(t\\), the incidence at time \\(t\\) is given by:\n\\[C_t = C_0 e^{rt}\\]\n\n\n\n\n\n\nExplanation\n\n\n\n\n\nLet \\(M\\) is the money you have at time \\(t = 0\\), \\(r\\) is the annual interest rate. The money you have after each year would be:\n\\[\\begin{align} M_1 & = M_0 + r M_0 = M_0 (1 + r) \\\\\nM_2 & = M_1 + r M_1 = M_1 (1 + r) \\\\\n& = M_0 (1 + r)(1 + r) = M_0 (1 + r)^2 \\\\\nM_3 & = M_2 + r M_2 = M_2 (1 + r) \\\\\n& = M_0 (1 + r)^2(1 + r) = M_0 (1 + r)^3 \\\\\n& \\cdots \\\\\nM_t & = M_0 (1 + r)^t \\end{align}\\]\nNow we imagined that, instead of paying interest once a year at a rate of \\(r\\), a bank might add interest twice a year at the rate \\(\\frac{r}{2}\\), or three times a year at the rate \\(\\frac{r}{3}\\). In general, we considered interest added \\(n\\) times a year at the rate of \\(\\frac{r}{n}\\). In this case, each year your money is:\n\\[M_t = M_0 \\left(1 + \\frac{r}{n} \\right)^{nt}\\]\nWhen \\(n\\) is very large and thus \\(\\frac{r}{n}\\) is very small, we can prove that:\n\\[\\lim_{n \\to \\infty} \\left(1 + \\frac{r}{n}\\right)^{n} \\approx e^r\\]\nProof\n\\[L = \\lim_{n \\to \\infty} \\left(1 + \\frac{r}{n}\\right)^{n}\\]\nTake the natural logarithm:\n\\[\\log L = \\log \\left[ \\lim_{n \\to \\infty} \\left(1 + \\frac{r}{n}\\right)^n \\right]\\]\nSince the natural logarithm is a continuous function, we can bring the limit inside the logarithm.\n\\[\\begin{align} \\log L & = \\lim_{n \\to \\infty} \\log \\left[ \\left(1 + \\frac{r}{n}\\right)^n \\right] \\\\\n& = \\lim_{n \\to \\infty} n \\log \\left(1 + \\frac{r}{n} \\right) \\end{align}\\]\nFor small values of \\(x\\), we can approximate \\(\\log(1 + x) \\approx x - \\frac{x^2}{2} + \\frac{x^3}{3} - \\cdots\\). When \\(x\\) is very small, higher-order terms become negligible, so: \\[\\log \\left(1 + \\frac{r}{n}\\right) \\approx \\frac{r}{n}\\]\nSubstitute this approximation into \\(L\\):\n\\[\\log L \\approx \\lim_{n \\to \\infty} n \\left( \\frac{r}{n} \\right) = \\lim_{n \\to \\infty} r = r\\]\nTherefore:\n\\[\\begin{align} \\log L & \\approx r \\\\\n\\Leftrightarrow L & \\approx e^r \\\\\n\\Leftrightarrow \\lim_{n \\to \\infty} \\left(1 + \\frac{r}{n}\\right)^{n} & \\approx e^r \\end{align}\\]\nTherefore:\n\\[M_t = M_0 \\left(1 + \\frac{r}{n} \\right)^{nt} \\approx M_0 e^{rt}\\]\n\n\n\nWe start with \\(C_0\\) infected individuals, each infects \\(R_0\\) individuals after generation time \\(T_g\\). The number of infected individuals will be:\n\\[\\begin{align} C_{T_g} & = C_0 R_0 \\end{align} \\tag{1}\\]\nWe also proved that:\n\\[\\begin{align} C_t & = C_0 e^{rt} \\\\\n\\Leftrightarrow C_{T_g} & = C_0 e^{rT_g} \\end{align}\\]\nSubstitute Equation 1, we have:\n\\[\\begin{align} C_0 R_0 & = C_0 e^{rT_g} \\\\\n\\Leftrightarrow R_0 & = e^{rT_g} \\end{align}\\]\nWe can prove that:\n\\[R_0 = e^{rT_g} \\approx 1 + rT_g\\]\n\n\n\n\n\n\nProof\n\n\n\n\n\nExpand \\(e^x\\) using the Taylor series:\n\\[e^x = 1 + x + \\frac{x^2}{2!} + \\frac{x^3}{3!} + \\cdots\\]\nSubstitute \\(x\\) with \\(rT_g\\) in the Taylor series expansion:\n\\[e^{rT_g} = 1 + rT_g + \\frac{{rT_g}^2}{2!} + \\frac{{rT_g}^3}{3!} + \\cdots\\]\nFor small values of \\(rT_g\\), \\(\\frac{{rT_g}^2}{2!}\\), \\(\\frac{{rT_g}^3}{3!}\\) become very small and can be neglected:\n\\[e^{rT_g} \\approx 1 + rT_g\\]\n\n\n\n\n\n\n\nBettencourt, L. M. A., & Ribeiro, R. M. (2008). Real Time Bayesian Estimation of the Epidemic Potential of Emerging Infectious Diseases. PLOS ONE, 3(5), e2185. https://doi.org/10.1371/journal.pone.0002185\n\n\nChitnis, N. (2017). Introduction to SEIR Models.\n\n\nCori, A., Ferguson, N. M., Fraser, C., & Cauchemez, S. (2013). A new framework and software to estimate time-varying reproduction numbers during epidemics. American Journal of Epidemiology, 178(9), 1505–1512. https://doi.org/10.1093/aje/kwt133\n\n\nDelamater, P. L., Street, E. J., Leslie, T. F., Yang, Y. T., & Jacobsen, K. H. (2019). Complexity of the basic reproduction number (R0) - volume 25, number 1january 2019 - emerging infectious diseases journal - CDC. https://doi.org/10.3201/eid2501.171901\n\n\nDriessche, P. van den. (2017). Reproduction numbers of infectious disease models. Infectious Disease Modelling, 2(3), 288–303. https://doi.org/10.1016/j.idm.2017.06.002\n\n\nGostic, K. M., McGough, L., Baskerville, E. B., Abbott, S., Joshi, K., Tedijanto, C., Kahn, R., Niehus, R., Hay, J. A., Salazar, P. M. D., Hellewell, J., Meakin, S., Munday, J. D., Bosse, N. I., Sherrat, K., Thompson, R. N., White, L. F., Huisman, J. S., Scire, J., … Cobey, S. (2020). Practical considerations for measuring the effective reproductive number, Rt. PLOS Computational Biology, 16(12), e1008409. https://doi.org/10.1371/journal.pcbi.1008409\n\n\nGreen, W. D., Ferguson, N. M., & Cori, A. (2022). Inferring the reproduction number using the renewal equation in heterogeneous epidemics. Journal of The Royal Society Interface, 19(188), 20210429. https://doi.org/10.1098/rsif.2021.0429\n\n\nJones, J. H. (2007). Notes on R0. California: Department of Anthropological Sciences, 323, 1–19.\n\n\nKnight, J., & Mishra, S. (2020). Estimating effective reproduction number using generation time versus serial interval, with application to covid-19 in the greater toronto area, canada. Infectious Disease Modelling, 5, 889–896. https://doi.org/10.1016/j.idm.2020.10.009\n\n\nVegvari, C., Abbott, S., Ball, F., Brooks-Pollock, E., Challen, R., Collyer, B. S., Dangerfield, C., Gog, J. R., Gostic, K. M., Heffernan, J. M., Hollingsworth, T. D., Isham, V., Kenah, E., Mollison, D., Panovska-Griffiths, J., Pellis, L., Roberts, M. G., Scalia Tomba, G., Thompson, R. N., & Trapman, P. (2022). Commentary on the use of the reproduction number R during the COVID-19 pandemic. Statistical Methods in Medical Research, 31(9), 1675–1685. https://doi.org/10.1177/09622802211037079\n\n\nWallinga, J., & Lipsitch, M. (2006). How generation intervals shape the relationship between growth rates and reproductive numbers. Proceedings of the Royal Society B: Biological Sciences, 274(1609), 599–604. https://doi.org/10.1098/rspb.2006.3754\n\n\nWallinga, J., & Teunis, P. (2004). Different epidemic curves for severe acute respiratory syndrome reveal similar impacts of control measures. American Journal of Epidemiology, 160(6), 509–516. https://doi.org/10.1093/aje/kwh255",
    "crumbs": [
      "Reproduction number"
    ]
  },
  {
    "objectID": "gen-int.html",
    "href": "gen-int.html",
    "title": "9  Generation interval",
    "section": "",
    "text": "9.1 Definition\nIf we match this to an SEIR model, the generation interval starts when the infector enters the E compartment (meaning they got infected). The latest time they can infect an infectee is at the end of their residence in the I compartment (they are infectious). Therefore, generation interval is the sum of residence times in compartments E and I (Gostic et al., 2020).\nThe mean generation interval decreases when susceptible persons are at risk of infectious contact from multiple sources. Because when a susceptible person has multiple potential infectors, there is a “race” to infect him/her in which only the first infectious contact leads to infection (Kenah et al., 2008).",
    "crumbs": [
      "Reproduction number",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Generation interval</span>"
    ]
  },
  {
    "objectID": "gen-int.html#definition",
    "href": "gen-int.html#definition",
    "title": "9  Generation interval",
    "section": "",
    "text": "Definition 9.1 Generation interval is the time from the infection of a primary case to infection of the cases he/she generates (Cori et al., 2013).",
    "crumbs": [
      "Reproduction number",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Generation interval</span>"
    ]
  },
  {
    "objectID": "gen-int.html#serial-interval",
    "href": "gen-int.html#serial-interval",
    "title": "9  Generation interval",
    "section": "9.2 Serial interval",
    "text": "9.2 Serial interval\n\n\n\n\n\n\n\nDefinition 9.2 Serial interval is the time between symptom onset in an infector–infectee pair (Gostic et al., 2020).\n\n\n\n\n\n\n\nFigure from (Sender et al., 2022).\n\n\nSerial interval is more easily observed than generation interval and often used in its place. Although the serial and generation intervals are often conflated, there are important differences (Gostic et al., 2020):\n\nSerial interval and generation interval usually have the same mean, but different variances.\nSerial interval can be negative (when the symptom onset of infector is later than infectee, such as in COVID-19), generation interval is always positive.\n\nThe distributions of the serial interval and the generation interval are identical in these scenarios (Cori et al., 2013):\n\nFor diseases such as influenza, SARS, measles, and smallpox, it is expected that infectiousness starts only around the time of symptom onset.\nWhen the infectiousness profile after symptoms is independent of the incubation period.",
    "crumbs": [
      "Reproduction number",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Generation interval</span>"
    ]
  },
  {
    "objectID": "gen-int.html#estimating-serial-interval-distribution",
    "href": "gen-int.html#estimating-serial-interval-distribution",
    "title": "9  Generation interval",
    "section": "9.3 Estimating serial interval distribution",
    "text": "9.3 Estimating serial interval distribution\n\nlibrary(lubridate)\nlibrary(ggplot2)\nlibrary(epitrix)\n\nRead and clean the data\n\ndf &lt;- read.csv(\"data/ebola_si.csv\")\n# Convert date_onset to date type\ndf$date_onset &lt;- dmy(df$date_onset)\nhead(df)\n\n\n  \n\n\n\nIn this data, we know who infected whom, and the date of symptom onset. To estimate the serial intervals, we need the time between symptom onset of each infector–infectee pair. Now let transform the original data to something like this:\n\n\n\n\n\n\n\n\n\n\nInfectee\nInfector\nInfectee’s date of onset\nInfector’s date of onset\nTime between onset\n\n\n\n\n\n\n# Get pairs of infector-infectee\ntmp &lt;- data.frame(infectee = df$case_id, infector = df$infector, infectee_onset = df$date_onset)\n\n# Now let find the infector's date of onset\nonset &lt;- data.frame(case_id = df$case_id, date_onset = df$date_onset)\ntmp &lt;- merge(tmp, onset, by.x = \"infector\", by.y = \"case_id\", all.x = T)\ncolnames(tmp)[4] &lt;- \"infector_onset\"\n\n# Compute the time between onset\ntmp$si &lt;- as.numeric(difftime(tmp$infectee_onset, tmp$infector_onset, unit = \"days\"))\n\n# Remove NA rows\ntmp &lt;- tmp[!is.na(tmp$si),]\nhead(tmp)\n\n\n  \n\n\n\nWe use function fit_disc_gamma() from package epitrix to fit a discretised gamma distribution to these serial intervals.\n\nsi_fit &lt;- fit_disc_gamma(tmp$si)\nsi_fit\n\n$mu\n[1] 11.51047\n\n$cv\n[1] 0.6686137\n\n$sd\n[1] 7.696056\n\n$ll\n[1] -6524.11\n\n$converged\n[1] TRUE\n\n$distribution\nA discrete distribution\n  name: gamma\n  parameters:\n    shape: 2.23691478711637\n    scale: 5.14568870945413\n\n\nWe can plot this gamma distribution to compare with the observed serial intervals data.\n\nsi_distr &lt;- data.frame(x = 0:max(tmp$si), y = dgamma(0:max(tmp$si), shape = si_fit$distribution$parameters$shape, scale = si_fit$distribution$parameters$scale))\n\n# Scale the density to compare with serial intervals histogram\nsi_distr$y &lt;- 4300 * si_distr$y\n\nggplot(tmp, aes(x = si)) +\n  geom_histogram(bins = 50, color = \"white\", fill = \"blue\", alpha = 0.4) +\n  geom_line(data = si_distr, aes(x = x, y = y)) +\n  labs(x = \"Serial intervals\", y = NULL) +\n  theme_minimal()",
    "crumbs": [
      "Reproduction number",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Generation interval</span>"
    ]
  },
  {
    "objectID": "gen-int.html#searching-for-serial-interval-distribution",
    "href": "gen-int.html#searching-for-serial-interval-distribution",
    "title": "9  Generation interval",
    "section": "9.4 Searching for serial interval distribution",
    "text": "9.4 Searching for serial interval distribution\n\nlibrary(epiparameter)\n\nStep 1. Load the database.\n\nepi_dist_db &lt;- epidist_db()\n\nReturning 122 results that match the criteria (99 are parameterised). \nUse subset to filter by entry variables or single_epidist to return a single entry. \nTo retrieve the citation for each use the 'get_citation' function\n\n\nStep 2. To see a full list of the diseases and distributions, use the parameter_tbl() function.\n\ndt &lt;- parameter_tbl(multi_epidist = epi_dist_db)\ndt\n\n\n  \n\n\n\nStep 3. Get the parameter of the disease you want.\n\nebola_si &lt;- epidist_db(\n  disease = \"Ebola\",\n  epi_dist = \"serial interval\"\n)\n\nReturning 4 results that match the criteria (4 are parameterised). \nUse subset to filter by entry variables or single_epidist to return a single entry. \nTo retrieve the citation for each use the 'get_citation' function\n\nebola_si\n\n# List of 4 &lt;epidist&gt; objects\nNumber of diseases: 1\n❯ Ebola Virus Disease\nNumber of epi distributions: 1\n❯ serial interval\n[[1]]\nDisease: Ebola Virus Disease\nPathogen: Ebola Virus\nEpi Distribution: serial interval\nStudy: WHO Ebola Response Team, Agua-Agum J, Ariyarajah A, Aylward B, Blake I,\nBrennan R, Cori A, Donnelly C, Dorigatti I, Dye C, Eckmanns T, Ferguson\nN, Formenty P, Fraser C, Garcia E, Garske T, Hinsley W, Holmes D,\nHugonnet S, Iyengar S, Jombart T, Krishnan R, Meijers S, Mills H,\nMohamed Y, Nedjati-Gilani G, Newton E, Nouvellet P, Pelletier L,\nPerkins D, Riley S, Sagrado M, Schnitzler J, Schumacher D, Shah A, Van\nKerkhove M, Varsaneux O, Kannangarage N (2015). \"West African Ebola\nEpidemic after One Year — Slowing but Not Yet under Control.\" _The New\nEngland Journal of Medicine_. doi:10.1056/NEJMc1414992\n&lt;https://doi.org/10.1056/NEJMc1414992&gt;.\nDistribution: gamma\nParameters:\n  shape: 2.188\n  scale: 6.490\n\n[[2]]\nDisease: Ebola Virus Disease\nPathogen: Ebola Virus\nEpi Distribution: serial interval\nStudy: WHO Ebola Response Team, Agua-Agum J, Ariyarajah A, Aylward B, Blake I,\nBrennan R, Cori A, Donnelly C, Dorigatti I, Dye C, Eckmanns T, Ferguson\nN, Formenty P, Fraser C, Garcia E, Garske T, Hinsley W, Holmes D,\nHugonnet S, Iyengar S, Jombart T, Krishnan R, Meijers S, Mills H,\nMohamed Y, Nedjati-Gilani G, Newton E, Nouvellet P, Pelletier L,\nPerkins D, Riley S, Sagrado M, Schnitzler J, Schumacher D, Shah A, Van\nKerkhove M, Varsaneux O, Kannangarage N (2015). \"West African Ebola\nEpidemic after One Year — Slowing but Not Yet under Control.\" _The New\nEngland Journal of Medicine_. doi:10.1056/NEJMc1414992\n&lt;https://doi.org/10.1056/NEJMc1414992&gt;.\nDistribution: gamma\nParameters:\n  shape: 4.903\n  scale: 3.161\n\n[[3]]\nDisease: Ebola Virus Disease\nPathogen: Ebola Virus\nEpi Distribution: serial interval\nStudy: WHO Ebola Response Team, Agua-Agum J, Ariyarajah A, Aylward B, Blake I,\nBrennan R, Cori A, Donnelly C, Dorigatti I, Dye C, Eckmanns T, Ferguson\nN, Formenty P, Fraser C, Garcia E, Garske T, Hinsley W, Holmes D,\nHugonnet S, Iyengar S, Jombart T, Krishnan R, Meijers S, Mills H,\nMohamed Y, Nedjati-Gilani G, Newton E, Nouvellet P, Pelletier L,\nPerkins D, Riley S, Sagrado M, Schnitzler J, Schumacher D, Shah A, Van\nKerkhove M, Varsaneux O, Kannangarage N (2015). \"West African Ebola\nEpidemic after One Year — Slowing but Not Yet under Control.\" _The New\nEngland Journal of Medicine_. doi:10.1056/NEJMc1414992\n&lt;https://doi.org/10.1056/NEJMc1414992&gt;.\nDistribution: gamma\nParameters:\n  shape: 2.068\n  scale: 7.301\n\n[[4]]\nDisease: Ebola Virus Disease\nPathogen: Ebola Virus\nEpi Distribution: serial interval\nStudy: WHO Ebola Response Team, Agua-Agum J, Ariyarajah A, Aylward B, Blake I,\nBrennan R, Cori A, Donnelly C, Dorigatti I, Dye C, Eckmanns T, Ferguson\nN, Formenty P, Fraser C, Garcia E, Garske T, Hinsley W, Holmes D,\nHugonnet S, Iyengar S, Jombart T, Krishnan R, Meijers S, Mills H,\nMohamed Y, Nedjati-Gilani G, Newton E, Nouvellet P, Pelletier L,\nPerkins D, Riley S, Sagrado M, Schnitzler J, Schumacher D, Shah A, Van\nKerkhove M, Varsaneux O, Kannangarage N (2015). \"West African Ebola\nEpidemic after One Year — Slowing but Not Yet under Control.\" _The New\nEngland Journal of Medicine_. doi:10.1056/NEJMc1414992\n&lt;https://doi.org/10.1056/NEJMc1414992&gt;.\nDistribution: gamma\nParameters:\n  shape: 1.898\n  scale: 6.532\n\n# ℹ Use `parameter_tbl()` to see a summary table of the parameters.\n# ℹ Explore database online at: https://epiverse-trace.github.io/epiparameter/articles/database.html\n\n\n\n\n\n\nCori, A., Ferguson, N. M., Fraser, C., & Cauchemez, S. (2013). A new framework and software to estimate time-varying reproduction numbers during epidemics. American Journal of Epidemiology, 178(9), 1505–1512. https://doi.org/10.1093/aje/kwt133\n\n\nGostic, K. M., McGough, L., Baskerville, E. B., Abbott, S., Joshi, K., Tedijanto, C., Kahn, R., Niehus, R., Hay, J. A., Salazar, P. M. D., Hellewell, J., Meakin, S., Munday, J. D., Bosse, N. I., Sherrat, K., Thompson, R. N., White, L. F., Huisman, J. S., Scire, J., … Cobey, S. (2020). Practical considerations for measuring the effective reproductive number, Rt. PLOS Computational Biology, 16(12), e1008409. https://doi.org/10.1371/journal.pcbi.1008409\n\n\nKenah, E., Lipsitch, M., & Robins, J. M. (2008). Generation interval contraction and epidemic data analysis. Mathematical Biosciences, 213(1), 71–79. https://doi.org/10.1016/j.mbs.2008.02.007\n\n\nSender, R., Bar-On, Y., Park, S. W., Noor, E., Dushoff, J., & Milo, R. (2022). The unmitigated profile of COVID-19 infectiousness. eLife, 11, e79134. https://doi.org/10.7554/eLife.79134",
    "crumbs": [
      "Reproduction number",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Generation interval</span>"
    ]
  },
  {
    "objectID": "r0.html",
    "href": "r0.html",
    "title": "10  Estimating \\(R_0\\)",
    "section": "",
    "text": "10.1 Contact tracing\nThis approach is based upon the definition of \\(R_0\\). Once an individual is diagnosed, his/her contacts are traced and tested. \\(R_0\\) is then computed by averaging over the number of secondary cases of many diagnosed individuals (Breban et al., 2007).",
    "crumbs": [
      "Reproduction number",
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>Estimating $R_0$</span>"
    ]
  },
  {
    "objectID": "r0.html#contact-tracing",
    "href": "r0.html#contact-tracing",
    "title": "10  Estimating \\(R_0\\)",
    "section": "",
    "text": "Contact tracing figure from (Bradshaw et al., 2021)",
    "crumbs": [
      "Reproduction number",
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>Estimating $R_0$</span>"
    ]
  },
  {
    "objectID": "r0.html#population-level",
    "href": "r0.html#population-level",
    "title": "10  Estimating \\(R_0\\)",
    "section": "10.2 Population-level",
    "text": "10.2 Population-level\n\n10.2.1 Exponential growth rate\nStep 1. Find an estimate for the mean generation time \\(T_g\\).\nStep 2. Identify the exponential phase of the epidemic curve: the period of which \\(\\log(\\text{incidence})\\) is linear.\nStep 3. Estimate the growth rate \\(r\\) for that phase by finding the slope from the linear regression on the \\(\\log(\\text{incidence})\\).\n\n\n\n\n\n\nProof\n\n\n\n\n\nSee Section 4 for more details. During the exponential phase, the incidence at time \\(t\\) is given by:\n\\[C_t = C_0 e^{rt}\\]\nTake the natural logarithm:\n\\[\\log C_t = log C_0 + rt\\]\nTherefore \\(r\\) is the slope from the linear regression on the \\(\\log(\\text{incidence})\\).\n\n\n\nStep 4. Given the exponential growth rate \\(r\\) and the \\(T_g\\), calculate the basic reproduction number:\n\nDiscrete generation:\n\n\\[R_0 = e^{rT_g}\\]\n\nIn an SIR model \\(T_g = \\frac{1}{\\gamma}\\) so:\n\n\\[R_0 \\approx 1 + rD = 1 + \\frac{r}{\\gamma}\\]\n\nIn an SEIR model \\(T_g = \\frac{1}{\\gamma} + \\frac{1}{\\sigma}\\) so:\n\n\\[R_0 \\approx (1 + rD)(1 + rL) = \\left( 1 + \\frac{r}{\\gamma} \\right) \\left( 1 + \\frac{r}{\\sigma} \\right)\\]\nIn which:\n\n\\(D\\) is the mean duration of the infectiousness.\n\\(L\\) is the mean duration of latency.\n\n\n\n10.2.2 Code\n\nlibrary(ggplot2)\nlibrary(patchwork)\n\nRead the data\n\ndf &lt;- read.csv(\"data/covid_uk.csv\")\n\nggplot(df, aes(x = day, y = inc)) +\n  geom_point() +\n  labs(x = \"Day\", y = \"Incidence\") +\n  theme_minimal()\n\n\n\n\n\n\n\n\nStep 1. Find an estimate for the mean generation time \\(T_g\\). Let say \\(T_g = D = 6.6\\) for COVID-19.\nStep 2. Identify the exponential phase of the epidemic curve: the period of which \\(\\log(\\text{incidence})\\) is linear.\n\ndf$loginc &lt;- log(df$inc)\n\np1 &lt;- ggplot(df, aes(x = day, y = inc)) +\n  geom_point() +\n  labs(x = NULL, y = \"Incidence\") +\n  theme_minimal()\n\np2 &lt;- ggplot(df, aes(x = day, y = loginc)) +\n  geom_point() +\n  labs(x = \"Day\", y = \"Log incidence\") +\n  theme_minimal()\n\np1 / p2\n\n\n\n\n\n\n\n\nLooks like day 1 to 21 is the exponential phase.\nStep 3. Estimate the growth rate \\(r\\) for that phase by finding the slope from the linear regression on the \\(\\log(\\text{incidence})\\).\n\nmod &lt;- lm(loginc ~ day, data = df[1:21,])\npred &lt;- data.frame(day = 1:21, loginc = predict(mod, data = df[1:21,]))\n\nggplot(df, aes(x = day, y = loginc)) +\n  geom_point() +\n  geom_line(data = pred, color = \"blue\") +\n  labs(x = \"Day\", y = \"Log incidence\") +\n  theme_minimal()\n\n\n\n\n\n\n\n\nLook at the linear regression:\n\nsummary(mod)\n\n\nCall:\nlm(formula = loginc ~ day, data = df[1:21, ])\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-1.45946 -0.32865 -0.05379  0.36148  0.98657 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept) -0.38285    0.25339  -1.511    0.147    \nday          0.30705    0.02018  15.216 4.28e-12 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.56 on 19 degrees of freedom\nMultiple R-squared:  0.9242,    Adjusted R-squared:  0.9202 \nF-statistic: 231.5 on 1 and 19 DF,  p-value: 4.28e-12\n\n\nThe slope is 0.3070509.\nStep 4. Given the exponential growth rate \\(r\\) and the \\(T_g\\), calculate the basic reproduction number.\nDiscrete generation: \\(R_0 = e^{rT_g}\\)\n\nexp(unname(mod$coefficients[2]) * 6.6)\n\n[1] 7.587758\n\n\nSIR model: \\(R_0 \\approx 1 + rD\\)\n\n1 + unname(mod$coefficients[2]) * 6.6\n\n[1] 3.026536\n\n\n\n\n\n\n\n\nNote\n\n\n\n\\(R_0\\) estimates are affected by the mean, variance and shape of the generation time distribution.\n\nA larger mean \\(T_g\\) leads to larger \\(R_0\\).\nFor the 2 models with the same mean but different distributions \\(T_g\\), \\(R_0\\) estimates are different:\n\nDiscrete generation assumes a uniform \\(T_g\\).\nSIR model assumes an exponential \\(T_g\\).\n\n\n\n\nPackage R0 provide a ready-to-use function est.R0.EG() to estimate \\(R_0\\) using exponential growth rate method. We can define different shape of \\(T_g\\), let try a \\(\\Gamma(6.6, 4)\\):\n\nlibrary(R0)\ngt &lt;- generation.time(\"gamma\", c(6.6, 4))\nplot(gt)\n\n\n\n\n\n\n\n\nNow compute \\(R_0\\):\n\nest.R0.EG(df$inc, gt, begin = 1, end = 21)\n\nWaiting for profiling to be done...\n\n\nReproduction number estimate using  Exponential Growth  method.\nR :  3.949484[ 3.716905 , 4.198451 ]\n\n\n\n\n10.2.3 Simple compartmental models\nConsider a simple closed population SIR model.\n\\[\\begin{align} \\frac{dS}{dt} & = -\\beta SI \\\\ \\frac{dI}{dt} & = \\beta SI - \\gamma I\\\\ \\frac{dR}{dt} & = \\gamma I \\end{align}\\]\nFocusing on the \\(I\\) equation:\n\\[\\frac{dI}{dt} = \\beta SI - \\gamma I = I (\\beta S - \\gamma)\\]\nA disease spreads when:\n\\[\\begin{align} \\frac{dI}{dt} & &gt; 0 \\\\ \\Leftrightarrow I (\\beta S - \\gamma) & &gt; 0 \\\\ \\Leftrightarrow \\beta S - \\gamma & &gt; 0 \\\\ \\Leftrightarrow \\beta S & &gt; \\gamma \\\\ \\Leftrightarrow \\frac{\\beta S}{\\gamma} & &gt; 1 \\end{align}\\]\nThis leads to the definition of \\(R_0\\). By Definition 1, \\(R_0\\) is the \\(R\\) in a fully susceptible population \\(S_0\\):\n\\[R_0 = \\frac{\\beta S_0}{\\gamma}\\]\nTherefore:\n\n\\(R_0 &gt; 1\\) meaning that \\(\\frac{dI}{dt} &gt; 0\\), then the disease will spread.\n\\(R_0 &lt; 1\\) meaning that \\(\\frac{dI}{dt} &lt; 0\\), then no epidemic occurs.\n\nFor more complex compartmental models, especially those with more infected compartments, as proposed by (Diekmann et al., 1990) and (Driessche & Watmough, 2002), \\(R_0\\) can be determined using the next generation matrix (Driessche, 2017).\n\n\n10.2.4 Next generation matrix\n\\(R_0\\) is the maximum absolute eigenvalue (also called the spectral radius) of the next generation matrix (NGM) (Driessche, 2017).\nConsider an SEIR model with equal birth and death rate \\(\\mu\\).\n\\[\\begin{align} \\frac{dS}{dt} & = \\mu (S + E + I + R) -\\beta SI - \\mu S \\\\ \\frac{dE}{dt} & = \\beta SI - \\sigma E - \\mu E \\\\ \\frac{dI}{dt} & = \\sigma E - \\gamma I - \\mu I \\\\ \\frac{dR}{dt} & = \\gamma I - \\mu R \\end{align}\\]\nStep 1. Identify the infected compartments\nFor our SEIR model, the infected compartments are \\(E\\) and \\(I\\).\nStep 2. Write the NGM functions\n\n\\(\\mathcal{F}_i(x)\\): is the rate of appearance of new infections in compartment \\(i\\) (Driessche, 2017) (caused by contact).\n\\(\\mathcal{V}_i(x)\\): is the rate of other transitions between compartment \\(i\\) and other infected compartments (Driessche, 2017) (caused by transition between compartments).\n\nFor our SEIR model, we would write \\(\\mathcal{F}\\) and \\(\\mathcal{V}\\) as follows:\n\n\n\\[\\mathcal{F} = \\begin{bmatrix} \\beta SI \\\\ 0 \\end{bmatrix}\\] \\(\\mathcal{F}\\) is a vector contains of \\(\\begin{bmatrix} \\mathcal{F}_1 \\\\ \\mathcal{F}_2 \\end{bmatrix}\\):\n\n\\(\\mathcal{F}_1 = \\beta SI\\): the rate of new infections (caused by contact) in compartment \\(E\\).\n\\(\\mathcal{F}_2 = 0\\): as there is no new infections (caused by contact) in compartment \\(I\\).\n\n\n\\[\\mathcal{V} = \\begin{bmatrix} \\sigma E + \\mu E \\\\ - \\sigma E + \\gamma I + \\mu I \\end{bmatrix}\\]\n\\(\\mathcal{V}\\) is a vector contains of \\(\\begin{bmatrix} \\mathcal{V}_1 \\\\ \\mathcal{V}_2 \\end{bmatrix}\\):\n\n\\(\\mathcal{V}_1 = \\sigma E + \\mu E\\): is the rate of other transitions to and from compartment \\(E\\).\n\\(\\mathcal{V}_2 = - \\sigma E + \\gamma I + \\mu I\\): is the rate of other transitions to and from compartment \\(I\\).\n\n\n\n\\(\\mathcal{F}\\) and \\(\\mathcal{V}\\) are written such that:\n\\[\\frac{dx}{dt} = \\mathcal{F} - \\mathcal{V}\\]\nHere we have:\n\\[\\frac{dE}{dt} = \\mathcal{F}_1 - \\mathcal{V}_1 = \\beta SI - (\\sigma E + \\mu E)\\]\n\\[\\frac{dI}{dt} = \\mathcal{F}_2 - \\mathcal{V}_2 = 0 - (- \\sigma E + \\gamma I + \\mu I)\\]\nStep 3. Find the Jacobian matrix\nJacobian matrix \\(F\\) for \\(\\mathcal{F}\\), and \\(V\\) for \\(\\mathcal{V}\\). Jacobian matrix is a matrix contain all partial derivatives of a vector function.\n\\[\\begin{align} F & = \\begin{bmatrix} \\frac{\\partial \\mathcal{F}_1}{\\partial E} & \\frac{\\partial \\mathcal{F}_1}{\\partial I} \\\\ \\frac{\\partial \\mathcal{F}_2}{\\partial E} & \\frac{\\partial \\mathcal{F}_2}{\\partial I} \\end{bmatrix} \\\\ & = \\begin{bmatrix} \\frac{\\partial [\\beta SI]}{\\partial E} & \\frac{\\partial [\\beta SI]}{\\partial I} \\\\ \\frac{\\partial [0]}{\\partial E} & \\frac{\\partial [0]}{\\partial I} \\end{bmatrix} \\\\ & = \\begin{bmatrix} 0 & \\beta S \\\\ 0 & 0 \\end{bmatrix} \\end{align}\\]\nIn which:\n\n\\(\\frac{\\partial [\\beta SI]}{\\partial E} = 0\\): because there is no \\(E\\) in \\(\\beta SI\\).\n\\(\\frac{\\partial [\\beta SI]}{\\partial I} = \\beta S\\).\n\n\\[\\begin{align} V & = \\begin{bmatrix} \\frac{\\partial \\mathcal{V}_1}{\\partial E} & \\frac{\\partial \\mathcal{V}_1}{\\partial I} \\\\ \\frac{\\partial \\mathcal{V}_2}{\\partial E} & \\frac{\\partial \\mathcal{V}_2}{\\partial I} \\end{bmatrix} \\\\ & = \\begin{bmatrix} \\frac{\\partial [\\sigma E + \\mu E]}{\\partial E} & \\frac{\\partial [\\sigma E + \\mu E]}{\\partial I} \\\\ \\frac{\\partial [- \\sigma E + \\gamma I + \\mu I]}{\\partial E} & \\frac{\\partial [- \\sigma E + \\gamma I + \\mu I]}{\\partial I} \\end{bmatrix} \\\\ & = \\begin{bmatrix} \\sigma + \\mu & 0 \\\\ - \\sigma & \\gamma + \\mu \\end{bmatrix} \\end{align}\\]\nStep 4. Compute the NGM\nUse Definition A.6 to compute inverse matrix \\(V^{-1}\\):\n\\[\\begin{align} V^{-1} & = \\frac{1}{(\\sigma + \\mu)(\\gamma + \\mu)} \\begin{bmatrix} \\gamma + \\mu & - 0 \\\\ - \\sigma & \\sigma + \\mu \\end{bmatrix} \\\\& = \\begin{bmatrix} \\frac{1}{\\sigma + \\mu} & 0 \\\\ \\frac{\\sigma}{(\\sigma + \\mu)(\\gamma + \\mu)} & \\frac{1}{\\gamma + \\mu} \\end{bmatrix} \\end{align}\\]\n\\[\\begin{align} K & = FV^{-1} \\\\ & = \\begin{bmatrix} 0 & \\beta S \\\\ 0 & 0 \\end{bmatrix} \\begin{bmatrix} \\frac{1}{\\sigma + \\mu} & 0 \\\\ \\frac{\\sigma}{(\\sigma + \\mu)(\\gamma + \\mu)} & \\frac{1}{\\gamma + \\mu} \\end{bmatrix} \\\\ & = \\begin{bmatrix} \\frac{\\beta S \\sigma}{(\\sigma + \\mu)(\\gamma + \\mu)} & \\frac{\\beta S}{\\gamma + \\mu} \\\\ 0 & 0 \\end{bmatrix} \\end{align}\\]\n\n\n\n\n\n\nWhat is a next generation matrix?\n\n\n\n\n\nSource: quantpie’s video.\nA population consists of two groups: young and old.\n\nA young person on average infects 3 young and 2 old: \\(\\begin{bmatrix} 3 \\\\ 2 \\end{bmatrix}\\).\nAn old person on average infects 1 young and 2 old: \\(\\begin{bmatrix} 1 \\\\ 2 \\end{bmatrix}\\).\n\nEach group becomes a column in the next generation matrix (NGM):\n\\[\\text{NGM} = \\begin{bmatrix} 3 & 1 \\\\ 2 & 2 \\end{bmatrix}\\]\n\\(R_0\\) is the root of equation:\n\\[\\begin{align} \\begin{bmatrix} 3 - \\lambda & 1 \\\\ 2 & 2 - \\lambda \\end{bmatrix} & = 0 \\\\ \\Leftrightarrow (3 - \\lambda) \\times (2 - \\lambda) - 2 \\times 1 & = 0 \\\\ \\Leftrightarrow \\lambda^2 - 5 \\lambda + 6 - 2 & = 0 \\\\ \\Leftrightarrow \\lambda^2 - 5 \\lambda + 4 & = 0 \\end{align}\\]\nThere are two roots \\(\\lambda = 4\\) and \\(\\lambda = 1\\), for an outbreak to occur \\(R_0 &gt; 1\\), so here \\(R_0 = 4\\).\n\n\n\nStep 5. Compute \\(R_0\\)\n\\(R_0\\) is the eigenvalues of the NGM.\n\\[\\begin{align} det(K - \\lambda) & = \\begin{bmatrix} \\frac{\\beta S \\sigma}{(\\sigma + \\mu)(\\gamma + \\mu)} - \\lambda & \\frac{\\beta S}{\\gamma + \\mu} \\\\ 0 & 0 - \\lambda \\end{bmatrix} \\\\ & = [\\frac{\\beta S \\sigma}{(\\sigma + \\mu)(\\gamma + \\mu)} - \\lambda][0 - \\lambda] \\end{align}\\]\n\\[R_0 = \\frac{\\beta S \\sigma}{(\\sigma + \\mu)(\\gamma + \\mu)}\\]\n\n\n\n\n\n\nUse NGM to compute \\(R_0\\) for SIR model\n\n\n\n\n\nConsider a simple closed population SIR model.\n\\[\\begin{align} \\frac{dS}{dt} & = -\\beta SI \\\\ \\frac{dI}{dt} & = \\beta SI - \\gamma I\\\\ \\frac{dR}{dt} & = \\gamma I \\end{align}\\]\nStep 1. Identify the infected compartments\nFor our SIR model, the infected compartment is \\(I\\).\nStep 2. Write the NGM functions\n\\[\\mathcal{F} = \\beta SI\\]\n\\[\\mathcal{V} = \\gamma I\\]\nSuch that we have:\n\\[\\frac{dI}{dt} = \\mathcal{F} - \\mathcal{V} = \\beta SI - \\gamma I\\]\nStep 3. Find the Jacobian matrix\n\\[F = \\frac{\\partial \\mathcal{F}}{\\partial I} = \\frac{\\partial [\\beta SI]}{\\partial I} = \\beta S\\]\n\\[V = \\frac{\\partial \\mathcal{V}}{\\partial I} = \\frac{\\partial [\\gamma I]}{\\partial I} = \\gamma\\]\nStep 4 and 5. Compute the NGM and \\(R_0\\)\n\\[V^{-1} = \\gamma^{-1} = \\frac{1}{\\gamma}\\]\n\\[K = FV^{-1} = \\frac{\\beta S}{\\gamma}\\]\nHere we also have \\(R_0\\).\n\\[R_0 = \\frac{\\beta S}{\\gamma}\\]",
    "crumbs": [
      "Reproduction number",
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>Estimating $R_0$</span>"
    ]
  },
  {
    "objectID": "r0.html#epidemic-final-size",
    "href": "r0.html#epidemic-final-size",
    "title": "10  Estimating \\(R_0\\)",
    "section": "10.3 Epidemic final size",
    "text": "10.3 Epidemic final size\nIf there were no interventions or changes in behavior, the proportion of the population infected during the entire course of an epidemic would be approximately the non-zero solution of the equation:\n$$$$\n\n\n\n\nBradshaw, W. J., Alley, E. C., Huggins, J. H., Lloyd, A. L., & Esvelt, K. M. (2021). Bidirectional contact tracing could dramatically improve COVID-19 control. Nature Communications, 12(1), 232. https://doi.org/10.1038/s41467-020-20325-7\n\n\nBreban, R., Vardavas, R., & Blower, S. (2007). Theory versus Data: How to Calculate R0? PLOS ONE, 2(3), e282. https://doi.org/10.1371/journal.pone.0000282\n\n\nDiekmann, O., Heesterbeek, J. A. P., & Metz, J. A. J. (1990). On the definition and the computation of the basic reproduction ratio R0 in models for infectious diseases in heterogeneous populations. Journal of Mathematical Biology, 28(4), 365–382. https://doi.org/10.1007/BF00178324\n\n\nDriessche, P. van den. (2017). Reproduction numbers of infectious disease models. Infectious Disease Modelling, 2(3), 288–303. https://doi.org/10.1016/j.idm.2017.06.002\n\n\nDriessche, P. van den, & Watmough, J. (2002). Reproduction numbers and sub-threshold endemic equilibria for compartmental models of disease transmission. Mathematical Biosciences, 180(1), 29–48. https://doi.org/10.1016/S0025-5564(02)00108-6\n\n\nPandit, J. J. (2020). Managing the R0 of COVID-19: mathematics fights back. Anaesthesia, 75(12), 1643–1647. https://doi.org/10.1111/anae.15151",
    "crumbs": [
      "Reproduction number",
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>Estimating $R_0$</span>"
    ]
  },
  {
    "objectID": "rt.html",
    "href": "rt.html",
    "title": "11  Estimating \\(R_t\\)",
    "section": "",
    "text": "11.1 Instantaneous reproduction number \\(R_t^i\\)",
    "crumbs": [
      "Reproduction number",
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>Estimating $R_t$</span>"
    ]
  },
  {
    "objectID": "rt.html#instantaneous-reproduction-number-r_ti",
    "href": "rt.html#instantaneous-reproduction-number-r_ti",
    "title": "11  Estimating \\(R_t\\)",
    "section": "",
    "text": "Definition 11.1 The instantaneous reproduction number is the expected number of secondary infections occurring at time \\(t\\), divided by the number of infected individuals, each scaled by their relative infectiousness at time \\(t\\) (an individual’s relative infectiousness is based on the generation interval and time since infection) (Gostic et al., 2020).\n\n\n11.1.1 Exact calculation\nFor a compartmental model (SIR or SEIR), \\(R_t^i\\) can be calculated exactly as (Gostic et al., 2020):\n\\[R_t^i = \\beta(t) S(t) D\\]\n\n\\(\\beta(t)\\): the time-varying transmission rate.\n\\(S(t)\\): the fraction of the population that is susceptible.\n\\(D\\): the mean duration of infectiousness.\n\n\n\n11.1.2 Cori method\n\\[R_t^i = \\frac{I_t}{\\sum_{s = 1}^{t} I_{t - s} w_s}\\]\n\n\\(I_t\\): the number of infection on day \\(t\\).\n\\(I_{t - s}\\): the number of individuals who became infected \\(s\\) days in the past.\n\\(w_s\\): the infectivity profile, describes how infectious an individual is \\(s\\) days since infection, \\(w_s\\) dependent on time since infection \\(s\\) but independent of calendar time \\(t\\), and often be approximated by the generation interval (Cori et al., 2013).\n\\(I_{t - s} w_s\\): we scale the number of individuals who became infected \\(s\\) days in the past by how infectiousness are they still on day \\(t\\) (which is \\(s\\) days after the date they got infected, \\(w_s\\)).\n\nLooking back at Definition 11.1, \\(R_t^i\\) is the expected number of secondary infections occurring at time \\(t\\) (\\(I_t\\)), divided by the number of infected individuals (\\(\\sum_{s = 1}^{t} I_{t - s}\\)), each scaled by their relative infectiousness at time \\(t\\) (\\(w_s\\)).\nThe only parametric assumption required by this method is the form of the generation interval. The standard assumption is that \\(w_s\\) follows a discretized gamma distribution, but any parametric or empirical discrete distribution also work (Gostic et al., 2020).\n\n\n\n\n\n\nProofs\n\n\n\n\n\nThe renewal equation (also called the Euler-Lotka equation (Wallinga & Lipsitch, 2006)) is a cornerstone of demographic theory and backbone of the \\(R_t\\) estimators.\n\\[b(t) = \\int_{a = 0}^{\\infty} b(t - a) n(a) da\\]\n\n\\(b(t)\\): the number of female offspring at time \\(t\\).\n\\(b(t - a)\\): the number of mothers of age \\(a\\) at time \\(t\\), which is equal to the number of female offspring at time \\(t - a\\).\n\\(n(a)\\): the birth ability of mothers of age \\(a\\), scaled by the probability of surviving to age \\(a\\).\n\\(\\int_{a = 0}^{\\infty}\\): summing these female offspring over all possible mothers’ ages, we obtain the total number of female offspring at time \\(t\\) which is \\(b(t)\\).\n\nThis equation assume that the population displays exponential growth at a fixed growth rate and that the age distribution of the population does not change over time (Wallinga & Lipsitch, 2006).\nTo describe epidemic dynamics, the renewal equation is expressed in terms of \\(I(t)\\).\n\\[I(t) = R_0 S(t) \\int_{s = 0}^{\\infty} I(t - s) w_s ds\\]\n\n\\(R_0 S(t) = R_t\\): see Definition 3.\n\\(I(t - s)\\): the number of individuals who became infected \\(s\\) time points ago in the past.\n\\(w_s\\): the infectivity profile, or the probability of how infectiousness are they still at time \\(t\\) (which is \\(s\\) time points after the date they got infected).\n\\(I(t - s) w_s\\): we scale the number of individuals who in the past by how infectiousness are they still at time \\(t\\).\n\nNow we transform the equation a bit, and we got something very similar to the Cori method (see Section 11.1.2).\n\\[R_t = \\frac{I(t)}{\\int_{s = 0}^{\\infty} I(t - s) w_s ds}\\]\n\n\n\n\n\n11.1.3 When can we start estimating \\(R_t^i\\)?\nCori et al. suggest starting estimating \\(R_t^i\\) once those three criteria are fulfilled (Cori et al., 2013):\n\nAt least after the sliding window size.\nAt least after one mean serial interval.\nAt least 12 cases (the initial case + 11) have been observed since the beginning of the epidemic (in a time window): to get a posterior credible interval of 0.3, the time window must comprise at least 11 incident cases.\n\n\n\n11.1.4 Key considerations\nSource: Dr. Anne Cori’s webinar.\n\nTemporal resolution: we can’t apply the \\(R_t^i\\) method when the time step of observation is too large (&gt; mean generation interval).\nSpatial resolution: ideally use a spatial scale that you can distinguish locally infected cases from imported cases.\n\\(R_t^i\\) is very sensitive to the size of the sliding window: small windows can lead to highly variable estimates with wide credible intervals, whereas longer windows lead to smoothed estimates with narrower credible intervals. Perhaps also consider at least 11 incident cases in a sliding window to get a posterior credible interval of 0.3 (Cori et al., 2013).",
    "crumbs": [
      "Reproduction number",
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>Estimating $R_t$</span>"
    ]
  },
  {
    "objectID": "rt.html#case-reproduction-number-r_tc",
    "href": "rt.html#case-reproduction-number-r_tc",
    "title": "11  Estimating \\(R_t\\)",
    "section": "11.2 Case reproduction number \\(R_t^c\\)",
    "text": "11.2 Case reproduction number \\(R_t^c\\)\n\nDefinition 11.2 The case or cohort reproduction number is the expected number of secondary infections that an individual who becomes infected at time \\(t\\) will eventually cause as they progress through their infection (Gostic et al., 2020).\n\n\n11.2.1 Exact calculation\n\\[R_t^c = \\int_{u = t}^{\\infty} R_u^i w_{u-t} du\\]\n\n\\(R_u^i\\): the instantaneous reproduction number of current infected cases at time \\(u\\), starting from \\(t\\) to the end of their infectious period \\(\\infty\\).\n\\(w_{u-t}\\): the infectiousness of them at that time.\n\n\n\n11.2.2 Wallinga and Teunis method\nThere are 3 steps (Gostic et al., 2020):\nStep 1. Estimate the likelihood that case \\(j\\) (infected at time \\(t_j\\)) infected case \\(i\\) (at time \\(t_i\\)).\n\\[p_{ij} = \\frac{w_{t_i - t_j}}{\\sum_{i \\neq k} w_{t_i - t_k}}\\]\n\n\\(\\sum_{i \\neq k} w_{t_i - t_k}\\): sum of the infectiousness of all cases (other than \\(i\\)) infects case \\(i\\).\n\nStep 2. Compute the individual reproduction number of case \\(j\\).\n\\[R_j = \\sum_i p_{ij}\\]\nStep 3. Compute the case reproduction number at time \\(t\\), it is the expected value of \\(R_j\\) for all individuals infected at time \\(t\\).\n\\[R_t^c = \\mathbb{E}(R_j)\\]",
    "crumbs": [
      "Reproduction number",
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>Estimating $R_t$</span>"
    ]
  },
  {
    "objectID": "rt.html#compare-r_ti-and-r_tc",
    "href": "rt.html#compare-r_ti-and-r_tc",
    "title": "11  Estimating \\(R_t\\)",
    "section": "11.3 Compare \\(R_t^i\\) and \\(R_t^c\\)",
    "text": "11.3 Compare \\(R_t^i\\) and \\(R_t^c\\)\nThere are several important differences (Gostic et al., 2020):\n\nInstantaneous \\(R_t^i\\) is real-time estimation and only use data from before time \\(t\\), while case \\(R_t^c\\) is inherently forward-looking.\n\n\nInstantaneous \\(R_t^i\\) overestimates \\(R_t\\) early in the time series, because any infections that occurred before the first observed date are missing terms in the denominator (the \\(I_{t - s}\\) in Section 11.1.2, data is left-truncated at the beginning).\nCase \\(R_t^c\\) underestimates \\(R_t\\) at the end of the time series, because it relies on time points not yet observed which become missing terms in the integral (the \\(R_u^i\\) in Section 11.2.1, data is right-truncated at the end).\n\n\nCase \\(R_t^c\\) is shifted forward in time relative to instantaneous \\(R_t^i\\), produces leading estimates of \\(R_t\\) because it uses data from time points after \\(t\\), whereas the \\(R_t^i\\) uses data from time points before \\(t\\).\n\n\n\n\n\n\n\nImportant\n\n\n\nOverall, for real-time analyses aiming to infer the impact of changes in policy, behavior, or other extrinsic factors on transmission, the instantaneous reproductive number will provide more temporally accurate estimates and is most appropriate.",
    "crumbs": [
      "Reproduction number",
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>Estimating $R_t$</span>"
    ]
  },
  {
    "objectID": "rt.html#potential-biases",
    "href": "rt.html#potential-biases",
    "title": "11  Estimating \\(R_t\\)",
    "section": "11.4 Potential biases",
    "text": "11.4 Potential biases\n\\(R_t\\) is a value in specific time, therefore there are 2 potential forms of bias in \\(R_t\\) estimates (Gostic et al., 2020):\n\nAccuracy (the value): Systematic over- or underestimation caused by misspecification of the generation interval. Mostly impact when \\(R_t\\) is substantially &gt; 1 (e.g., the beginning of COVID-19 when \\(R_t\\) is relatively high) or &lt; 1 (e.g., after a very effective intervention then \\(R_t\\) might be low).\nTimeliness (the time): Temporal inaccuracy that \\(R_t\\) estimates may be leading or lagging the true date, has several possible causes and can be difficult to avoid.\n\n\n11.4.1 Generation interval\nSee Definition 9.1 to recall the definition of generation interval.\n\n\nBiases from misspecification of the generation interval mean (A) or variance (B) (Gostic et al., 2020).\n\n\nIf mean generation interval is set too high, \\(R_t\\) will be more extreme (too high when true \\(R_t &gt; 1\\) and too low when true \\(R_t &lt; 1\\)).\nIf mean generation interval is set too low, \\(R_t\\) will be closer to 1 than the true value.\nThe effect of the mean generation interval is large when true \\(R_t\\) further from 1. Therefore, this bias may be greatest at the early epidemic, when true \\(R_t\\) is high, together with highly uncertain generation interval and limited data.\n\nTools like EpiEstim and EpiNow2 allow users to specify the prior variance of the mean and standard deviation. However, bear in mind that uncertainty around an incorrect generation interval only widen the 95% credible interval, but will not shift the estimates toward the truth and will not correct this bias.\n\n\n11.4.2 Delays\n\n\nAdjusting for delays (Gostic et al., 2020).\n\nIf \\(d\\) is the delay from infection to observation, then observations at time \\(t\\) inform \\(R_{t − d}\\), not \\(R_t\\).\nIf the distribution of delays can be estimated, then \\(R_t\\) can be estimated in 2 steps:\n\nInfer the underlying time series of infections.\nInput the adjusted time series into an \\(R_t\\) estimation method.",
    "crumbs": [
      "Reproduction number",
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>Estimating $R_t$</span>"
    ]
  },
  {
    "objectID": "rt.html#code",
    "href": "rt.html#code",
    "title": "11  Estimating \\(R_t\\)",
    "section": "11.5 Code",
    "text": "11.5 Code\n\n11.5.1 EpiEstim\n\nlibrary(EpiEstim)\nlibrary(ggplot2)\n\nThe input data\n\ndata(Flu2009)\n\ndf &lt;- Flu2009$incidence\nhead(df)\n\n\n  \n\n\n\nLet have a look at the data.\n\nggplot(df, aes(x = dates, y = I)) +\n  geom_point() +\n  labs(x = \"Day\", y = \"Incidence\") +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\n11.5.1.1 \n\nmod &lt;- estimate_R(\n  incid = df, \n  method = \"parametric_si\", \n  config = make_config(\n    list(\n      mean_si = 2.6, \n      std_si = 1.5\n    )\n  )\n)\n\nDefault config will estimate R on weekly sliding windows.\n    To change this change the t_start and t_end arguments. \n\n\nNoted that the default config will estimate R on weekly sliding windows (day 2 to day 8).\n\nhead(mod$R)\n\n\n  \n\n\n\n\nplot(mod)\n\n\n\n\n\n\n\n\n\ntmp &lt;- df[df$dates &lt; as.Date(\"2009-05-11\"),]\nmod &lt;- estimate_R(\n  incid = tmp, \n  method = \"parametric_si\", \n  config = make_config(\n    list(\n      mean_si = 2.6, \n      std_si = 1.5\n    )\n  )\n)\n\nDefault config will estimate R on weekly sliding windows.\n    To change this change the t_start and t_end arguments. \n\nhead(mod$R)\n\n\n  \n\n\nplot(mod)\n\n\n\n\n\n\n\n\n\n\n\n11.5.2 EpiNow2\n\n\n\n\nCori, A., Ferguson, N. M., Fraser, C., & Cauchemez, S. (2013). A new framework and software to estimate time-varying reproduction numbers during epidemics. American Journal of Epidemiology, 178(9), 1505–1512. https://doi.org/10.1093/aje/kwt133\n\n\nGostic, K. M., McGough, L., Baskerville, E. B., Abbott, S., Joshi, K., Tedijanto, C., Kahn, R., Niehus, R., Hay, J. A., Salazar, P. M. D., Hellewell, J., Meakin, S., Munday, J. D., Bosse, N. I., Sherrat, K., Thompson, R. N., White, L. F., Huisman, J. S., Scire, J., … Cobey, S. (2020). Practical considerations for measuring the effective reproductive number, Rt. PLOS Computational Biology, 16(12), e1008409. https://doi.org/10.1371/journal.pcbi.1008409\n\n\nWallinga, J., & Lipsitch, M. (2006). How generation intervals shape the relationship between growth rates and reproductive numbers. Proceedings of the Royal Society B: Biological Sciences, 274(1609), 599–604. https://doi.org/10.1098/rspb.2006.3754",
    "crumbs": [
      "Reproduction number",
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>Estimating $R_t$</span>"
    ]
  },
  {
    "objectID": "intv.html",
    "href": "intv.html",
    "title": "Interventions",
    "section": "",
    "text": "Interventions that can be modelled",
    "crumbs": [
      "Interventions"
    ]
  },
  {
    "objectID": "intv.html#interventions-that-can-be-modelled",
    "href": "intv.html#interventions-that-can-be-modelled",
    "title": "Interventions",
    "section": "",
    "text": "Vaccination: Transmission models are needed to capture nonlinear effects of vaccination, resulting from the potential of vaccines to protect not only directly vaccinated individuals but also their contacts.\nScreening: Identifies infected individuals for early treatment, preventing disease progression and further transmission. Models should include transmission dynamics if early detection affects transmissibility.\nSocial distancing: Planned responses to large outbreaks such as isolation of suspected cases, school closures, travel restrictions and cancellation of mass gatherings (football matches). Their benefit depends crucially on interaction frequency and types among different age groups and settings (families, workplaces, schools).\nPost-exposure treatment. Chemotreatment options such as antimicrobials, can use static models unless they affect an individual’s transmissibility or a transmittable characteristic of the infection.\nCulling: For animal and plant diseases, culling reduces host populations by removing infected and at-risk healthy livestock. Models assess the trade-off between reduced transmission and the loss of animals or plants.",
    "crumbs": [
      "Interventions"
    ]
  },
  {
    "objectID": "ftc.html",
    "href": "ftc.html",
    "title": "12  Flattening the curve",
    "section": "",
    "text": "12.1 Shock-intervention\nAssuming your intervention will effective immediately reduce the contacts by a constant factor.",
    "crumbs": [
      "Interventions",
      "<span class='chapter-number'>12</span>  <span class='chapter-title'>Flattening the curve</span>"
    ]
  },
  {
    "objectID": "vax.html",
    "href": "vax.html",
    "title": "13  Vaccination",
    "section": "",
    "text": "13.1 Vaccines",
    "crumbs": [
      "Interventions",
      "<span class='chapter-number'>13</span>  <span class='chapter-title'>Vaccination</span>"
    ]
  },
  {
    "objectID": "vax.html#vaccines",
    "href": "vax.html#vaccines",
    "title": "13  Vaccination",
    "section": "",
    "text": "13.1.1 Definition\nA vaccine is a biological product that can be used to safely induce an immune response that confers protection against infection and/or disease on subsequent exposure to a pathogen (Pollard & Bijker, 2021).\n\n\n13.1.2 Classification\nOver the past few decades, new vaccine platforms have been developed including viral vectors, nucleic acid-based RNA and DNA vaccines, and virus-like particles. However, traditionally vaccines are classified as live or non-live:\n\nLive:\n\n\nAre developed so that, in an immunocompetent host, they replicate sufficiently to produce a strong immune response, but not so much as to cause significant disease manifestations.\nTrade-off between strong immune response and avoid symptomatic disease, therefore some live attenuated vaccines require multiple doses and induce relatively short-lived immunity. For example, 5% of children will develop a rash and up to 15% fever after measles vaccination\nPotentially replicate in an uncontrolled manner in immuno-compromised individuals.\nExamples: measles, mumps, rubella and rotavirus, oral polio vaccine, the Mycobacterium bovis bacillus Calmette–Guérin (BCG) vaccine for TB and live attenuated influenza vaccine\n\n\nNon-live: no risk to immunocompromised individuals (although may not confer protection in those with B cell or combined immunodeficiency).\n\nB cells\n\nProduce antibodies (humoral immunity).\n\nT cells\n\nDirectly attack infected cells (cellular immunity).\n\n\nKiller (cytotoxic):\nHelper: subtypes by profiles of cytokine production",
    "crumbs": [
      "Interventions",
      "<span class='chapter-number'>13</span>  <span class='chapter-title'>Vaccination</span>"
    ]
  },
  {
    "objectID": "vax.html#innate-vs-adaptive-immune-system",
    "href": "vax.html#innate-vs-adaptive-immune-system",
    "title": "13  Vaccination",
    "section": "13.2 Innate vs adaptive immune system",
    "text": "13.2 Innate vs adaptive immune system",
    "crumbs": [
      "Interventions",
      "<span class='chapter-number'>13</span>  <span class='chapter-title'>Vaccination</span>"
    ]
  },
  {
    "objectID": "vax.html#prevent-infection-vs-disease",
    "href": "vax.html#prevent-infection-vs-disease",
    "title": "13  Vaccination",
    "section": "13.3 Prevent infection vs disease",
    "text": "13.3 Prevent infection vs disease\nSome evidence showed that BCG vaccine can prevent both infection and disease (Pollard & Bijker, 2021).\n\nInfection: BCG-vaccinated children had a memory T-cell response to infection, as indicated by a positive interferon-\\(\\gamma\\) release assay.\nDisease: BCG vaccination reduces the spread of M. tuberculosis bacteria in the blood, mediated by T-cell immunity.",
    "crumbs": [
      "Interventions",
      "<span class='chapter-number'>13</span>  <span class='chapter-title'>Vaccination</span>"
    ]
  },
  {
    "objectID": "vax.html#non-specific-effects",
    "href": "vax.html#non-specific-effects",
    "title": "13  Vaccination",
    "section": "13.4 Non-specific effects",
    "text": "13.4 Non-specific effects\nMeasles disease casts a prolonged ‘shadow’ over the immune system, with depletion of existing immune memory, such that children who have had the disease have an increased risk of death from other causes over the next few years (Pollard & Bijker, 2021).",
    "crumbs": [
      "Interventions",
      "<span class='chapter-number'>13</span>  <span class='chapter-title'>Vaccination</span>"
    ]
  },
  {
    "objectID": "vax.html#factors-affecting-vaccine-protection",
    "href": "vax.html#factors-affecting-vaccine-protection",
    "title": "13  Vaccination",
    "section": "13.5 Factors affecting vaccine protection",
    "text": "13.5 Factors affecting vaccine protection\n\nMaternal antibody levels\nPrior antigen exposure\nAge of vaccination\nVaccine schedule\nVaccine dose: intradermal vaccination has been shown to be immunogenic at much lower (fractional) doses than intramuscular vaccination for influenza, rabies and HBV vaccines (Pollard & Bijker, 2021).\n\n\n\n\n\nPollard, A. J., & Bijker, E. M. (2021). A guide to vaccinology: from basic principles to new developments. Nature Reviews Immunology, 21(2), 83–100. https://doi.org/10.1038/s41577-020-00479-7",
    "crumbs": [
      "Interventions",
      "<span class='chapter-number'>13</span>  <span class='chapter-title'>Vaccination</span>"
    ]
  },
  {
    "objectID": "vax-perf.html",
    "href": "vax-perf.html",
    "title": "14  Vaccine performance",
    "section": "",
    "text": "14.1 Vaccine efficacy",
    "crumbs": [
      "Interventions",
      "<span class='chapter-number'>14</span>  <span class='chapter-title'>Vaccine performance</span>"
    ]
  },
  {
    "objectID": "vax-perf.html#vaccine-efficacy",
    "href": "vax-perf.html#vaccine-efficacy",
    "title": "14  Vaccine performance",
    "section": "",
    "text": "Definition 14.1 Efficacy is the percentage reduction in the disease rate (or infection risk (Shim & Galvani, 2012)) among vaccinated individuals compared to similar unvaccinated individuals (Verani et al., 2017).",
    "crumbs": [
      "Interventions",
      "<span class='chapter-number'>14</span>  <span class='chapter-title'>Vaccine performance</span>"
    ]
  },
  {
    "objectID": "vax-perf.html#vaccine-effectiveness",
    "href": "vax-perf.html#vaccine-effectiveness",
    "title": "14  Vaccine performance",
    "section": "14.2 Vaccine effectiveness",
    "text": "14.2 Vaccine effectiveness\n\nDefinition 14.2 Effectiveness is the percentage reduction in the disease rate (or infection risk (Shim & Galvani, 2012)) among vaccinated individuals compared to unvaccinated individuals, similar to efficacy, but in real-world conditions (Verani et al., 2017).\n\nVaccine effectiveness is categorized into 4 types:\n\nDirect\nIndirect\nTotal\nOverall\n\nLet \\(R_v\\) be the infection risk in the vaccinated group and \\(R_u\\) be the infection risk in the unvaccinated group.\nThe absolute reduction in infection risk due to vaccination is \\(R_u - R_v\\).\nVaccine efficacy or effectiveness \\(VE\\) is the percentage reduction in infection risk, so we divide the absolute reduction by the infection risk of the unvaccinated group.\n\\[\\begin{align} VE &= \\frac{R_u - R_v}{R_u} \\\\ &= 1 - \\frac{R_v}{R_u} \\\\ &= 1 - \\text{Relative risk} \\end{align}\\]\nLet have an example:\n\n\nIn the control group, the infection risk is \\(\\frac{4}{8}\\) as 4 out of 8 people are infected.\nIn the vaccinated group, the infection risk is \\(\\frac{1}{8}\\) as 1 person is infected among 8 people.\n\n\\[VE = \\frac{\\frac{4}{8} - \\frac{1}{8}}{\\frac{4}{8}} = \\frac{4 - 1}{4} = \\frac{3}{4} = 0.75\\]\nWhile 4 people get infected without vaccination, only 1 would get infected if they were vaccinated. The vaccine can prevent 3 of these infections. So the vaccine efficacy is \\(\\frac{3}{4}\\) or 75%.",
    "crumbs": [
      "Interventions",
      "<span class='chapter-number'>14</span>  <span class='chapter-title'>Vaccine performance</span>"
    ]
  },
  {
    "objectID": "vax-perf.html#measure-vaccine-effectiveness",
    "href": "vax-perf.html#measure-vaccine-effectiveness",
    "title": "14  Vaccine performance",
    "section": "14.3 Measure vaccine effectiveness",
    "text": "14.3 Measure vaccine effectiveness\n\n14.3.1 Screening method\n\nWe have data of all or a random sample of disease cases over a given period in a population, from which we know the proportion vaccinated (\\(PCV\\)) of these cases.\nWe also know the proportion of the population vaccinated (\\(PPV\\)).\n\nThen the vaccine effectiveness (\\(VE\\)) is calculated as:\n\\[\\begin{align} VE &= 1 - \\frac{\\frac{PCV}{1 - PCV}}{\\frac{PPV}{1 - PPV}} = 1 - \\frac{PCV}{1 - PCV} \\times \\frac{1 - PPV}{PPV} \\\\\n&= \\frac{PPV(1 - PCV) - PCV(1 - PPV)}{PPV(1 - PCV)} \\\\\n&= \\frac{PPV - PPV \\times PCV - PCV + PCV \\times PPV}{PPV(1 - PCV)} \\\\\n&= \\frac{PPV - PCV}{PPV(1 - PCV)} \\end{align}\\]\nIn which:\n\n\\(\\frac{PCV}{1 - PCV}\\) is the odd of vaccination in disease cases group.\n\\(\\frac{PPV}{1 - PPV}\\) is the odd of vaccination in the population.\n\\(\\frac{\\frac{PCV}{1 - PCV}}{\\frac{PPV}{1 - PPV}} = \\frac{PCV}{1 - PCV} \\times \\frac{1 - PPV}{PPV}\\) is the odds ratio of vaccination between 2 groups (cases vs population).\n\n\nbirth_cohort &lt;- c(1980:1986)\ncases &lt;- c(82, 98, 180, 177, 112, 140, 151)\nvac &lt;- c(5, 9, 28, 37, 22, 27, 27)\ncov &lt;- c(70, 70.9, 76, 81, 83.7, 84.5, 83.1)\ndf &lt;- data.frame(birth_cohort, cases, vac, cov)\ndf\n\n\n  \n\n\ndf$pcv &lt;- df$vac/df$cases\ndf$ppv &lt;- df$cov / 100\ndf$rr &lt;- (df$pcv / (1 - df$pcv)) / (df$ppv / (1 - df$ppv))\nlm(rr ~ birth_cohort, data = df)\n\n\nCall:\nlm(formula = rr ~ birth_cohort, data = df)\n\nCoefficients:\n (Intercept)  birth_cohort  \n   -3.029905      0.001551  \n\n1 - exp(-3.029905)\n\n[1] 0.9516798",
    "crumbs": [
      "Interventions",
      "<span class='chapter-number'>14</span>  <span class='chapter-title'>Vaccine performance</span>"
    ]
  },
  {
    "objectID": "vax-perf.html#vaccine-impact",
    "href": "vax-perf.html#vaccine-impact",
    "title": "14  Vaccine performance",
    "section": "14.4 Vaccine impact",
    "text": "14.4 Vaccine impact\n\nDefinition 14.3 Impact quantifies the reduction in disease rate (either percentage decline or absolute change in disease rate) at the population level after vaccine introduction. It is determined by: (1) vaccine effectiveness, (2) vaccine coverage and (3) herd immunity (Verani et al., 2017).\n\n\n\n\n\nShim, E., & Galvani, A. P. (2012). Distinguishing vaccine efficacy and effectiveness. Vaccine, 30(47), 6700–6705. https://doi.org/10.1016/j.vaccine.2012.08.045\n\n\nVerani, J. R., Baqui, A. H., Broome, C. V., Cherian, T., Cohen, C., Farrar, J. L., Feikin, D. R., Groome, M. J., Hajjeh, R. A., Johnson, H. L., Madhi, S. A., Mulholland, K., O’Brien, K. L., Parashar, U. D., Patel, M. M., Rodrigues, L. C., Santosham, M., Scott, J. A., Smith, P. G., … Zell, E. R. (2017). Case-control vaccine effectiveness studies: Preparation, design, and enrollment of cases and controls. Vaccine, 35(25), 3295–3302. https://doi.org/10.1016/j.vaccine.2017.04.037",
    "crumbs": [
      "Interventions",
      "<span class='chapter-number'>14</span>  <span class='chapter-title'>Vaccine performance</span>"
    ]
  },
  {
    "objectID": "vax-mod.html",
    "href": "vax-mod.html",
    "title": "15  Model vaccination",
    "section": "",
    "text": "15.1 Vaccine effects",
    "crumbs": [
      "Interventions",
      "<span class='chapter-number'>15</span>  <span class='chapter-title'>Model vaccination</span>"
    ]
  },
  {
    "objectID": "vax-mod.html#vaccine-effects",
    "href": "vax-mod.html#vaccine-effects",
    "title": "15  Model vaccination",
    "section": "",
    "text": "15.1.1 Prevent infection\nVaccine prevents the pathogen from establishing an infection in the body. A vaccinated person is less likely to get infected.\n\nAssuming a perfect vaccine against infection, the model can be designed as follows:\n\nVaccinated people \\(V\\) remain uninfected in their lifetime and do not participate in disease transmission.\nYou can simplify this model by moving susceptible people to the \\(R\\) compartment because they also do not participate in disease transmission.\n\n\n\n15.1.2 Prevent severe disease\nVaccine reduces the severity of the disease if the vaccinated person does get infected. A vaccinated individual still get infected but experiences a much milder form of the disease.\n\nAssuming a perfect vaccine against severe disease, the model can be designed as follows:\n\nThe infected population is split into a proportion of \\(p_s\\) for severe cases and \\(1 - p_s\\) for mild cases. Vaccinated people \\(S_v\\) still get infected, but will only experience mild disease.\n\n\n15.1.3 Prevent transmission\nVaccine reduces the ability of a vaccinated individual, who becomes infected, to transmit the pathogen to others. A vaccinated person still get infected, still get sick, but they are less likely to spread the disease to others.\n\nAssuming a perfect vaccine against transmission, the model can be designed as follows:\n\n\\(I\\) being the only source of infection that contributes to the force of infection. Vaccinated people \\(S_v\\) still get infected and become \\(I_v\\), but they do not transmit the disease.",
    "crumbs": [
      "Interventions",
      "<span class='chapter-number'>15</span>  <span class='chapter-title'>Model vaccination</span>"
    ]
  },
  {
    "objectID": "vax-mod.html#imperfect-protections",
    "href": "vax-mod.html#imperfect-protections",
    "title": "15  Model vaccination",
    "section": "15.2 Imperfect protections",
    "text": "15.2 Imperfect protections\nWhat is meant by a vaccine with effectiveness of 80% protection against a specific clinical endpoint? The mechanism of vaccine action is typically modelled in two ways:\n\n15.2.1 All-or-nothing model\n\n\n\n\n\n\nAll-or-nothing (AoN, also called the polarized (Park et al., 2023), or take) model assumes that among vaccinated individuals, a proportion \\(VE_P\\) are completely protected, while the remaining fraction \\(1 - VE_P\\) remains completely unprotected (Park et al., 2023; Zachreson et al., 2023).\n\n\n\nAn effectiveness of 80% here implies that among vaccinated people, 80% are completely protected, and 20% receive no protection (World Health Organization, 2013).\n\nAssumming a standard SIR model, vaccine protects against infection with vaccine effectiveness \\(VE_P\\), \\(\\rho\\) represents the vaccination rate:\n\nAmong the susceptible \\(S\\), \\(\\rho S\\) are vaccinated.\nAmong those \\(\\rho S\\) who are vaccinated, \\(\\rho VE_P S\\) are completely protected and go directly to \\(R_v\\), the remaining is \\(\\rho (1 - VE_P) S\\).\nThe remaining \\(\\rho (1 - VE_P) S\\) are completely unprotected, and will be infected with force of infection \\(\\lambda(t)\\) just like those who are unvaccinated.\n\n\n\n\n\n\n\nFigure 15.1: All-or-nothing vaccination model (Park et al., 2023)\n\n\n\n\\[\\begin{align}\n\\frac{dS}{dt} &= -\\lambda(t) S - \\rho S \\\\\n\\frac{dI}{dt} &= \\lambda(t) S - \\gamma I \\\\\n\\frac{dR}{dt} &= \\gamma I \\\\\n\\frac{dS_v}{dt} &= \\rho (1 - VE_P) S - \\lambda(t) S_v \\\\\n\\frac{dI_v}{dt} &= \\lambda(t) S_v - \\gamma I_v \\\\\n\\frac{dR_v}{dt} &= \\rho VE_P S + \\gamma I_v\n\\end{align}\\]\n\n\n15.2.2 Leaky model\n\n\n\n\n\n\nLeaky (or degree) model assumes that all vaccinated individuals are partially protected (Zachreson et al., 2023).\n\n\n\nAn effectiveness of 80% here implies that all vaccinated people have the endpoint of interest reduced by 80% compared to non-vaccinees.\n\nThe assumption that no vaccinated people is totally or permanently protected implies one or both of the following (World Health Organization, 2013):\n\nNo amount (titre) of the immune marker is totally protective or, if it is, no individual can maintain that titre for a long period (because of waning or transient immunosuppression)\nThe degree of protection is a function of the level of the immune marker - the simplest explanation being that protection is a function of both the level of the immune marker and the challenge dose.\n\nAssumming a standard SIR model, vaccine protects against infection with vaccine effectiveness \\(VE_L\\), \\(\\rho\\) represents the vaccination rate.\n\nAmong susceptible \\(S\\), \\(\\rho S\\) are vaccinated.\nAmong those \\(\\rho S\\) who are vaccinated, force of infection \\(\\lambda(t)\\) is reduced by a factor of \\(1 - VE_L\\).\n\n\n\n\n\n\n\nFigure 15.2: Leaky vaccination model (Park et al., 2023)\n\n\n\n\\[\\begin{align}\n\\frac{dS}{dt} &= -\\lambda(t) S - \\rho S \\\\\n\\frac{dI}{dt} &= \\lambda(t) S - \\gamma I \\\\\n\\frac{dR}{dt} &= \\gamma I \\\\\n\\frac{dS_v}{dt} &= \\rho S - (1 - VE_L) \\lambda(t) S_v \\\\\n\\frac{dI_v}{dt} &= (1 - VE_L) \\lambda(t) S_v - \\gamma I_v \\\\\n\\frac{dR_v}{dt} &= \\gamma I_v\n\\end{align}\\]",
    "crumbs": [
      "Interventions",
      "<span class='chapter-number'>15</span>  <span class='chapter-title'>Model vaccination</span>"
    ]
  },
  {
    "objectID": "vax-mod.html#mixed-effects",
    "href": "vax-mod.html#mixed-effects",
    "title": "15  Model vaccination",
    "section": "15.3 Mixed effects",
    "text": "15.3 Mixed effects\nImperfect vaccines often have a combination of effects: they can protect against infection, severe disease, and transmission at the same time.\n\nAssuming a vaccine with leaky effectiveness \\(VE_L\\) against infection and severe disease, the model can be designed as follows:\n\n\nAmong susceptible \\(S\\), \\(\\rho S\\) are vaccinated.\nAmong those \\(\\rho S\\) who are vaccinated, force of infection \\(\\lambda(t)\\) is reduced by a factor of \\(1 - VE_L\\).\nVaccine reduces the proportion of severe disease from \\(p_s\\) to \\(p_s'\\).",
    "crumbs": [
      "Interventions",
      "<span class='chapter-number'>15</span>  <span class='chapter-title'>Model vaccination</span>"
    ]
  },
  {
    "objectID": "vax-mod.html#multiple-doses",
    "href": "vax-mod.html#multiple-doses",
    "title": "15  Model vaccination",
    "section": "15.4 Multiple doses",
    "text": "15.4 Multiple doses\nSome vaccines require multiple doses, like measles (2 doses) or rotavirus (2 doses), with varying effectiveness per dose. Below is the DynaMICE model (Verguet et al., 2015) for the 2-dose measles vaccine, assuming AoN effectiveness as in Figure 15.1 for both doses.",
    "crumbs": [
      "Interventions",
      "<span class='chapter-number'>15</span>  <span class='chapter-title'>Model vaccination</span>"
    ]
  },
  {
    "objectID": "vax-mod.html#code",
    "href": "vax-mod.html#code",
    "title": "15  Model vaccination",
    "section": "15.5 Code",
    "text": "15.5 Code\n\n15.5.1 A perfect vaccine against infection\n\nlibrary(odin)\nlibrary(tidyr)\nlibrary(ggplot2)\n\n\n\npfvac_ode &lt;- odin({\n  # Derivatives\n  deriv(S) &lt;- -beta * S * I - rho * S\n  deriv(I) &lt;- beta * S * I - gamma * I\n  deriv(R) &lt;- gamma * I\n  deriv(V) &lt;- rho * S\n  \n  # Initial conditions\n  initial(S) &lt;- N_init - I_init\n  initial(I) &lt;- I_init\n  initial(R) &lt;- R_init\n  initial(V) &lt;- V_init\n  \n  # Parameters and initial values\n  beta &lt;- user(8.77e-8)\n  gamma &lt;- user(0.2)\n  rho &lt;- user(0.005)\n  N_init &lt;- user(5700000)\n  I_init &lt;- user(1)\n  R_init &lt;- user(0)\n  V_init &lt;- user(0)\n})\n\n\n# Initialize model\npfvac_mod &lt;- pfvac_ode$new()\n# How long to run\ntimes &lt;- seq(0,300)\n# Run the model\npred &lt;- data.frame(pfvac_mod$run(times))\n\n\n\nCode\ndf_plot &lt;- pivot_longer(pred, cols = S:V, names_to = \"comp\", values_to = \"n\")\n\nggplot(df_plot, aes(x = t, y = n, color = comp)) +\n  geom_line(linewidth = 1.2) +\n  scale_color_brewer(palette = \"PuOr\", breaks = c(\"S\", \"I\", \"R\", \"V\")) +\n  labs(color = NULL, y = NULL, x = \"Time\") +\n  theme_minimal() +\n  theme(legend.position = \"bottom\")\n\n\n\n\n\n\n\n\n\n\n\n15.5.2 AoN model against infection\n\n\n15.5.3 Leaky model against infection\n\n\n\n\nPark, S. W., Li, M., Metcalf, C. J. E., Grenfell, B. T., & Dushoff, J. (2023). Immune boosting bridges leaky and polarized vaccination models. medRxiv. https://doi.org/10.1101/2023.07.14.23292670\n\n\nVerguet, S., Johri, M., Morris, S. K., Gauvreau, C. L., Jha, P., & Jit, M. (2015). Controlling measles using supplemental immunization activities: A mathematical model to inform optimal policy. Vaccine, 33(10), 1291–1296. https://doi.org/10.1016/j.vaccine.2014.11.050\n\n\nWorld Health Organization. (2013). Correlates of vaccine-induced protection: Methods and implications.\n\n\nZachreson, C., Tobin, R., Szanyi, J., Walker, C., Cromer, D., Shearer, F. M., Conway, E., Ryan, G., Cheng, A., McCaw, J. M., & Geard, N. (2023). Individual variation in vaccine immune response can produce bimodal distributions of protection. Vaccine, 41(45), 6630–6636. https://doi.org/10.1016/j.vaccine.2023.09.025",
    "crumbs": [
      "Interventions",
      "<span class='chapter-number'>15</span>  <span class='chapter-title'>Model vaccination</span>"
    ]
  },
  {
    "objectID": "he.html",
    "href": "he.html",
    "title": "Health economics",
    "section": "",
    "text": "Types of analyses\nPartial economic evaluations: studies that either only examine cost or consequences, or examine both costs and consequences but for only one intervention (without a comparator). This analysis cannot guide decision-making (Turner et al., 2021).\nFull economic evaluations: compare both the costs and consequences of the intervention to a comparator. There are 3 most popular types of full economic evaluations, the key difference lies in how they express the consequences (Turner et al., 2021):",
    "crumbs": [
      "Health economics"
    ]
  },
  {
    "objectID": "he.html#types-of-analyses",
    "href": "he.html#types-of-analyses",
    "title": "Health economics",
    "section": "",
    "text": "Type\nCosts\nConsequences\n\n\n\n\nCost-effectiveness\n$\nA single natural unit (life-years gained, cases averted, cases detected)\n\n\nCost-utility\n$\nQALYs, DALYs\n\n\nCost-benefit\n$\n$\n\n\n\n\n\n\n\n\n\nNote\n\n\n\n\nCost-utility is sometimes considered as a special type of cost-effectiveness.\nThere are 2 more types of full economic evaluations: cost-minimisation and cost-consequence, but they are less commonly used.",
    "crumbs": [
      "Health economics"
    ]
  },
  {
    "objectID": "he.html#models-in-health-economics",
    "href": "he.html#models-in-health-economics",
    "title": "Health economics",
    "section": "Models in health economics",
    "text": "Models in health economics\n\nProportionate outcomes model\nAlso known as decision tree although exact definitions differ. Group flows divided into proportional outcomes over a single time period (Bishai et al., 2023).\nAll decision trees have 3 key components (Bishai et al., 2023):\n\nDecision nodes: where different comparators are compared.\nChance nodes: where potential outcomes are weighted by their probabilities.\nTerminal nodes: endpoints of pathways, where costs and effectiveness calculated.\n\n\n\n\n\n\n\nFigure 1: Decision tree, adapted from (Bishai et al., 2023)\n\n\n\nWe have to specify a fixed time horizon represents the period over which probabilities and outcomes are considered (Kuntz et al., 2013). If a decision tree uses a 50-year time horizon, the probabilities of outcomes are based on what could occur within those 50 years.\n\nDecision nodes (or the comparators) are either “No vaccine” or “Vaccine” available.\nChance nodes (or outcomes and their probabilities), are the nodes branch out from Decision nodes.\nTerminal nodes (or the endpoints for costs and effectiveness) are “No infection”, “Recovered”, and “Death”.\n\n\n\nMarkov model\nA Markov model is a repeated decision tree (Heeg et al., 2008). The core elements of a Markov model are health states and transition (Bishai et al., 2023):\n\nHealth states represent different conditions such as being healthy, sick, disease stages, or vaccinated. States must be mutually exclusive (a person can’t be in two states at once) and exhaustive (cover all relevant conditions).\nTransition is the probability (ranges between 0 and 1) of moving from one state to another.\n\nMarkov models are used for problems that involve risk over time, or when the timing of events is important (Kuntz et al., 2013). We can use a Markov model to represent the endpoints shown in the decision tree Figure 1.\n\n\n\n\n\n\nFigure 2: Markov model, adapted from (Bishai et al., 2023)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nS\nV\nI\nR\nD\nCheck\n\n\n\n\nSusceptible (S)\n0.198\n0.100\n0.700\n0.000\n0.002\n1.000\n\n\nVaccinated (V)\n0.000\n0.998\n0.000045\n0.000\n0.002\n1.000\n\n\nInfected (I)\n0.000\n0.000\n0.129\n0.865\n0.006\n1.000\n\n\nRecovered (R)\n0.000\n0.000\n0.000\n0.998\n0.002\n1.000\n\n\nDeaths (D)\n0.000\n0.000\n0.000\n0.000\n1.000\n1.000\n\n\n\nThe key disadvantage of a Markov model is its memoryless property or Markov assumption, which assumes that transitions between health states depend only on the current state, not on the past history or duration spent in a state (Bishai et al., 2023).\n\n\nCompartmental dynamic model\nStatic models (decision tree, Markov model) assumes that the force of infection is constant or changes only as a function of age and other individual characteristics. Dynamic model assumes that the force of infection can vary throughout the course of time and as a function of population interactions. Dynamic models are preferable for modeling the impact of a vaccine when considerations of herd immunity (Bishai et al., 2023).\nWe can adjust the Markov model Figure 2 to become a compartmental dynamic model by specifying that the force of infection varies over time.\n\n\n\n\n\n\nFigure 3: Compartmental dynamic model, adapted from (Bishai et al., 2023)\n\n\n\n\n\nIndividual-based model\nIndividual-based model, also called microsimulation model, keeps track of each individual’s behaviour (Kim & Goldie, 2008). This is done by repeatedly sampling from probability distributions a large number of times to understand the average and spread of potential results. The disadvantage is that they are time-consuming, as they require sometimes the simulation of millions of individuals to obtain stable estimates (Bishai et al., 2023).\n\n\n\nChoice of model\nThe most difficult decision in model building is “How complex should the model be?” (Hilborn & Mangel, 1997). Most modellers agree on 2 basic rules for choosing a model:\n\nLet the data tell you (Hilborn & Mangel, 1997).\n\n\n\n\nAsst Prof. Kiesha Prem’s lecture at MIDSEA Summer School 2024.\n\n\nSimpler models need less data to estimate parameters but might overlook important system components. In contrast, complex models can capture more details but we may not have sufficient data to determine the parameters (Hilborn & Mangel, 1997).\n\nThe use of the model (Hilborn & Mangel, 1997).\n\n\n\n\nAdapted from Asst Prof. Kiesha Prem’s lecture at MIDSEA Summer School 2024.\n\n\nSimple models are useful if their assumptions are reasonable. For accurate predictions, a “wrong” but simpler model can do better than the “right” but complex model when parameters are estimated (Hilborn & Mangel, 1997). However, a complex model provides a better representation of uncertainty (Hilborn & Mangel, 1997).\nGiven the close connection between health economics and policy, guidelines are available for every step of the process. Be sure to read and follow these guidelines when conducting your analysis. Below is guidance on choosing between static and dynamic models.\n\n\n\nHow the choice of a static model, static model with approximation for herd immunity or dynamic model could be made (Jit & Brisson, 2011)",
    "crumbs": [
      "Health economics"
    ]
  },
  {
    "objectID": "he.html#measuring-consequences",
    "href": "he.html#measuring-consequences",
    "title": "Health economics",
    "section": "Measuring consequences",
    "text": "Measuring consequences\n\nUtility\nUtility of health states are expressed on a scale from 0 to 1, where 0 represents the utility of being “dead” and 1 represents the utility of “perfect health” (Prieto & Sacristán, 2003).\n\nQALY\nThe quality-adjusted life year (QALY) measure “years lived in perfect health”. One year in perfect health equals 1 QALY (1 Year \\(\\times\\) 1 Utility = 1 QALY). A year lived in less than perfect health is worth less than 1 QALY (Prieto & Sacristán, 2003).\n\\[\\text{QALY} = \\sum_{i = 0}^{\\text{lifetime}} \\text{Year} \\times \\text{Utility}\\]\nFor example, 0.5 years in perfect health equals 0.5 QALYs (0.5 years \\(\\times\\) 1 Utility), the same as 1 year with a utility of 0.5 (1 year \\(\\times\\) 0.5 Utility) (Prieto & Sacristán, 2003). The area under the curve equates to the total QALY value (Whitehead & Ali, 2010).\n\n\n\nAsst Prof. Kiesha Prem’s lecture at MIDSEA Summer School 2024.",
    "crumbs": [
      "Health economics"
    ]
  },
  {
    "objectID": "he.html#measuring-costs",
    "href": "he.html#measuring-costs",
    "title": "Health economics",
    "section": "Measuring costs",
    "text": "Measuring costs\n\nPerspectives\n\n\nOverview of the perspectives included costs (Sittimart et al., 2024)\n\n\n\n\n\n\n\n\n\n\n\nCosts\nHealth care payer\nHealth care providers\nHealthcare sector\nHealth system\nPatient/ household\nSocietal\n\n\n\n\nDirect medical costs paid by health care payer/providers\nY (only payer)\nY (both payer + provider)\nY\nY\n\nY\n\n\nDirect medical costs paid by patients (i.e., out-of-pocket)\n\n\nY\nY\nY\nY\n\n\nDirect non-medical costs incurred by patients (travel, food, and accommodation)\n\n\n\n\nY\nY\n\n\nProductivity costs (e.g., monetized productivity\n\n\n\n\nVaries\nVaries\n\n\nNon-health sector costs (e.g., spillover impacts affecting other sectors such as education, criminal justice, etc.)\n\n\n\nY*\n\nY*\n\n\nTotal\n1\n1\n2\n2\n3\n5\n\n\n\n\n\n\nDiscounting vs inflation\nDiscounting is needed if a longer time horizon than 1-2 years is being considered. For most health economic evaluations, guidelines recommend a discount rate of 3% (high-income countries) to 5% (low- and middle-income countries) (Bishai et al., 2023).\nDiscounting is adjusting future costs and outcomes of health-care interventions to “present value” (Severens & Milne, 2004). Discounting is based on the concept of “positive time preference”, meaning that people prefers to benefit sooner rather than later (Severens & Milne, 2004).\n\\[\\text{Present value} = \\frac{\\text{Future value}}{(1 + \\text{annual discount rate})^\\text{n years}}\\]\nImagine you can choose between getting (A) $1000 today or (B) $1000 in 5 years. Most people prefer option A because having $1000 today allows you to use it immediately or invest it. The value of $1000 today is greater than $1000 in 5 years due to the opportunity to earn interest or invest it.\nNow imagine you can choose between getting $500 today or $1000 in 10 years. To make a fair comparison, you need to adjust the future value to present value. Let’s say the discount rate is 5%. How much does $1000 in 10 years worth today?\n\\[\\text{Present value} = \\frac{1000}{(1 + 0.05)^{10}} \\approx 613.91\\]\nSo $1000 in 10 years is worth about $614 in today’s dollars.\nDiscounting should not be confused with adjusting for inflation. Both are needed. Discounting reflects the loss in value when there is a delay in obtaining an item of value (e.g., adjusting for future value). The inflation adjustment reflects the change in purchasing power of currency (e.g., adjusting past costs to current values).\n\nDiscounting: This is about the idea that a dollar today is worth more than a dollar in the future. It reflects our preference for receiving benefits or money sooner rather than later. It’s used to adjust future costs or benefits to their present value.\nInflation: This is about how the general price level of goods and services increases over time. Inflation means that money loses its purchasing power, so what $1 buys today might cost more in the future.\n\n\n\n\nFigure 1: Decision tree, adapted from (Bishai et al., 2023)\nFigure 2: Markov model, adapted from (Bishai et al., 2023)\nFigure 3: Compartmental dynamic model, adapted from (Bishai et al., 2023)\nAsst Prof. Kiesha Prem’s lecture at MIDSEA Summer School 2024.\nAdapted from Asst Prof. Kiesha Prem’s lecture at MIDSEA Summer School 2024.\nHow the choice of a static model, static model with approximation for herd immunity or dynamic model could be made (Jit & Brisson, 2011)\nAsst Prof. Kiesha Prem’s lecture at MIDSEA Summer School 2024.\n\n\n\nBishai, D., Brenzel, L., & Padula, W. (Eds.). (2023). Handbook of applied health economics in vaccines. Oxford University Press. https://doi.org/10.1093/oso/9780192896087.001.0001\n\n\nGoeree, R., & Diaby, V. (2013). Introduction to health economics and decision-making: Is economics relevant for the frontline clinician? Best Practice & Research Clinical Gastroenterology, 27(6), 831–844. https://doi.org/10.1016/j.bpg.2013.08.016\n\n\nHeeg, B. M. S., Damen, J., Buskens, E., Caleo, S., Charro, F. de, & Hout, B. A. van. (2008). Modelling Approaches. PharmacoEconomics, 26(8), 633–648. https://doi.org/10.2165/00019053-200826080-00002\n\n\nHilborn, R., & Mangel, M. (1997). The ecological detective: Confronting models with data. Princeton University Press. https://www.jstor.org/stable/j.ctt24hqnx\n\n\nJit, M., & Brisson, M. (2011). Modelling the Epidemiology of Infectious Diseases for Decision Analysis. PharmacoEconomics, 29(5), 371–386. https://doi.org/10.2165/11539960-000000000-00000\n\n\nKim, S.-Y., & Goldie, S. J. (2008). Cost-Effectiveness Analyses of Vaccination Programmes. PharmacoEconomics, 26(3), 191–215. https://doi.org/10.2165/00019053-200826030-00004\n\n\nKuntz, K., Sainfort, F., Butler, M., Taylor, B., Kulasingam, S., Gregory, S., Mann, E., Anderson, J. M., & Kane, R. L. (2013). Decision and Simulation Modeling Alongside Systematic Reviews. Agency for Healthcare Research; Quality (US). https://www.ncbi.nlm.nih.gov/books/NBK127478/\n\n\nPrieto, L., & Sacristán, J. A. (2003). Problems and solutions in calculating quality-adjusted life years (QALYs). Health and Quality of Life Outcomes, 1(1), 80. https://doi.org/10.1186/1477-7525-1-80\n\n\nSeverens, J. L., & Milne, R. J. (2004). Discounting Health Outcomes in Economic Evaluation: The Ongoing Debate. Value in Health, 7(4), 397–401. https://doi.org/10.1111/j.1524-4733.2004.74002.x\n\n\nSittimart, M., Rattanavipapong, W., Mirelman, A. J., Hung, T. M., Dabak, S., Downey, L. E., Jit, M., Teerawattananon, Y., & Turner, H. C. (2024). An overview of the perspectives used in health economic evaluations. Cost Effectiveness and Resource Allocation, 22(1), 41. https://doi.org/10.1186/s12962-024-00552-1\n\n\nTurner, H. C., Archer, R. A., Downey, L. E., Isaranuwatchai, W., Chalkidou, K., Jit, M., & Teerawattananon, Y. (2021). An introduction to the main types of economic evaluations used for informing priority setting and resource allocation in healthcare: Key features, uses, and limitations. Frontiers in Public Health, 9. https://www.frontiersin.org/articles/10.3389/fpubh.2021.722927\n\n\nWhitehead, S. J., & Ali, S. (2010). Health outcomes in economic evaluation: The QALY and utilities. British Medical Bulletin, 96(1), 5–21. https://doi.org/10.1093/bmb/ldq033",
    "crumbs": [
      "Health economics"
    ]
  },
  {
    "objectID": "he-etr.html",
    "href": "he-etr.html",
    "title": "16  EtR Process",
    "section": "",
    "text": "Overview\nHealth economics is closely linked to policy. Understanding how policies are made (in a proper way) helps us design studies that can contribute to policy-making. It is also useful to put yourself in the role of policy makers to consider how your research can best benefit the public.\nEvidence to Recommendation Process (EtR Process) is a systematic, standardized decision-making process used by national immunization technical advisory groups (NITAGs) for the development of evidence-based recommendations for immunization policy. EtR Process is composed of four steps:\nSteps 1, 2 and 3 should be conducted by the NITAG Secretariat or a working group. In step 4, all NITAG members should be involved.",
    "crumbs": [
      "Health economics",
      "<span class='chapter-number'>16</span>  <span class='chapter-title'>EtR Process</span>"
    ]
  },
  {
    "objectID": "he-etr.html#overview",
    "href": "he-etr.html#overview",
    "title": "16  EtR Process",
    "section": "",
    "text": "The policy question\nThe elements to consider\nThe evidence\nThe recommendation\n\n\n\n\n\n\n\n\nClick here for a summary of all steps",
    "crumbs": [
      "Health economics",
      "<span class='chapter-number'>16</span>  <span class='chapter-title'>EtR Process</span>"
    ]
  },
  {
    "objectID": "he-etr.html#prerequisite-step",
    "href": "he-etr.html#prerequisite-step",
    "title": "16  EtR Process",
    "section": "Prerequisite step",
    "text": "Prerequisite step\nWhen using the EtR Process for the first time, a prerequisite step should be conducted by the whole NITAG to develop 2 tools:\n\nGeneric criteria tables\nEtR framework\n\nNoted that this step only needs to be conducted once.\n\nGeneric criteria tables\nGeneric criteria tables comprise 7 tables that contain all issues relevant for any immunization policy question, unspecific to any particular disease or vaccine. Each table links a criterion with many factors. Each factor then has many elements, each representing a type of evidence needed for for NITAG consideration.\n\n\n\n\n\n\n\n\nCriterion\nFactor\nElement\n\n\n\n\nProblem\nBurden/epidemiology of disease\nFrequency of the disease (incidence, prevalence)\nSeverity of the disease (mortality, morbidity)\n\n\n\n\n\n\n\n\n\nClick here to see the criteria, their factors and elements\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nEtR framework\nEtR framework is a structured document that shows the logical progression from the evidence to the decision. EtR framework has 3 main sections:\n\nIntroduction: presents the policy question.\nCriteria: presents 7 criteria, factors and elements from the generic criteria tables, with evidence and notes.\nDraft NITAG recommendation: presents the draft NITAG decision.\n\n\n\n\n\n\n\nClick here for a sample EtR framework",
    "crumbs": [
      "Health economics",
      "<span class='chapter-number'>16</span>  <span class='chapter-title'>EtR Process</span>"
    ]
  },
  {
    "objectID": "he-etr.html#the-policy-question",
    "href": "he-etr.html#the-policy-question",
    "title": "16  EtR Process",
    "section": "16.1 The policy question",
    "text": "16.1 The policy question\nAn initial policy question can be either raised by the Ministry of Health to NITAG, or by NITAG itself. The initial policy question is usually rather broad, for example:\n\nShould vaccine X be introduced in a routine vaccination programme?\nShould the schedule of vaccine X be reviewed?\n\nThis step is to revise the broad question into a structured policy question that detailed enough to guide the collection of evidence. A structured policy question should has:\n\nIntervention: The vaccine formulation, dosage and schedule.\nPopulation: The population targeted to receive the vaccine and/or will be affected by it.\nGoal of intervention: The outcome of interest, could be measurable (e.g. reduction of a certain disease) or not.\nComparison: If compares a new intervention to an existing one.\nOptions: If several options are available (e.g. different vaccine formulations, dosages or schedules).",
    "crumbs": [
      "Health economics",
      "<span class='chapter-number'>16</span>  <span class='chapter-title'>EtR Process</span>"
    ]
  },
  {
    "objectID": "he-etr.html#the-elements-to-consider",
    "href": "he-etr.html#the-elements-to-consider",
    "title": "16  EtR Process",
    "section": "16.2 The elements to consider",
    "text": "16.2 The elements to consider\nThis step is to create specific criteria tables from the generic criteria tables. It includes 2 steps:\n\nMake the elements specific: Specify the disease, intervention and population of interest for all elements in the generic criteria tables.\nSelect the factors and specified elements relevant for the policy question: After specifying the elements, pick the relevant factors and specified elements, and place them in the EtR framework.",
    "crumbs": [
      "Health economics",
      "<span class='chapter-number'>16</span>  <span class='chapter-title'>EtR Process</span>"
    ]
  },
  {
    "objectID": "he-etr.html#the-evidence",
    "href": "he-etr.html#the-evidence",
    "title": "16  EtR Process",
    "section": "16.3 The evidence",
    "text": "16.3 The evidence\nThis step is to collect evidence on the selected factors and specified elements determined in Step 2, rate the evidence quality, and put them in the EtR framework. It is the most labour-intensive part.\nEvidence may be obtained from literature (published or unpublished), statistical data, surveillance records, experiences from countries that have already implemented the intervention, documents/publications and/or recommendations from WHO, WHO SAGE, Regional Immunization Technical Advisory Groups such as the European Technical Advisory Group of Experts on Immunization or other NITAGs.\nCriterion 2 “Benefits and harms of the intervention” is extremely important, therefore:\n\nSome NITAGs conduct systematic review, which is very time and resource consuming and should only be done if necessary capacities are available.\nUse GRADE quality assessments to assess the evidence quality, which is the confidence level in how close the reported effects in the evidence are to the true effects.\n\nLower quality data does not prevent recommendations, but the limitations should be clearly outlined.",
    "crumbs": [
      "Health economics",
      "<span class='chapter-number'>16</span>  <span class='chapter-title'>EtR Process</span>"
    ]
  },
  {
    "objectID": "he-etr.html#the-recommendation",
    "href": "he-etr.html#the-recommendation",
    "title": "16  EtR Process",
    "section": "16.4 The recommendation",
    "text": "16.4 The recommendation\nIn this step, the Secretariat or working group draft NITAG decision and recommendation, and present to all NITAG members. The whole NITAG should discuss and agree on a final NITAG decision and recommendation.",
    "crumbs": [
      "Health economics",
      "<span class='chapter-number'>16</span>  <span class='chapter-title'>EtR Process</span>"
    ]
  },
  {
    "objectID": "he-etr.html#excercise",
    "href": "he-etr.html#excercise",
    "title": "16  EtR Process",
    "section": "Excercise",
    "text": "Excercise\nStep 1. The policy question\n\nShould flu vaccine be introduced in a routine vaccination programme?\n\nMake a structured policy question that include:\n\nIntervention\nPopulation\nGoal\n\n\n\n\n\n\n\nSample answer\n\n\n\n\n\nIntervention: Influenza vaccine VaxiGrip Tetra, single dose of 0.5 mL.\nPopulation:\n\nIn PH (relatively younger population, median = 25 years old)\nPeople with high contacts with animals\nVets, slaughterhouse workers, farmers, retailers\nYoung (aged 6 months to 4 years)\nOld (aged 55 years old and above)\nPregnant women\nImmunocompromised\n\nGoal:\n\nPreventing spillover infections (animals to human with new variants, which may cause pandemic)\nReducing hospitalization rate and mortality rate\nPreventing infection\nReduced severe cases needing of hospitalization\nProtecting others\nMaximise vaccine coverage\n\n\n\n\nStep 2. The elements to consider\n\n\n\n\n\n\n\n\nCriterion\nFactor\nHow will you collect this evidence?\n\n\n\n\nProblem\nBurden/epidemiology of disease\n\n\n\nBenefits and Harms\nHow substantial are the desired anticipated effects?\nDo the desirable effect outweigh the undesirable effects?\n\n\n\nValues\nDoes the target population feel that the desirable effect is large relative to the undesirable effects?\n\n\n\nResource use\nIs the intervention a reasonable and efficient use of resources?\n\n\n\nEquity\nWhat would be the impact of the intervention on health equity?\n\n\n\n\n\n\n\n\n\n\nSample answer\n\n\n\n\n\n\n\n\n\n\n\n\n\nCriterion\nFactor\nHow will you collect this evidence?\n\n\n\n\nProblem\nBurden/epidemiology of disease\nHospitalization rate\nMortality rate\n\n\nBenefits and Harms\nHow substantial are the desired anticipated effects?\nDo the desirable effect outweigh the undesirable effects?\nHospitalisations pre- and post-vaccination\nPresence of adverse events (AEs) and severe adverse events (SAEs)\n\n\nValues\nDoes the target population feel that the desirable effect is large relative to the undesirable effects?\nSurvey the target population\nFocus group discussions with the target groups\nKey informant interviews\n\n\nResource use\nIs the intervention a reasonable and efficient use of resources?\nOperational research (i.e., resource allocation)\nHealth service modelling\nSupply and Demand Forecasting\n\n\nEquity\nWhat would be the impact of the intervention on health equity?\nUse modelling to evaluate the impact and the cost-effectiveness of the influenza vaccination programmes stratified by the different target groups\nECEA or DCEA",
    "crumbs": [
      "Health economics",
      "<span class='chapter-number'>16</span>  <span class='chapter-title'>EtR Process</span>"
    ]
  },
  {
    "objectID": "rp-risk.html",
    "href": "rp-risk.html",
    "title": "17  Risk assessment report",
    "section": "",
    "text": "17.1 Examples\nRisk assessment for measles resurgence in the UK\nRapid risk assessment: Measles in Canada, public health implications in 2024",
    "crumbs": [
      "Reports",
      "<span class='chapter-number'>17</span>  <span class='chapter-title'>Risk assessment report</span>"
    ]
  },
  {
    "objectID": "rp-risk.html#data",
    "href": "rp-risk.html#data",
    "title": "17  Risk assessment report",
    "section": "17.2 Data",
    "text": "17.2 Data\n\nHistorical case notification of past outbreaks 2014 and 2019 Date of onset + date of birth (or age)\nCurrent level of susceptibility in HCMC:\n\n\nSerology\nVaccine registry\nBirth rates\n\n\nConnectivity between Phu Quoc and HCMC: Flight data / boat data?\n\nP = 1 – (1 / (R0 * s))^m",
    "crumbs": [
      "Reports",
      "<span class='chapter-number'>17</span>  <span class='chapter-title'>Risk assessment report</span>"
    ]
  },
  {
    "objectID": "references.html",
    "href": "references.html",
    "title": "References",
    "section": "",
    "text": "Becker, A. D., & Grenfell, B. T. (2017). tsiR: An R package for\ntime-series Susceptible-Infected-Recovered models of epidemics. PLOS\nONE, 12(9), e0185528. https://doi.org/10.1371/journal.pone.0185528\n\n\nBettencourt, L. M. A., & Ribeiro, R. M. (2008). Real Time Bayesian\nEstimation of the Epidemic Potential of Emerging Infectious Diseases.\nPLOS ONE, 3(5), e2185. https://doi.org/10.1371/journal.pone.0002185\n\n\nBishai, D., Brenzel, L., & Padula, W. (Eds.). (2023). Handbook\nof applied health economics in vaccines. Oxford University Press.\nhttps://doi.org/10.1093/oso/9780192896087.001.0001\n\n\nBradshaw, W. J., Alley, E. C., Huggins, J. H., Lloyd, A. L., &\nEsvelt, K. M. (2021). Bidirectional contact tracing could dramatically\nimprove COVID-19 control. Nature Communications,\n12(1), 232. https://doi.org/10.1038/s41467-020-20325-7\n\n\nBreban, R., Vardavas, R., & Blower, S. (2007). Theory versus Data:\nHow to Calculate R0? PLOS ONE, 2(3), e282. https://doi.org/10.1371/journal.pone.0000282\n\n\nCauchemez, S., Bhattarai, A., Marchbanks, T. L., Fagan, R. P., Ostroff,\nS., Ferguson, N. M., Swerdlow, D., Pennsylvania H1N1 working group, the,\nSodha, S. V., Moll, M. E., Angulo, F. J., Palekar, R., Archer, W. R.,\n& Finelli, L. (2011). Role of social networks in shaping disease\ntransmission during a community outbreak of 2009 H1N1 pandemic\ninfluenza. Proceedings of the National Academy of Sciences,\n108(7), 2825–2830. https://doi.org/10.1073/pnas.1008895108\n\n\nChitnis, N. (2017). Introduction to SEIR Models.\n\n\nChristley, R. M., Mort, M., Wynne, B., Wastling, J. M., Heathwaite, A.\nL., Pickup, R., Austin, Z., & Latham, S. M. (2013).\n“Wrong, but Useful”: Negotiating Uncertainty\nin Infectious Disease Modelling. PLOS ONE, 8(10),\ne76277. https://doi.org/10.1371/journal.pone.0076277\n\n\nCori, A., Ferguson, N. M., Fraser, C., & Cauchemez, S. (2013). A new\nframework and software to estimate time-varying reproduction numbers\nduring epidemics. American Journal of Epidemiology,\n178(9), 1505–1512. https://doi.org/10.1093/aje/kwt133\n\n\nDelamater, P. L., Street, E. J., Leslie, T. F., Yang, Y. T., &\nJacobsen, K. H. (2019). Complexity of the basic reproduction number\n(R0) - volume 25, number 1january 2019 - emerging\ninfectious diseases journal - CDC. https://doi.org/10.3201/eid2501.171901\n\n\nDiekmann, O., Heesterbeek, J. A. P., & Metz, J. A. J. (1990). On the\ndefinition and the computation of the basic reproduction ratio R0 in\nmodels for infectious diseases in heterogeneous populations. Journal\nof Mathematical Biology, 28(4), 365–382. https://doi.org/10.1007/BF00178324\n\n\nDriessche, P. van den. (2017). Reproduction numbers of infectious\ndisease models. Infectious Disease Modelling, 2(3),\n288–303. https://doi.org/10.1016/j.idm.2017.06.002\n\n\nDriessche, P. van den, & Watmough, J. (2002). Reproduction numbers\nand sub-threshold endemic equilibria for compartmental models of disease\ntransmission. Mathematical Biosciences, 180(1), 29–48.\nhttps://doi.org/10.1016/S0025-5564(02)00108-6\n\n\nDu, Z., Zhang, W., Zhang, D., Yu, S., & Hao, Y. (2017). Estimating\nthe basic reproduction rate of HFMD using the time series SIR model in\nGuangdong, China. PLOS ONE, 12(7), e0179623. https://doi.org/10.1371/journal.pone.0179623\n\n\nFinkenstädt, B. F., & Grenfell, B. T. (2000). Time series modelling\nof childhood diseases: A dynamical systems approach. Journal of the\nRoyal Statistical Society Series C: Applied Statistics,\n49(2), 187–205. https://doi.org/10.1111/1467-9876.00187\n\n\nGoeree, R., & Diaby, V. (2013). Introduction to health economics and\ndecision-making: Is economics relevant for the frontline clinician?\nBest Practice & Research Clinical Gastroenterology,\n27(6), 831–844. https://doi.org/10.1016/j.bpg.2013.08.016\n\n\nGostic, K. M., McGough, L., Baskerville, E. B., Abbott, S., Joshi, K.,\nTedijanto, C., Kahn, R., Niehus, R., Hay, J. A., Salazar, P. M. D.,\nHellewell, J., Meakin, S., Munday, J. D., Bosse, N. I., Sherrat, K.,\nThompson, R. N., White, L. F., Huisman, J. S., Scire, J., … Cobey, S.\n(2020). Practical considerations for measuring the effective\nreproductive number, Rt. PLOS Computational Biology,\n16(12), e1008409. https://doi.org/10.1371/journal.pcbi.1008409\n\n\nGreen, W. D., Ferguson, N. M., & Cori, A. (2022). Inferring the\nreproduction number using the renewal equation in heterogeneous\nepidemics. Journal of The Royal Society Interface,\n19(188), 20210429. https://doi.org/10.1098/rsif.2021.0429\n\n\nHeeg, B. M. S., Damen, J., Buskens, E., Caleo, S., Charro, F. de, &\nHout, B. A. van. (2008). Modelling Approaches.\nPharmacoEconomics, 26(8), 633–648. https://doi.org/10.2165/00019053-200826080-00002\n\n\nHilborn, R., & Mangel, M. (1997). The ecological detective:\nConfronting models with data. Princeton University Press. https://www.jstor.org/stable/j.ctt24hqnx\n\n\nJit, M., & Brisson, M. (2011). Modelling the Epidemiology of\nInfectious Diseases for Decision Analysis. PharmacoEconomics,\n29(5), 371–386. https://doi.org/10.2165/11539960-000000000-00000\n\n\nJones, J. H. (2007). Notes on R0. California: Department of\nAnthropological Sciences, 323, 1–19.\n\n\nKeeling, M. J. (2006). State-of-science review: Predictive and\nreal-time epidemiological modelling. S9. DTI.\n\n\nKeeling, M. J., & Rohani, P. (2011). Modeling Infectious\nDiseases in Humans and Animals. Princeton University Press. https://doi.org/10.1515/9781400841035\n\n\nKenah, E., Lipsitch, M., & Robins, J. M. (2008). Generation interval\ncontraction and epidemic data analysis. Mathematical\nBiosciences, 213(1), 71–79. https://doi.org/10.1016/j.mbs.2008.02.007\n\n\nKim, S.-Y., & Goldie, S. J. (2008). Cost-Effectiveness Analyses of\nVaccination Programmes. PharmacoEconomics, 26(3),\n191–215. https://doi.org/10.2165/00019053-200826030-00004\n\n\nKnight, J., & Mishra, S. (2020). Estimating effective reproduction\nnumber using generation time versus serial interval, with application to\ncovid-19 in the greater toronto area, canada. Infectious Disease\nModelling, 5, 889–896. https://doi.org/10.1016/j.idm.2020.10.009\n\n\nKuntz, K., Sainfort, F., Butler, M., Taylor, B., Kulasingam, S.,\nGregory, S., Mann, E., Anderson, J. M., & Kane, R. L. (2013).\nDecision and Simulation Modeling Alongside Systematic Reviews.\nAgency for Healthcare Research; Quality (US). https://www.ncbi.nlm.nih.gov/books/NBK127478/\n\n\nPandit, J. J. (2020). Managing the R0 of COVID-19: mathematics fights\nback. Anaesthesia, 75(12), 1643–1647. https://doi.org/10.1111/anae.15151\n\n\nPark, S. W., Li, M., Metcalf, C. J. E., Grenfell, B. T., & Dushoff,\nJ. (2023). Immune boosting bridges leaky and polarized vaccination\nmodels. medRxiv. https://doi.org/10.1101/2023.07.14.23292670\n\n\nPollard, A. J., & Bijker, E. M. (2021). A guide to vaccinology: from\nbasic principles to new developments. Nature Reviews\nImmunology, 21(2), 83–100. https://doi.org/10.1038/s41577-020-00479-7\n\n\nPrieto, L., & Sacristán, J. A. (2003). Problems and solutions in\ncalculating quality-adjusted life years (QALYs). Health and Quality\nof Life Outcomes, 1(1), 80. https://doi.org/10.1186/1477-7525-1-80\n\n\nRui, J., Li, K., Wei, H., Guo, X., Zhao, Z., Wang, Y., Song, W.,\nAbudunaibi, B., & Chen, T. (2024). MODELS: A six-step framework for\ndeveloping an infectious disease model. Infectious Diseases of\nPoverty, 13(1), 30. https://doi.org/10.1186/s40249-024-01195-3\n\n\nSender, R., Bar-On, Y., Park, S. W., Noor, E., Dushoff, J., & Milo,\nR. (2022). The unmitigated profile of COVID-19 infectiousness.\neLife, 11, e79134. https://doi.org/10.7554/eLife.79134\n\n\nSeverens, J. L., & Milne, R. J. (2004). Discounting Health Outcomes\nin Economic Evaluation: The Ongoing Debate. Value in Health,\n7(4), 397–401. https://doi.org/10.1111/j.1524-4733.2004.74002.x\n\n\nShim, E., & Galvani, A. P. (2012). Distinguishing vaccine efficacy\nand effectiveness. Vaccine, 30(47), 6700–6705. https://doi.org/10.1016/j.vaccine.2012.08.045\n\n\nSittimart, M., Rattanavipapong, W., Mirelman, A. J., Hung, T. M., Dabak,\nS., Downey, L. E., Jit, M., Teerawattananon, Y., & Turner, H. C.\n(2024). An overview of the perspectives used in health economic\nevaluations. Cost Effectiveness and Resource Allocation,\n22(1), 41. https://doi.org/10.1186/s12962-024-00552-1\n\n\nSmith, J. S., & Sturrock, D. T. (2023). Simio and simulation -\nmodeling, analysis, applications - 6th edition. https://textbook.simio.com/SASMAA6/\n\n\nTurner, H. C., Archer, R. A., Downey, L. E., Isaranuwatchai, W.,\nChalkidou, K., Jit, M., & Teerawattananon, Y. (2021). An\nintroduction to the main types of economic evaluations used for\ninforming priority setting and resource allocation in healthcare: Key\nfeatures, uses, and limitations. Frontiers in Public Health,\n9. https://www.frontiersin.org/articles/10.3389/fpubh.2021.722927\n\n\nVegvari, C., Abbott, S., Ball, F., Brooks-Pollock, E., Challen, R.,\nCollyer, B. S., Dangerfield, C., Gog, J. R., Gostic, K. M., Heffernan,\nJ. M., Hollingsworth, T. D., Isham, V., Kenah, E., Mollison, D.,\nPanovska-Griffiths, J., Pellis, L., Roberts, M. G., Scalia Tomba, G.,\nThompson, R. N., & Trapman, P. (2022). Commentary on the use of the\nreproduction number R during the COVID-19 pandemic. Statistical\nMethods in Medical Research, 31(9), 1675–1685. https://doi.org/10.1177/09622802211037079\n\n\nVerani, J. R., Baqui, A. H., Broome, C. V., Cherian, T., Cohen, C.,\nFarrar, J. L., Feikin, D. R., Groome, M. J., Hajjeh, R. A., Johnson, H.\nL., Madhi, S. A., Mulholland, K., O’Brien, K. L., Parashar, U. D.,\nPatel, M. M., Rodrigues, L. C., Santosham, M., Scott, J. A., Smith, P.\nG., … Zell, E. R. (2017). Case-control vaccine effectiveness studies:\nPreparation, design, and enrollment of cases and controls.\nVaccine, 35(25), 3295–3302. https://doi.org/10.1016/j.vaccine.2017.04.037\n\n\nVerguet, S., Johri, M., Morris, S. K., Gauvreau, C. L., Jha, P., &\nJit, M. (2015). Controlling measles using supplemental immunization\nactivities: A mathematical model to inform optimal policy.\nVaccine, 33(10), 1291–1296. https://doi.org/10.1016/j.vaccine.2014.11.050\n\n\nVynnycky, E., & White, R. (2010). An Introduction to Infectious\nDisease Modelling. OUP Oxford.\n\n\nWallinga, J., & Lipsitch, M. (2006). How generation intervals shape\nthe relationship between growth rates and reproductive numbers.\nProceedings of the Royal Society B: Biological Sciences,\n274(1609), 599–604. https://doi.org/10.1098/rspb.2006.3754\n\n\nWallinga, J., & Teunis, P. (2004). Different epidemic curves for\nsevere acute respiratory syndrome reveal similar impacts of control\nmeasures. American Journal of Epidemiology, 160(6),\n509–516. https://doi.org/10.1093/aje/kwh255\n\n\nWhitehead, S. J., & Ali, S. (2010). Health outcomes in economic\nevaluation: The QALY and utilities. British Medical Bulletin,\n96(1), 5–21. https://doi.org/10.1093/bmb/ldq033\n\n\nWorld Health Organization. (2013). Correlates of vaccine-induced\nprotection: Methods and implications.\n\n\nZachreson, C., Tobin, R., Szanyi, J., Walker, C., Cromer, D., Shearer,\nF. M., Conway, E., Ryan, G., Cheng, A., McCaw, J. M., & Geard, N.\n(2023). Individual variation in vaccine immune response can produce\nbimodal distributions of protection. Vaccine, 41(45),\n6630–6636. https://doi.org/10.1016/j.vaccine.2023.09.025",
    "crumbs": [
      "References"
    ]
  },
  {
    "objectID": "dict.html",
    "href": "dict.html",
    "title": "Appendix A — Dictionary",
    "section": "",
    "text": "Epidemic is “the occurrence of more cases of disease than expected in a given area or among a specific group of people over a particular period of time” (US-CDC) (Texier et al., 2016). Epidemic is derived from the Greek epi and demos meaning “that which is upon the people”, to describe the burden of some phenomenon on “the people” (Nelson & Williams, 2014).\nTractable: can be solved (source)\n\nDefinition A.1 Microsimulation: an analysis in which individual instantiations of a system - such as a patient’s lifetime or the course of an epidemic - are generated using a random process to ‘draw’ from probability distributions a large number of times, in order to examine the central tendency and possibly the distribution of outcomes (Kim & Goldie, 2008).\n\n\nDefinition A.2 iid (independent and identically distributed random variables): each random variable has the same probability distribution as the others and all are mutually independent.\n\n\nDefinition A.3 Closed-form solution (or closed form expression) is any formula that can be evaluated in a finite number of standard operations (source).\n\ninfection fatality ratio (IFR) and case fatality ratio (CFR) and serology data.\n\nDefinition A.4 Residual: is the difference between the observed value and the estimated value.\n\n\nDefinition A.5 Error: is the deviation of the observed value from the true value.\n\nMatrix and linear transformation:\n\nLinear transformation is a function (transformation = function) that take in a vector and spit out a vector.\nLines remain lines, and origin remains fixed.\n\n\n\n\n\n\n\nVisualisation of linear transformation\n\n\n\n\n\n\n\n\n\nEigenvector (\\(\\vec{v}\\)):\nEigenvalue (\\(\\lambda\\)):\n\nDefinition A.6 Inverse matrix:\n\\[\\begin{bmatrix} a & b \\\\ c & d \\end{bmatrix}^{-1} = \\frac{1}{ad - bc} \\begin{bmatrix} d & -b \\\\ -c & a \\end{bmatrix}\\]\n\n\n\n\n\nKim, S.-Y., & Goldie, S. J. (2008). Cost-Effectiveness Analyses of Vaccination Programmes. PharmacoEconomics, 26(3), 191–215. https://doi.org/10.2165/00019053-200826030-00004\n\n\nNelson, K. E., & Williams, C. M. (2014). Infectious Disease Epidemiology: Theory and Practice. Jones & Bartlett Publishers.\n\n\nTexier, G., Farouh, M., Pellegrin, L., Jackson, M. L., Meynard, J.-B., Deparis, X., & Chaudet, H. (2016). Outbreak definition by change point analysis: a tool for public health decision? BMC Medical Informatics and Decision Making, 16(1), 33. https://doi.org/10.1186/s12911-016-0271-x",
    "crumbs": [
      "Appendices",
      "<span class='chapter-number'>A</span>  <span class='chapter-title'>Dictionary</span>"
    ]
  },
  {
    "objectID": "func.html",
    "href": "func.html",
    "title": "Appendix B — Useful functions",
    "section": "",
    "text": "B.1 approxfun()",
    "crumbs": [
      "Appendices",
      "<span class='chapter-number'>B</span>  <span class='chapter-title'>Useful functions</span>"
    ]
  },
  {
    "objectID": "simll.html",
    "href": "simll.html",
    "title": "Appendix C — Simulate line list",
    "section": "",
    "text": "Download the simulated data here:\n linelist.rds \n\n\n\n\nlibrary(simulist)\nlibrary(epiparameter)\nlibrary(dplyr)\nlibrary(tidyr)\nlibrary(lubridate)\nlibrary(ggplot2)\nlibrary(sf)\n\nSet the distribution for all parameters.\n\ncontact_distribution &lt;- epiparameter::epidist(\n  disease = \"COVID-19\", \n  epi_dist = \"contact distribution\", \n  prob_distribution = \"pois\", \n  prob_distribution_params = c(mean = 2)\n)\n\ninfectious_period &lt;- epiparameter::epidist(\n  disease = \"COVID-19\",\n  epi_dist = \"infectious period\",\n  prob_distribution = \"gamma\",\n  prob_distribution_params = c(shape = 3, scale = 2)\n)\n\nonset_to_hosp &lt;- epiparameter::epidist_db(\n  disease = \"COVID-19\",\n  epi_dist = \"onset to hospitalisation\",\n  single_epidist = TRUE\n)\n\nonset_to_death &lt;- epiparameter::epidist_db(\n  disease = \"COVID-19\",\n  epi_dist = \"onset to death\",\n  single_epidist = TRUE\n)\n\nWe create two overlapping outbreaks.\n\n# First peak\nset.seed(1)\np1 &lt;- sim_linelist(\n  contact_distribution = contact_distribution,\n  infectious_period = infectious_period,\n  onset_to_hosp = onset_to_hosp,\n  onset_to_death = onset_to_death,\n  outbreak_size = c(1000, 1500),\n  hosp_risk = 0.2,\n  hosp_death_risk = 0.2,\n  anonymise = T,\n  population_age = c(0, 25),\n  outbreak_start_date = as.Date(\"2023-01-01\")\n)\n\nWarning: Number of cases exceeds maximum outbreak size. \nReturning data early with 1513 cases and 2946 total contacts (including cases).\n\n# Second peak\nset.seed(17)\np2 &lt;- sim_linelist(\n  contact_distribution = contact_distribution,\n  infectious_period = infectious_period,\n  onset_to_hosp = onset_to_hosp,\n  onset_to_death = onset_to_death,\n  outbreak_size = c(1000, 1200),\n  hosp_risk = 0.2,\n  hosp_death_risk = 0.2,\n  anonymise = T,\n  population_age = c(3, 35),\n  outbreak_start_date = as.Date(\"2023-05-01\")\n)\n\nWarning: Number of cases exceeds maximum outbreak size. \nReturning data early with 1249 cases and 2417 total contacts (including cases).\n\n\nAdd the district of residence.\n\n# 22 districts in HCMC\ndistricts &lt;- c(\"Cu Chi\", \"Hoc Mon\", \"Quan 12\", \"Go Vap\", \"Binh Chanh\", \"Binh Tan\", \"Tan Phu\", \"Tan Binh\", \"Phu Nhuan\", \"Binh Thanh\", \"Thu Duc\", \"Quan 6\", \"Quan 11\", \"Quan 10\", \"Quan 3\", \"Quan 1\", \"Quan 5\", \"Can Gio\", \"Nha Be\", \"Quan 4\", \"Quan 8\", \"Quan 7\")\n\n# Let have the first peak in the west, the second peak in the south\nsampling_space &lt;- round(rnorm(10000, mean = 6, sd = 6))\np1$district &lt;- sample(sampling_space[sampling_space &gt;= 1 & sampling_space &lt;= 22], nrow(p1))\np1$district &lt;- districts[p1$district]\n\nsampling_space &lt;- round(rnorm(10000, mean = 15, sd = 5))\np2$district &lt;- sample(sampling_space[sampling_space &gt;= 1 & sampling_space &lt;= 22], nrow(p2))\np2$district &lt;- districts[p2$district]\n\np1$outbreak &lt;- \"1st outbreak\"\np2$outbreak &lt;- \"2nd outbreak\"\n\ndf &lt;- rbind(p1, p2)\n\nLet see the spatial distribution of the first and second peak.\n\n\nCode\nmap_p &lt;- \"data/gadm41_hcmc_district.rds\"\nmapdt &lt;- readRDS(map_p)\nmapdt &lt;- mapdt[,c(1,3)]\ncolnames(mapdt) &lt;- c(\"district\", \"geom\")\nmapdt$district &lt;- stringi::stri_trans_general(mapdt$district, \"latin-ascii\")\n\ndf_plot &lt;- df |&gt; \n  count(outbreak, district) |&gt; \n  as.data.frame() |&gt; \n  complete(outbreak, district = unique(mapdt$district)) |&gt; \n  left_join(mapdt, by = \"district\") |&gt; \n  st_as_sf()\n\nggplot(df_plot) +\n  geom_sf(aes(fill = n)) +\n  scale_fill_viridis_c(na.value=\"white\") +\n  facet_wrap(~ outbreak) +\n  theme_light() +\n  theme(\n    axis.line = element_blank(),\n    axis.title = element_blank(),\n    axis.text = element_blank(), \n    axis.ticks = element_blank(),\n    panel.grid.minor = element_blank(),\n    panel.grid.major = element_blank()\n  )\n\n\n\n\n\n\n\n\n\nHave a look at the final data.\n\n\nCode\n# Clean the date columns and remove non important columns\ndf &lt;- df |&gt; mutate_if(is.Date, ymd) |&gt; select(-ct_value, -case_type, -outbreak)\n\ndf_plot &lt;- df |&gt; \n  count(date_onset)\n\nggplot(df_plot, aes(x = date_onset, y = n)) +\n  geom_bar(stat = \"identity\", width = 1, fill = \"cornflowerblue\") +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\n\nhead(df)",
    "crumbs": [
      "Appendices",
      "<span class='chapter-number'>C</span>  <span class='chapter-title'>Simulate line list</span>"
    ]
  },
  {
    "objectID": "mle.html#section",
    "href": "mle.html#section",
    "title": "6  Maximum likelihood estimation",
    "section": "6.3 ",
    "text": "6.3",
    "crumbs": [
      "Calibration",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Maximum likelihood estimation</span>"
    ]
  }
]