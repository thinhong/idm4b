# SIR

```{r}
library(deSolve)
library(bbmle)

flu <- readRDS("data/flu.rds")
# This flu data is prevalence (a very special data)
# Prevalence: fit with I
# Incidence: fit with reported cases
```

## Assumptions

-   Well-mixed population (a single contact rate $\beta$).
-   The most basic form balances demographic processes (births B and deaths $\mu$).
-   Infectious disease properties is for a single pathogen.

## Structure

Force of infection $\lambda = \frac{\beta I}{N}$

$$\frac{dS}{dt} = B - \lambda S - \mu S$$

$$\frac{dI}{dt} = \lambda S - \gamma I - \mu I$$

$$\frac{dR}{dt} = \gamma I - \mu R$$

```{r}
# sir_1() returns a data frame consists S, I, R, In values by time
sir_1 <- function(beta, gamma, S0, I0, R0, times) {
  
  sir_equations <- function(time, variables, parameters) {
    with(as.list(c(variables, parameters)), {
      dS <- -beta * I * S
      # In to store the number of new cases, we fit the data with In not I
      # I is the number of people remaining infectious, the number we get from public health surveillance is new cases (In)
      dIn <- beta * I * S
      dI <-  dIn - gamma * I
      dR <-  gamma * I
      return(list(c(dS, dI, dR, dIn)))
    })
  }
  
  parameters_values <- c(beta = beta, gamma = gamma)
  initial_values <- c(S = S0, I = I0, R = R0, In = 0)
  
  out <- ode(initial_values, times, sir_equations, parameters_values)

  as.data.frame(out)
}
```

## Poisson distribution

Poisson distribution is a **discrete probability distribution** that expresses probability of a given **number of events** occurring **in a fixed interval of time**[^1].

[^1]: Wikipedia <https://en.wikipedia.org/wiki/Poisson_distribution>

Suitable to use because here we are fitting a number of cases occurring in this period.

