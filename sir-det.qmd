# SIR

```{r}
library(deSolve)
library(bbmle)
library(ggplot2)

flu <- readRDS("data/flu.rds")
# This flu data is prevalence (a very special data)
# Prevalence: fit with I
# Incidence: fit with reported cases
```

## Assumptions

-   Well-mixed population (a single contact rate $\beta$).
-   The most basic form balances demographic processes (births B and deaths $\mu$).
-   Infectious disease properties is for a single pathogen.

## Structure

Force of infection $\lambda = \frac{\beta I}{N}$

$$\frac{dS}{dt} = B - \lambda S - \mu S$$

$$\frac{dI}{dt} = \lambda S - \gamma I - \mu I$$

$$\frac{dR}{dt} = \gamma I - \mu R$$

```{r}
# sir_1() returns a data frame consists S, I, R values by time
sir_1 <- function(beta, gamma, S0, I0, R0, times) {
  
  sir_equations <- function(time, variables, parameters) {
    with(as.list(c(variables, parameters)), {
      dS <- -beta * I * S
      dI <-  beta * I * S - gamma * I
      dR <-  gamma * I
      return(list(c(dS, dI, dR)))
    })
  }
  
  parameters_values <- c(beta = beta, gamma = gamma)
  initial_values <- c(S = S0, I = I0, R = R0)
  
  out <- ode(initial_values, times, sir_equations, parameters_values)

  as.data.frame(out)
}
```

```{r}
pred <- sir_1(beta = 0.004, gamma = 0.5, S0 = 999, I0 = 1, R0 = 0, times = flu$day)
```

We want to compare these modelâ€™s predictions with real prevalence data.

```{r}
df_plot <- merge(x = pred, y = flu, by.x = "time", by.y = "day")

ggplot(df_plot, aes(x = time, y = cases)) +
  geom_point() +
  geom_line(aes(y = I)) +
  theme_minimal()
```


## Poisson distribution

Poisson distribution is a **discrete probability distribution** that expresses probability of a given **number of events** occurring **in a fixed interval of time**[^1].

[^1]: Wikipedia <https://en.wikipedia.org/wiki/Poisson_distribution>

Suitable to use because here we are fitting a number of cases occurring in this period.

