{
  "hash": "e3db15a83aeed0ef5c232a37693778ba",
  "result": {
    "engine": "knitr",
    "markdown": "# SEIR\n\n## Code\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(deSolve)\nlibrary(tidyr)\nlibrary(ggplot2)\nlibrary(RColorBrewer)\nlibrary(patchwork)\n```\n:::\n\n\nLet reuse the deterministic SIR model code from @lst-sir-det and write code for the deterministic SEIR model.\n\n\n::: {.cell}\n\n:::\n\n\n::: {#lst-seir-det}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nseir_mod <- function(beta, sigma, gamma, S0, E0, I0, R0, times) {\n  \n  sir_equations <- function(time, variables, parameters) {\n    with(as.list(c(variables, parameters)), {\n      dS <-   -beta * I * S\n      dE <-    beta * I * S - sigma * E\n      dI <-    sigma * E - gamma * I\n      dR <-    gamma * I\n      dCInc <- sigma * E\n      return(list(c(dS, dE, dI, dR, dCInc)))\n    })\n  }\n  \n  parameters_values <- c(beta = beta, sigma = sigma, gamma = gamma)\n  initial_values <- c(S = S0, E = E0, I = I0, R = R0, CInc = 0)\n  \n  out <- ode(initial_values, times, sir_equations, parameters_values)\n\n  out <- as.data.frame(out)\n  # Compute incidence from cumulative incidence\n  out$Inc <- c(I0, diff(out$CInc))\n  out$CInc <- NULL\n  out\n}\n```\n:::\n\n\nDeterministic SEIR model\n\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\npred1 <- sir_mod(beta = 0.004, gamma = 0.5, S0 = 999, I0 = 1, R0 = 0, times = 1:20)\npred2 <- seir_mod(beta = 0.004, sigma = 0.5, gamma = 0.5, S0 = 999, E0 = 0, I0 = 1, R0 = 0, times = 1:20)\n\ndf_plot <- pivot_longer(pred1, cols = S:Inc, names_to = \"comp\", values_to = \"n\")\n\nmy_palette <- brewer.pal(11, \"PuOr\")[c(10, 4, 3, 8)]\n\np1 <- ggplot(df_plot, aes(x = time, y = n, color = comp)) +\n  geom_point() + geom_line() +\n  scale_color_manual(values = my_palette, breaks = c(\"S\", \"Inc\", \"I\", \"R\")) +\n  labs(color = NULL, y = NULL) +\n  theme_minimal() +\n  theme(legend.position = \"none\")\n\ndf_plot <- pivot_longer(pred2, cols = S:Inc, names_to = \"comp\", values_to = \"n\")\n\nmy_palette <- brewer.pal(11, \"PuOr\")[c(10, 1, 4, 3, 8)]\n\np2 <- ggplot(df_plot, aes(x = time, y = n, color = comp)) +\n  geom_point() + geom_line() +\n  scale_color_manual(values = my_palette, breaks = c(\"S\", \"E\", \"Inc\", \"I\", \"R\")) +\n  labs(color = NULL, y = NULL) +\n  theme_minimal() +\n  theme(legend.position = \"bottom\")\n\np1 / p2\n```\n\n::: {.cell-output-display}\n![](seir-det_files/figure-html/unnamed-chunk-4-1.svg){width=100%}\n:::\n:::\n",
    "supporting": [
      "seir-det_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}